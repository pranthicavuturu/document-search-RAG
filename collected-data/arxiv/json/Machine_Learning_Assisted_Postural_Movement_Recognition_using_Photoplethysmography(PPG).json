{
    "title": "MACHINE LEARNING ASSISTED POSTURAL MOVEMENT",
    "abstract": "Withthegrowingpercentageofelderlypeopleandcarehomeadmissions,thereisanurgentneed forthedevelopmentoffalldetectionandfallpreventiontechnologies. Thisworkpresents,forthe firsttime,theuseofmachinelearningtechniquestorecognizeposturalmovementsexclusivelyfrom Photoplethysmography(PPG)data. Toachievethisgoal,adevicewasdevelopedforreadingthe PPGsignal,segmentingthePPGsignalsintoindividualpulses,extractingpulsemorphologyand homeostatic characteristic features, and evaluating different ML algorithms. Investigations into differentposturalmovements(stationary,sittingtostanding,andlyingtostanding)wereperformed by 11 participants. The results of these investigations provided insight into the differences in homeostasisafterthemovementsinthePPGsignal. Variousmachinelearningapproacheswereused forclassification,andtheArtificialNeuralNetwork(ANN)wasfoundtobethebestclassifier,witha testingaccuracyof85.2%andanF1scoreof78%fromexperimentalresults.",
    "body": "MACHINE LEARNING ASSISTED POSTURAL MOVEMENT\nRECOGNITION USING PHOTOPLETHYSMOGRAPHY(PPG) ∗\nRobbieMaccayandRoshanWeerasekera\nSchoolofElectricalElectronicandMechanicalEngineering(EEME)\nUniversityofBristol\nBristol,UK\ncorresponding author: roshan.weerasekera@bristol.ac.uk\nABSTRACT\nWiththegrowingpercentageofelderlypeopleandcarehomeadmissions,thereisanurgentneed\nforthedevelopmentoffalldetectionandfallpreventiontechnologies. Thisworkpresents,forthe\nfirsttime,theuseofmachinelearningtechniquestorecognizeposturalmovementsexclusivelyfrom\nPhotoplethysmography(PPG)data. Toachievethisgoal,adevicewasdevelopedforreadingthe\nPPGsignal,segmentingthePPGsignalsintoindividualpulses,extractingpulsemorphologyand\nhomeostatic characteristic features, and evaluating different ML algorithms. Investigations into\ndifferentposturalmovements(stationary,sittingtostanding,andlyingtostanding)wereperformed\nby 11 participants. The results of these investigations provided insight into the differences in\nhomeostasisafterthemovementsinthePPGsignal. Variousmachinelearningapproacheswereused\nforclassification,andtheArtificialNeuralNetwork(ANN)wasfoundtobethebestclassifier,witha\ntestingaccuracyof85.2%andanF1scoreof78%fromexperimentalresults.\nKeywords ArtificialIntelligence·Falldetection·Photoplethysmography·Postural·MachineLearning·Wearables\n1 Introduction\nPeoplearelivinglonger,andtheagingpopulationoftheUKiseverincreasing. TheUKcurrentlyhasapopulation\nof5.5millionpeopleagedover75,whichissettoincreaseto7.1millionby2035[1]. Ofthe3.2millionofthe5.5\nmillionpeopleovertheageof80,halfwillhaveatleastonefallayear[2]. Thesefallsarecausedduetomanyfactors,\nincludingmuscleweakness,poorbalanceorvisualimpairment[3]. Withanelderlypersonfallingeverytensecondsin\ntheUK,theprevalenceoflifealteringinjuries,suchasheadinjuriesandhipfractures,ishighandcanprovetobefatal\n[4]. Theseinjuriescanleadtoindividualsrequiringhospitalisationandsurgery. Theyresultinalossofconfidenceand\nanxietyoffallsinthefuture,leadingtothemrestrictingtheiractivitiesintheirdailylives[4]andcanresultinrequiring\ncarehomeadmission. Thiscombinationofphysicalandpsychologicalimpactstothegeriatricpopulationshasledto\nfallsbeingtheninthleadingcauseofdisability-adjustedlifeyears(DALYs)inEnglandin2013,puttingalargestrain\nontheNationalHealthService(NHS),costing£435millionannuallyinEnglandaloneforfallsinthehouse[3].\nFalldetectionandfallpreventionaretwocrucialstrategiestoreducetheprevalenceoffallsandallowthegrowing\nolderpopulationtomaintaintheirindependence. Falldetectionisdefinedasthedetectionofafallusingsensorsand\ncamerastosummonhelp[4]. Fallpreventionreferstosystemstostopfallsbyobservingtheperson’smovement[4]and\nactionstoreducethelikelihoodoffalls. Fallpreventativeactivitiesarecarriedoutacrossmanyhealthdisciplinesand\nhavebeenshowntohavealargeimpactonthefrequenciesoffallsexperiencedbytheindividualsutilisingthem[5].\nThesemethodsincludingexercise,fallriskassessments,assistiveequipmentandtechnologicalbasedinterventions\n[5]. Exerciseimprovesmuscularstrengthandbalance,andthefallriskassessmentsallowforclinicalstafftoassess\nmobilityissuesandphysiologicalfactorsthatmayincurfalls. Assistiveequipment,suchasgrabrailsandhoists,provide\nfunctionalsupporttoolderadults,andaimtohelpwithmobilityaroundthehouse. Technologicalfallinterventionsare\nmethodsofidentifyingfallsandaddressingfallrisks. Thesecanbedividedintopreandpostfallinterventionsand\n∗ThisworkwascarriedoutwhilethefirstauthorwasastudentintheUniversityofBristol,UK.\n4202\nvoN\n2\n]PS.ssee[\n1v26811.1142:viXra\nMLAssistedPosturalMovementDetectionusingPPG\ninjuryprevention[5]. Preandpostfallinterventionsuseinformationsources,suchaswalkingpatterns,torecogniseand\nalertusersoffallrisks. Injurypreventionaresystemsthatdetectwhenfallsoccurandminimisethatmayoccurafterthe\neventoffalling. Thesemethodsreducethefrequencyoffallsandgivepeopleachancetomaintaintheirmobility.\nPeopleinacarehomeareparticularlyatriskoffalls. Withthegrowingelderlypopulation,thepopulationofthosethat\nrequirecareinnursinghomeswillincrease. Therearenowover400,00peoplelivinginover16,700residentialcare\nandnursinghomesintheUK[6]. Ahighpercentageofthesehavecognitiveimpairmentthatmayleadtoatendencyto\nwanderandalackofawarenessoffallrisks. Maintainingtheirsafetyremainsachallenge,especiallythroughoutthe\nnightwhennursingstaffisreduced. Therefore,effectivemethodsforcontinuallymonitoringpeopleremotelyarea\nmust.\nSinceover65%offallsoccurinthebedroom,ofwhich80.1%occuraroundthebed[7],systemsthatfocusonpeopleat\nriskoffallshavebeendevelopedtoallowcarestafftomonitormovementsoutofthebed. Thesebedexitingsystems\nalertcarestaffastoifthepersonisattemptingtoleavethebed,hasgottenoutofbedorhasfallen[8]. Thesystems\ncaninvolveattachmentstotheperson(e.g. garmentclips)orarepartofthebed(e.g. pressure-sensitivematsplaced\natthesideofthebedandbedsideinfraredbeamdetectors). However,thefallrisksassociatedwithstandingupare\nsimilarlypresentifapersonrisesfromachair. Toproduceadevicethatcouldallowcarehomestafftomonitorifa\npersonisstandingup,assensorthatcouldmeasuretheposturalpositionwouldberequired. Inthispaper,asystem\nthatcouldfollowtheat-riskpersonaroundtheirbedroomandnotifycarestaffiftheyareattemptingtostandupfrom\ntheirstationarypositionisproposed. Thiscouldimprovepatientmonitoringandallowforcarestafftodifferentiatethe\ncurrentfallriskoftheuser.\nFigure1: PPGbasedposturalmovementdetectionmethodology\nToachievethedetectionoftheindividualsstandingup,awearablesensordetectionofthemovementwouldberequired.\nAnon-invasive,low-costsensorthatcanbeutilisedfordetectingmovementisPhotoplethysmography(PPG).PPGisan\nopticalmethodfordetectingchangesinbloodvolumeasapersonmoves[9]. Asthepersonstandsup,orthostaticstress\ncausesasuddenincreaseinbloodvolume,differinginmagnitudedependingontheageandhealthoftheindividualand\nthetypeofposturalchange[10]. Signalanalysis,segmentation,andfeatureextractionofPPGsignalsfoundduring\nmovementcouldenableaMachineLearning(ML)algorithmtoclassifythechangesinbloodvolume. Thisprocess\nallowsfortheautomaticrecognitionofposturalmovement. OtherHumanActivityRecognition(HAR)[11,12,13]\nsystemshaveusedMLforrecognisingmovementpatternsinPPGsignal. However,thesestudieshavebeenemployed\nforrecognitionofambulatorymovements,suchaswalkingandjogging. Therearenoknownexamplesintheliterature\noftechniquesproposedforposturalmovementrecognitionforastandalonePPGsensor.\n2\nMLAssistedPosturalMovementDetectionusingPPG\nThispaperisstructuredasfollows. Section2giveabackgrounddescriptiononPPG,MLandHAR,aswellastheir\ncurrentrelatedwork. Section3discussestheapproachtakenforthisproject,asseeninFigure1,forthedevicedesign,\nsignalprocessingandML.Finally,theresultsoftheMLtrainingandtestingarepresentedinsection4andsection5is\nthediscussionoftheresultsandtheproject.\n2 BackgroundandRelatedWork\nThissectionprovidesacomprehensiveoverviewofPPGsignals,highlightingtheircharacteristicsandapplicationsin\nmonitoringhumanactivitiesandotherrelateduses.\n2.1 Photoplethysmography\nPhotoplethysmographyisanopticalmethodformeasuringpulsatile\nblood volume in the microvascular bed of tissue [9]. The method\ninvolvestheuseofalightemittingsource,suchasanLED,toradiate\nlight onto tissue, such as the skin. A photodetector measures the\nlightthathasbeenreflectedfromortransmittedthroughthetissue.\nThe blood volume changes are induced by the pressure pulse of\neachcardiaccycle[14],effectingthereceivedlightintensityatthe\nphotodetector[15]. Figure2illustratesthestandardcompositionofa\nPPGwaveform. Thewaveformcanbesplitintotwosections. These\naretheACcomponent,whichrepresentsthepulsatilecomponentof\ntheblood,andtheDCcomponent,whichrelatestotheaverageblood\nvolumeofthetissue[9]. TheDCcomponentchangesslowlydueto\nfactorssuchasrespirationandbloodvesselvasoconstrictorwaves.\nEachPPGpulsebeginswithasharpincreaseinbloodbeingpumped\ninto the tissue. Chen et al [16] proposed a time domain analysis\nmethodfordeterminingthepulseonset,utilisingamovingaverage Figure2: PrinciplesofthePPGsignal[15]\nfiltertocreateabaseline. TheonsetwasdeterminedbyfilteringoutPPGvaluesabovethebaseline, removingthe\ndetectionoffalsepeaks. ThePoints-Of-Interest(POI)thatcanbefoundfromtheACcomponentincludethesystolic\npeak,dicroticnotchandthediastolicpeak. Thesystolicpeakmarksthelargestamountofbloodfoundinthetissue.\nTheamplitudeofthepulsethendecreasesintoalocalminimum,calledthedicroticnotch,indicatingtheclosureofthe\naorticvalves[17]. Thesignalfoundbetweentheonsetofthepulseandthedicroticnotchisreferredtoasthesystolic\nphaseandthesignalafterthenotchtilltheendofthewaveandonsetoftheconsecutivepulseiscalledthediastolic\nphase. Anadditionalpeakcanbefoundafterthedicroticnotch,calledthediastolicpeak. Theshapeofthewaveform\ncandiffergreatlybetweenindividuals,duetofactorssuchasageandexercise[18].\nThewavelengthsofthelightoftheLEDsareselecteddepend-\ning on the purpose for the sensor and the placement of the\nsensoronthebody. ThewavelengthsofthelightoftheLEDs\nareselecteddependingonthetypesofmeasurementsthatare\ncompleted by the device. The largest components of the up-\nperlayersoftissuethataffecttheratesofabsorptionoflight\nare water, haemoglobin and tissue depth [9], [15]. Water is\namajorcomponentoftheskinandishighlyabsorbenttoul-\ntraviolet and higher frequency light signals, whereas lower\nfrequencyandInfra-Red(IR)signalsareinawindowofthe\nabsorptionspectra,allowingforhigherpenetrationoflightinto\nthemicrovascularbedoftissue. Oxygenatedanddeoxygenated\nFigure3: PPGpulsepointsofinterestandfeatures Haemoglobinhavesignificantdifferentabsorptionrates,expect\natwavelengthsclosetoinfra-red,meaningthatgreenLEDsare\ncommonlyusedforoxygenmeasurements[19]. TomaximiselightpenetrationandPPGreceivedintensities,green\nandblueLEDsshouldbeusedforwristapplications,whereaslowerfrequencylight,suchasred,shouldbeusedfor\nforeheadapplications[20]. Skintemperaturealsohasaquantitativeeffectonthesignalquality,aslowertemperatures\nreducesperfusionratesinthevascularbed,asthebodyattemptstoconservebodyheat,constrictingbloodvessels\nandincreasingthedistancethelighthastotravel[15]. ThePPGsensorcontactpressure(CP),whichistheexternal\npressureappliedbythesensoronthesurfaceoftheskin,furtherimpactsthePPGreadings[21]. Theamplitudeand\nshape of the PPG waveform are impacted, with higher contact pressures increasing the accuracy of physiological\nmeasurements,suchastheheartrate[18].TransmissionmodedetectorsarecommonlyusedforPPGsensorsplaced\n3\nMLAssistedPosturalMovementDetectionusingPPG\nattheearorfinger. Reflectionmodesensorallowforahigherlevelofflexibility,suchthattheyaremoresuitablefor\nwearabledevices,andareusedinankle,chest,forearm,foreheadandwristapplications[19]. Researchhasalsobeen\ndoneformulti-wavelengthPPGsensors[15],whereusingcombinationsofIR,redandgreenLEDsareusedinclose\nproximitytoeachotherandaround2mmfromthephotodiode.\nThesiteofthesensoronthebodyisanimportantconsiderationforthemode,wavelengthandsensorusedandcan\nleadtodifferentmorphologyofthewaveform. Thesitesthatareprimarilyusedaretheankle,chest,earlobe,forearm,\nforehead,fingerandupperwrist. Alargenumberoftheconsumerdevicesusewristapplications[18],[19],asitis\nconvenienttowear,highlyportableandcanbecombinedinsmartwatches. Theupperwristhasbeenfoundtohave\nrelativelylowsignalamplitudeincomparisontoothersites[19]andahighersusceptibilitytoMotionArtifacts(MA).\nAnotherkeyplacementofthePPGsensoristheearlobe,asthelackofcartilageandthuscontainalargevolumeof\nblood,creatingasuitablesitefortransmissiontypesensors. However,theirusagecanbecomeuncomfortableafter\nlongmonitoringperiods[22]. Thefingerisacommonlocationforpulseoximetry[23]aseitheracliporring. The\nforeheadissuitedforreflectivemodesensor,asthethinskin,highdensityofbloodvesselsandskullgiveapowerful\nopticalsignal. TheforearmcanbeusedforarterialPPGmeasurements, buthasbeenfoundtohavealowerpulse\namplitudethanwristorfingersensors[22]. FromthePPGwaveform,pulsetimedomainanalysiscanbecompletedto\nextractfeaturesofthesignal[9],[24]. FromthePOIfromeachofthepulsesofthewave,asdiscussedearlier,extracted\nfeatures,suchasthepulsewidth,systolicanddiastolicamplitudes,pulseoffset,andpeakdifferencecanbefound.\nFigure3illustratesthecorrelationbetweentheextractedfeaturesandthePOI.\nThepulsewidthisdescribedasthetimedifferencebetweentheonsetoftwoconsecutivepulses. Thesystolicamplitude\nisdefinedasthedifferencebetweentheheightofthesystolicpeakandthepulseonset,whilethediastolicamplitude\nisthedifferenceinheightbetweenthediastolicpeakandthestartpoint. Thedifferenceinmagnitudebetweenthe\npulseonsetandendpointisdefinedasthepulseoffset. Thepeakdifferenceisthedifferenceinsystolicanddiastolic\nmagnitudes.\nFurtherfeaturesofthePPGwaveformcanbeextractedfromthefirstandsecondderivativesofthewaveform[18],[19],\n[25]. Thefirstderivativecanbeusedforreliabledetectionofthediastolicpeak,whilethesecondderivativecanbe\nusedfordetectionofthedicroticnotch[17]. Thefeaturesofthesecondderivativecanbeusedfordiagnosisofcardiac\nabnormalities[19], suchasarterialstiffnessandarterialaging. Furtherfeaturescanbefoundwhencombiningthe\nPPGsensorwithanECGdevice,suchasthePulse-Transit-Time(PTT)andthePulse-Wave-Velocity(PWV).PTTis\ndefinedasthetimebetweentheR-peakoftheECGtotheonsetofthePPGwave. ThePPTcanalsobederivedfrom\nPPGsignalsfromtwosensorplacedatdifferentsitesonthebody[17]. ThePWVisdefinedastheinverseofthetime\nbetweentheR-peakintheECGtothepeakinthefirstderivativeofthePPGsignal. Furthermore,frequencydomain\nanalysiscanbeutilisedforstationaryprocesses,butshouldnotbeusedformonitoringthemorphologyofthepulsedue\ntomovement[10].\nTogiveconfidenceintheaccuracyofthephysiologicalmeasurementsmadebyaPPGdevice,reproducibilityisan\nimportantmetricinthedevelopmentofthesensor. Forcontinuousmonitoring,PPGwaveformnoisecanreducethe\naccuracy and reproducibility of the measurement system. The characteristics of the noise that can affect the PPG\nanalysisareMotionArtifacts(MA),baselinewanderingandhypoperfusion[9],[17]. Figure4illustratesthethreePPG\ndistortions.\nAschangesinthebodymovementsoccur,suchashandmovements\norwalking,thevolumeofbloodadjusts. Thesesuddenchangesin\nthebloodcancreatedistortionsinthePPGwaveform,calledMotion\nartifacts [17]. If the body part in which PPG is placed on moves\nduringmeasurements,therelativemovementbetweenthePPGLED\nandphotoreceptor,aswellasthemovementoftheskinincontactwith\nthesensor,canalsocausedistortionsinthewaveform[11]. Baseline\nwandering is noise due to changes in the baseline of the pulsatile\ncomponentandtheACamplitudeofthePPGsignal[17].Respiration,\nsympatheticnervoussystemactivitiesandthermoregulationareall\nfactorsthatcanmovethebaseline[17],interferingwiththeanalysis\noftheACcomponentofthePPG.Hypoperfusionisareductionin\nthechangesofbloodvolumeinthebloodvesselsduetofactorssuch\nashypothermiaandvasoconstriction[17].\nFromthefeaturesextractedfromthewaveform,PPGallowsforthe\ndetectionofcardiovascularandrespiratoryphysiologicalparameters.\nFigure 4: Examples of distortions in the PPG BloodOxygenSaturation;HeartRate;PulseRateVariability;Blood\nsignalduetomotionartifacts,baselinewander- pressure;RespirationRate;Arterialstiffness.\ningandhypoperfusion[15]\n4\nMLAssistedPosturalMovementDetectionusingPPG\nUsingthesephysiologicalparameters,doctorscandiagnoseawiderangeofclinicalconditions. Benefitsoftheuseof\nPPGliesinthenon-invasivemeasurementsandtheconvenienceofwearabledevicesfortheassessmentofvascular\nandautonomicfunction[9], [18]. OneoftheearlyusesforPPGwastodeterminetheSPO2forindividualsunder\nanaesthesia[23]. ThederivativesofthePPGsignalcanbeusedtodeterminethecardiovascularmortality[23],allowing\nfortheidentificationoftheindividualsatriskofcardiovasculardiseases. PPGdevicesareusedaspartofanovernight\ntesttohelpdiagnosesleepdisorders,includingObstructiveSleepApnoea(OSA)[23]. Byobservingchangesinthe\nSPO2andchangesofthePPGsignalwithrespirationareoftenutilisedfordiagnosis[18]. Otherconditionsinclude\ndetectionofatrialfibrillation,monitoringthespreadofinfectiousdiseases,bloodsugarmonitoringfordiabeticsand\nneurologicaldiagnosisandtreatment[9],[18],[23].\nWhenapersonstandsup,changesinthebloodflowinthemicrovascularbloodvesselsoccurs. Whenapersonrises,\northostaticstressoccurs,wherebloodisforcedtothelowerextremitiesandpoolsintheperipheralveins[10].This\nchangeinbloodvolumecausesadropinbloodpressureandreducedcardiacoutput. Whenthisoccurs,baroreceptorsin\nthearterieswilldetectthechangeinbloodpressureandwillinitiateabaroreflexresponse. Thisresponsewillincrease\nheartrateandconstrictthevenoussystemtotheperipheralarterioles. Thisreflexrestoresthebloodpressurebacktoa\nnominalvalue. Conditions,suchasOrthostaticHypotension(OH),definedasaBPdropofatleast20mmHgsystolic\nand/or>10mmHgdiastolic3minutesafterposturalchange[26],caneffectthemagnitudeofthebloodpressuredrop\nandthetimeittakesforthebloodpressuretoreturntonominalvalues[27]. OHisprevalentinolderadultsandhasa\nhighassociatingwithfalls[26].\n2.2 MachineLearning\nMachinelearning(ML)isatoolthatisusedwidelyforfallidentificationandprevention,whereactivitiessuchasfalling\nforwards,fallingbackwardsandspinningcanbedifferentiatedfromnon-fallactivities[4]. MLisalearningability\nforasystemtoobservetrendsindata. ThestepsrequiredforthedevelopmentofMLinvolvesdatacollection,data\nprocessing,featureextraction,trainingtheMLalgorithmsandperformanceevaluation. ForPPG,therawdatagathered\nfromthesensorisnoisyandprocessingtechniquescanbeusedtocleanthesignal. Featureselectionisanimportant\nstepthatcaninfluencetheclassificationaccuracyofthemodelsandcanreducetheprocessingcostsinmodeltraining\n[4]. Alargenumberoffeaturescanleadtooverfittingofthemodel[4],reducingtheeffectivenessofthemodelin\npredictingunseendataandreducingthetestingaccuracyperformance. Therefore,assessmentoftheimportanceof\npredictorsandtheremovalofredundantfeaturesisanessentialstep. Machinelearningcanbecategorisedasnon-deep\nlearningordeeplearningmethods[11]. Non-deeplearningapproachesincludeRandomForest(RF),decisiontree,\nSupportVectorMachines(SVM)andk-NearestNeighbour(KNN).DeeplearningapproachesincludeDeepNeural\nNetworks(DNN),ConvolutionalNeuralNetworks(CNN)andRecurrentNeuralNetworks(RNN).\nThiscanbedoneFollowingfeatureextractionfromPPGsignals,thedataispartitionedintotrainingandtestingsets,\nwiththeratiodeterminedbysystemdesignconsiderations. ThetrainingdataisutilisedbytheMLalgorithmtodiscern\ndatapatterns,suchasfallactivitiesforfallpreventionrecognitiontechniques. Thetestingdataisusedtoevaluatethe\nperformanceofthealgorithm,usingaccuracy,sensitivityandspecificitymetrics.\nMLhasfoundawidearrayofapplicationsintheanalysisandinterpretationofPPGsignals. Itfacilitatestheautomatic\ndetectionofphysiologicalparametersincludingHR[28],BP[29],[30]andbloodglucose[30].Gohetaldescribeda\ndeeplearningapproachfortheautomaticdetectionofMAinPPGsignals[31],allowingfortheautomaticcleaningof\nPPGsignalsforphysiologicalmeasurements. AlkhodarietalutilisedMLfortherecognitionofcardiovascularrisk\nfactors[32]. TheMLalgorithmsforPPGanalysisinthisprojectareasfollows:\nDiscriminant Analysis (DA): Discriminant analysis is a technique used mainly in the transformation of high-\ndimensionaldataintoalowerdimensionalformat[4],therebymaximisingtheclassseparability[33]. Discriminant\nanalysisisagoodmodelforpredictionofwidedatasets. ThemostpopularapproachisforLinearDiscriminantAnalysis\n(LDA)[4],wherelinearboundariesbetweenclassesarefound,whilequadraticdiscriminantanalysisfindsnon-linear\nseparations.\nNaiveBayes(NB): TheNaïveBayesutilisestheBayesTheoremtoconstructclassesbasedonprobability[4]. The\nalgorithmdeterminestheprobabilityofeachclassinthetrainingdataandthelikelihoodofobservingfeaturesfroma\ntestdatasetforagivenclass. TheBayestheoremcombinesthesevaluestodeterminestheprobabilityofthedifferent\npossibleclassesforthetestdataset. Theclassofthehighestprobabilityischosenasthepredictedclass. Thisisa\npopularmethodusedtoprovidefastpredictiveresults.\nSupportVectorMachines(SVM): SupportVectorMachines(SVM)isasupervisedmachinelearningmodelthat\nattemptstofindahyperplanethatcandivideclassesofdata,suchthatthereisanequaldistancebetweenclassestothe\n5\nMLAssistedPosturalMovementDetectionusingPPG\nhyperplane[4]. Thealgorithmattemptstofindtheoptimalhyperplanetomaximisethemarginbetweendata,sothat\nthehyperplaneactsasadecisionboundarybetweenclasses[4]. Theshapesofthehyperplanescaneitherbelinearor\nnon-linear. Thelinearclassifierfindsboundariesbetweenlinearlyisolateddatapoints[4]andthenon-linearclassifier\nfindshyperplanesbetweenmorecomplexclassboundaries. TheperformanceofSVMdependsonthemagnitudeofthe\nseparationbetweenclasses[34]. Therefore,incaseswhereclassboundariesoverlap,theaccuracyofthemodelreduces.\nDecisiontree(DT): Decisiontree(DT)modelsarestructuredasaseriesofdecisiontrees[30]. Eachdecisiontree\nconsistsofnodes,representingatest,withbranchessproutingfromeachnode,representingtheoutcomesofthetest.\nTheclassifierisbuiltbasedonthepaththatthealgorithmtakesthroughthetree. DTsareverysensitivetotrainingdata,\nwheresmallchangesinthetrainingdatacanaffecttheoveralltreestructure[30].\nK-NearestNeighbours(KNN): K-NearestNeighbours(KNN)isasupervisedlearningalgorithmthatcanbeusedfor\nbothclassificationandregressionmodels[4]. Thisalgorithmassumesthatpointsofthesameclassarefoundinclose\nproximitytoeachother. Thefirststepofthealgorithmistodeterminethedistancebetweenthetrainingdatatothenew\ndatapointthatthealgorithmisattemptingtoclassify. Thetestpointsarethenrankedbasedontheirproximitytothe\nnewdatapoint. Thefirstknumberofneighboursclosesttothenewdatapointarefoundandthealgorithmdetermines\ntheaverageclassoftheseneighbours. Thealgorithmthenassignsthemostcommonclassidentifiertothenewdata\npoint.\nArtificialNeuralNetwork(ANN): ArtificialNeuralNetworks(ANN)isaMLalgorithminspiredbyneurologyin\nthehumanbrain[4]. ANNsaremadeupofprocessingelements,referredtoasneurons,whichareconnectedtogether\nandareorganisedintolayers[35]. Eachoftheseconnectionshasaweight,determiningthestrengthoftheconnection.\nANNutilisesanactivationfunctiontotranslateasetofinputs,knownastheinputlayer,toasetofoutputs,knownas\ntheoutputlayer. Theactivationfunctiontakesthesumofeachinputaftermultiplyingthemwiththeirrespectiveweight.\nCommonactivationfunctionsincludesigmoid,RectifiedLinearUnit(ReLU),andthehyperbolictangent(tanh). ANN\ncanalsohavehiddenlayersbetweentheinputandoutputlayerstocopewithnonlinearlyseparableproblem[35]. For\nhiddenlayers,theoutputofaANNsignalcanbeusedasaninputforaconsecutiveANN.\nThetrainingoftheANNcomesintheadjustmentsoftheweights. Foreachinput,atrainerisusedtopredicttheinput\nandcreateacostfunctionforeachlayer,findingthedifferencebetweenthepredictedandactualvalues. ANNrepeats\nthetrainingprocessandadjuststheweightstoreducethedifferencebetweenthepredictedandactualvalues. Theresult\nisasystemthatcantakeinputdataandcreateaprediction,basedonthepatternslearnedduringtraining.\n2.3 HumanActivityRecognition\nSmart watches, phone movement and other wearable sensors are used for recognition of various human activities,\nsuchasjoggingandrunning[11]. HumanActivityRecognition(HAR)isusedinhealthcare,skillsassessmentsand\nsurveillance[12]. ThereareanumberoftypesofsensorsusedforHAR,chosendependingonfactorssuchasthe\ntargetedactivities,costsandformfactor[11]. Themostpopularsensoristhetri-axialaccelerometers,whichcanbe\nfoundinmanysmartphonesandsmartwatches[4],[11]. Chouetal[36]proposedabedexitingalarmsystemthat\nutilisedasingularaccelerometerplacedonthechestthatmonitoredthetiltangleoftheupperbody. Forposturerelated\ntasks,waistandthighaccelerometercombinationsallowforthegreatestaccuracy[37]. Accelerometers,aswellasother\ntypesofinertialsensors,canalsobeusedinconjunctionwithPPGsensorforeffectivetrackingofmovementactions\n[13]andasareferencesignal,utilisedinthecancellationofMAinthePPGsignal[24]. TheadvantageofusingPPG\noveraccelerometersisthelowerpowerconsumption[11]andtheabilitytocomputingHARwhilemeasuringother\nphysiologicalparameters,suchastheheartrate[11],[12]. Thisallowsforthereductioninresourceswhilesensing.\nML have proven to be a successful approach for HAR. For fall prevention, studies involving SVM have been the\nmostpopular[4]. ThisisduetoSVMsabilitytodetectdistinctdatasets,withthedifferencesbetweenthedataofa\nstandingandfallenpersoncreatingawidemarginaroundthehyperplane. ForPPGsignalHARusingML,Mehranget\nal[34]usedRandonForest(RF)andSVMalgorithmsforaPPGandaccelerometercombinationstudytodetectsitting,\nhouseholdactivityandlowandhighintensitycycling. Thisapproachresultedin89.2%and85.6%averagerecognition\naccuraciesfortheRFandSVMclassifiers,respectively. VariousdeeplearningapproacheshavebeenutilisedforHAR\nusingPPGdata. Alessandrinietal[12]utilisedaRNNforthedetectionofresting,squattingandstepperactivities\nutilisingaPPGandaccelerometercombinationdataset. Hnoohometal[38]producedadeeplearningapproachwith\nanF1scoreof90%forvariousexerciseandmovementactivities. ForstandalonePPGrecordings,CNN[31]andDNN\n[11]approachesforvariousambulatoryactivitieshavealsoachievedhighlevelsofaccuracy.\n6\nMLAssistedPosturalMovementDetectionusingPPG\n3 MethodanaAnalysis\nThemethodologyadoptedinthisworkisillustratedinFigure1.Itencompassesthreeprimarystages:hardware/software\ndevelopment,signalprocessing,andmachinelearning. Adetaileddiscussionofeachstageisprovidedinthissection.\n3.1 HardwareDesign\nTo monitor the PPG signal from an individual during movement, the de-\nvicedepictedinFigure5wasdeveloped. Thedesignemphasizedsimplicity,\nreliabledatareadings,wearability,andwirelesscapabilities. Toensureflex-\nibilityinmodifyingthedesignandtostreamlinethedevelopmentprocess,the\nelectronicsaremodular,anddevelopmentkitswereusedwherepossibleto\ndemonstratetheconcept. TheMAX30101[39],anintegratedpulseoximetry\nandheart-ratemonitormodule,waschosenasthesensor. Themicrocontroller\nforthisdesignwasselectedtosupportperipheralinterfacesforsensorinter-\naction,havelowpowerconsumptionforusewithasmallbattery,andprovide\nwirelessconnectivity. TheESP32-DevKitCV4(ESP32)[41]wasselected\nforthispurpose. ItusestheESP32-WROOM-32MCU moduletocontrol\nthe sensor’s operation and includes the I²C peripheral for interfacing with\nthe MAX30101. Both the sensor and the microcontroller is powered by a Figure5:PPGDatacollectionWearable\nbatteryandtheentiresystemisstoredina3Dprintedhousing. Integrating\nthesensorsandtheprocessorintoasinglechipcouldreducethesizeofwearablebyapproximately50%. However,the\nprimaryfocusofthisstudyistoexplorefeasibility,sothesizeofthewearablewasnotamajorconsideration.\nTogatherPPGsensorydataandtotransmitthedatatoacomputer,firmwarefortheESP32andasoftwareprogram\nonthecomputerweredeveloped. ThefirmwareinvolvedestablishingaconnectiontotheMAX30101andawireless\nconnectiontothecomputer. Thesoftwareonthecomputerreceivedthedatafromthedeviceandsecurelystoreditonto\nthedevice. ATCPconnectionwaschosen,asitallowedforremoteconnectivitytothedeviceandreliabledeliveryof\nthesensoryandtimedata. TheTCPclientandTCPserverwerefoundonacomputerandthedevicerespectively.\n3.2 SoftwareDesign\nThe software for the ESP32, programmed in C, was designed for two tasks: sensory data acquisition and TCP\ncommunication. TheformerinvolvedestablishingtheI²CconnectionbetweentheMAX30101sensorandtheESP32\nandreadingPPGdatafromtheredLED.ThelatterestablishedtheTCPserveronthedeviceandtransmittedthePPG\ndataandthetimeforeachrecordingovertheconnection. TheArduinoWi-Fi[42]andWire[43]andtheSparkFun\nMAX30101[44]sensorlibrarieswereusedforthiscodeFigure6illustratesthefirmwareontheESP32. Toactivatethe\nFigure6: Flowchartforthedevicesoftware(device.ino)\nsetupofthedevice,thedeviceneededtobepoweredandtheenablebuttonontheESP32hadtobepressed. TheWi-Fi\nconnectiontodevicewasthenestablished,thusallowingforthecreationoftheTCPserveronthedevice. Theprogram\nthencheckediftherewasanI²CconnectionbetweenthepinsoftheMAX30101andtheESP32. Uponconfirmationof\naconnection,theparametersfortheMAX30101wereset. Uponcompletionofthesetup,theloopcodewasinitialised.\n7\nMLAssistedPosturalMovementDetectionusingPPG\nFigure7: Flowchartforthereceiversoftware(recciever.py)\nTheestablishmentoftheTCPclientobjectintheloopallowedforthedevicetocheckforclientconnectionstothe\nserver. The program would then go into a nested while loop, where it continually checks that the connection has\nbeenmaintainedandthatlessthanaminuteofrecordinghastakenplace,otherwiseclosingtheconnection. Ifthese\nconditionshavebeenmet,thentheESP32willasktheMAX30101toproducenewdataandwilltransmitthePPG\nsensorydataandthetimedata,oncetheyhavebecomeavailable. Fortheclienttobeabletodifferentiatethedatatype\nbeingtransmitted,theMostSignificantBit(MSB)ofthedatapointissetaseitherhighfortimedata,orlowforsensory\ndata. Thesensorandtimedataaretransmittedasacontinuousstreamof32-bitintegerstotheclientandareseparated\nthroughtheuseofacomma.\nTheclientsideoftheTCPconnectionisaPythonprogramthatrunsonacomputerandutilisesSocketpythonlibrary\n[45]. Figure7showsthestructureofthecode. Theinitialstepcreateda“socket”TCPclientobjectandattemptedto\nconnectthistotheESP32TCPserver. Thiswillthenbeginawhileloopthatwillreceivedatafromthedeviceuntilthe\ntimerontheESP32reaches1minuteandclosestheconnection. Onceconnected,theclientwillreadthedatareceived\nfromthedeviceanddecodesthepacketsintoindividualdatapoints. TheprocessinginvolvesremovingtheMSBofthe\nreceiveddata,indicatingthedatatype,andstoringtheremainingdata. Theerrorflaggingallowsfortherealignmentof\nerroneousreceiveddatathatwerefragmentedduringthereadprocess. Ifnoinformationisbeingtransmittedfromthe\ndevice,primarilyduetotherecordingbeingcompleted,thenthecomputerwilldisconnecttheclienttotheserverand\nwillstorethegathereddataasa.mfile.\nFigure8: ExamplesoftherawandfilteredPPGsignalsfortheposturalmovements\n8\nMLAssistedPosturalMovementDetectionusingPPG\n3.3 DataCollection\nParticipantswererecruitedtotakepartinacontrolledposturalmovementrecognitionexperiment. Participantswere\naskedtoperformtwoactivities. Thesemovementsincluded:\n1. Sittingstationaryonachairtomoveintoastandingposition.\n2. Lyingflatonthegroundtomoveintoastandingposition.\nTheinitialstepwasfortheparticipanttoplacethedeviceontotheirtemple(otherlocations). Adjustmentsweremade\ntothepositionofthedevicetoensureagoodcontactpressurebetweenthedeviceandtheskin. Aninitialtestrecording\nwasdonetomakesurethatanexpectedPPGvaluewasbeingread,confirmingthecorrectplacementofthedevice. The\nparticipantwasthenaskedtoremainintheinitialstationarypositionforaperiodof30seconds,maintainingaregular\nbreathingpatternandwithoutmovingortalking. At29seconds,anindicationthatthe30secondpointwasapproaching\nwasgivingandat30seconds,theparticipantwasaskedtostand. Theyremainedforaperiodof30secondsinthe\nstandingposition.\n11participantswererecruitedforthestudy. ThedevicewasusedtorecordthePPGsignalwhilstparticipantsmoved\nfrom sitting-to-standing and lying-to-standing. This generated a total of 2460 seconds of labelled data. Of the 41\nrecordings,24wereforsitting-to-standingtransitionsandtheremainingwereforlying-to-standingtransitions.Improper\nplacementofthesensor,movementofthesensorastheparticipantmovedintothestandingpositionandmovement\nduringthestationaryphasesoftherecordingscreatederrorswhichmeantthat3oftherecordingswerenotusedinthe\ndata.\nFigure8illustratesthedifferencesthatcanbefoundbetweenthethreeclasses.Betweentheposturalmovementschanges\ntothesignalduetothemovementcanbeobserved. Forthesitting-to-standingandlying-to-standingmovements,an\nincreaseinbloodvolumeafterthemovementat30secondsandsubsequentlydroppedat40seconds. Betweenthe\nthreemovementsshowninFigure8,thestandarddeviationsofthesystolicpeaksofthestationary,sitting-to-standing\nandlying-to-standingare±160.6,±429.7and±1100.7respectively. Thegreatervariabilityoftherawsignalwith\nmovements indicates that there is an increasing variability in the blood volume changes, with the largest changes\noccurringwithlying-to-standingmovements.\nFigure9: PPGsignalprocessingalyingpositiontoastandingposition(a)Rawsignal,(b)Detrendedsignal,(c)Filtered\nsignal,(d)FilteredPPGpulses.\nForthefilteredwaveforms,thechangesfromthestationarysignalpatternwereprimarilyduringtheinitialmovement.\nAdditionally,theincreaseinbloodvolumeisindicatedbyadecreaseinthesystolicanddiastolicamplitudes,fluctuating\ndependingonthegradientofthebloodvolumechanges. Furtherdifferentiationbetweenthesitting-to-standingand\nlying-to-standingmovementscanbeseeninthelargeramplitudesoftheinitialMAforthelying-to-standingmovement.\n3.4 SignalProcessing\n9\nMLAssistedPosturalMovementDetectionusingPPG\nForeachrecordingofaparticipant’sposturalmovements,\nthePPGinformationwasobtainedbyanalgorithmdevel-\nopedinMATLAB.Theprogramprocessedtherawdatainto\ndifferentformats,filteredunwantednoiseandsegmented\nthesignalintoindividualPPGpulses. Eachpulsethenhad\nthePOIandfeaturesdetermined.\nTo ensure that accurate results could be collected from\nthe PPG wave, the raw signal was pre-processed before\nfeatureextraction. Toremoveerroneousdatathatmaybe\npresent in the time and sensor data, results out with the\nexpected ranges from the data were removed. Figure 9 Figure10: ExampleofpulseonsetdetectionofthePPG\nshowsanexampleofatransitionfromalyingpositionto signal\nastandingposition. ToisolatetheMAaspectsofthewave,\ntheMATLAB‘detrend’functionandabandpassfilteris\nappliedtothePPGwave. Thedetrendfunctionremoves\nthe linear trends and DC component of the signal. For\nthefilter,anormalisedstartfrequency0.0075Hz/sample\nand a stop frequency of 0.2 Hz/sample. The removal of\nthehigherfrequencyaspectsofthePPGwaveformreduce\nnoiseandthelikelihoodoffalsepeaks. Theremovalofthe\nlowfrequencycomponentsremovestheeffectsofbaseline\nwandering.TheaffectofthefiltercanbeseeninFigure9(c),\nwherethePPGsignalmagnitudesarenormalisedaround Figure11: Diastolicpeakdetection,displayingthematch-\nzero. ingofthesecondderivativeminimatothezerocrossing\npointsinthefirstderivative\nFortheanalysisofthewaveform,thePPGsignalwasseg-\nmentedintoindividualpulses. Thiswascompletedbyidentifyingthepulseonsetsandstoringthewaveformsfound\nbetween these values. To identify the pulse onset, the minima of the PPG wave were identified. To improve the\nreliabilityandprecisionoftheidentificationofthetruepulseonsets,theprocessillustratedinFigure10wasused. A\ncentremovingaveragefilterwasusedtocalculateabaselineofthePPGwaveform. Toremovefallsonsets,theminima\nofthewavewereselectedifthedistancebetweenminimawaslargerthanhalftheperiodofthesignalpulsesandifthe\nminimacouldbefoundbelowthebaseline. Thiseliminateddicroticnotchesbeingmisidentifiedastheonsetofthe\npulses.\nForeachofthepulsesofthePPGsignal,thePOIwereidentified. ForthefilteredPPGsignal,thePOIfoundseenin\nFigure3werefound. Thisincludedthemagnitudesandtimesfortheonsetofthepulse,theendpoint,thesystolic\npoint,thediastolicpointandthedicroticnotch. Thesepointswerealsoidentifiedforeachofthepulsesintherawand\ndetrendedPPGsignals. Theonsetandendingpointsweredeterminedusingtheminimalocatedduringthesegmentation\nprocess. Thesystolicpointwasidentifiedbyfindingthemaximumpeakofthepulse. Figure11showsthedetection\nprocessforthediastolicpeak.\nTheinitialstepwastodeterminetheminimaofthesecondderivativeandthezerocrossingpointsofthefirstderivative.\nTodeterminethediastolicpeak,whereaminimaofthesecondderivativehadthesametimevalueastherightmost\nzerocrossingpoint,excludingtheendingofthepulse. Ifamatchcannotbefound,thelocationoftherightmostzero\ncrossingpointisused. Thisincreasedthereliabilityofdetectingthediastolicpoint,astheshallowgradientofthepulse\ncanpeakidentificationerrorswhenutilisingregularpeakdetection.\n3.5 FeatureSelectionandExtraction\nTovisualizetheimportanceofthefeaturesfortheremovalofredundantpredictors,theChi-squaretestalgorithmwas\nutilized[38]. TheChi-squaredtestperformsastatisticalhypothesistestanddeterminesthedifferencesbetweenthe\nobservedandexpectedfrequenciesofsampleswithinthedata. Therelevance’softhefeatureswerethenranked. Figure\n12showsthechi-squaredtestimportancevaluesforeachofthe21featuresgathered. Thefeaturesthathadthehighest\nassociationstothetargetvariableswerethesystolicmagnitude,systolicrisegradientandrawsystolicamplitude. The\nfeaturesthathadtheleastsignificancefortheclassifierwerethedetrendeddiastolicamplitude,diastolicmagnitudeand\nthedicroticmagnitude. Thelownumberoffeaturesmeantthatareductionofasinglefeaturecouldaffecttheoverall\nperformanceofthealgorithmtraining,soonlyfeaturesthathadlittleimportancewereremoved. Therefore,thedicrotic\nmagnitudewasremoved.\n10\nMLAssistedPosturalMovementDetectionusingPPG\nTable1: Chi-squaredtestfeaturesinorderofimportance\nFeatureindex Feature\n1 Systolicmagnitude\n2 Systolicrisegradient\n3 Rawsystolicamplitude\n4 systolicamplitude\n5 Systolicanddiastolicpeakdifference\n6 Detrendedsystolicamplitude\n7 Pulseonsetmagnitude\n8 Rawoffset\n9 Raworthostaticmagnitude\n10 PulseWidth\n11 Endpointmagnitude\n12 Detrendedoffset\n13 Diastolicamplitude\n14 Rawdiastolicamplitude\n15 Systolicphase\n16 Diastolicphase\n17 Offset\n18 Detrendedorthostaticmagnitude\n19 detrendeddiastolicamplitude\n20 diastolicmagnitude\n21 dicroticmagnitude\nFor the detection of the differences in PPG signals from\nindividualsegments,asetoffeaturescapableofdiscrimi-\nnatingbetweenmovementtypesisessential.Thesefeatures\nwereextractedfromthePOIdeterminedforboththeraw,\ndetrendedandfilteredpulsesofthePPGsignal. Theanaly-\nsisdonewascompletedusingtimedomainanalysis,asthis\nallowedfortheobservationofchangesinthemorphology\ninthePPGpulses.\nFor each of the pulses, the POI can be used to derive a\nvarietyoffeatures. ThefeaturesfoundinFigure3, such\nFigure12: Chi-squaredtestfeatureselectionimportances.\nas the pulse width, the systolic and diastolic amplitudes,\nThefeaturescanbefoundinTable1.\nthe systolic and diastolic phases and the offset. Further-\nmore,thepeakdifferencebetweenthesystolicanddiastolic\npoints,referredtoasthePPGpeakdifference,andthegradientofthesystolicriseweredetermined. Similarfeatures\nwereextractedfromthedetrendedandrawPPGsignals.\nAdditionally,anotherfeaturewasextractedtomeasurethe\neffectoftheorthostaticstress. AsseeninFigure13,large\nchanges in the systolic magnitudes of the raw signal be-\ntweenthePPGvaluesatrestcomparedtothevaluesafter\nthemovement. Toquantifythis,afeaturecalledtheortho-\nstaticmagnitudewasfound. Abaselinevaluefromwhen\nthewearerwasstationaryineitherthesittingorlyingposi-\ntionswasdetermined. Theorthostaticmagnitudeisdefined\nasthedifferenceinheightbetweenthesystolicpeakand\nthebaselinevalue. Theorthostaticmagnitudewasfound\nforboththerawanddetrendedsignals.\nThe MATLAB classification learner app was utilised to\ntrain and analyse a variety of ML algorithms. A table\nFigure 13: Example of the orthostatic magnitude for a\ncontainingtheextractedfeaturesfromthePPGdata,where\nlying-to-standingPPGsignal.\nthetypeofmovementislabelled,isinputintothetoolbox.\nThealgorithmswereimplementedusingseveralpresethyperparameterconfigurations. Thedatasetwassplitatraining\n11\nMLAssistedPosturalMovementDetectionusingPPG\nsetandatestsetintoa9:1ratio. Across-validationstrategywasappliedtocreatedivisionsinthedata,wherekfoldsin\nthedatasetaretrainedinthemodelktimes,reducingtheeffectsofoverfitting. Thecross-validationprocesssplitthe\ndatasetinto10separatefolds.\n3.6 MachineLearningresults\nTheperformanceoftheMLmodelswereevaluatedwiththreemetrics,accuracy,precision,sensitivityandtheF1score\nforeachactivity[38]. Thedefinitionsfortheabovemetricsaredefinedasbelow:\nTP +TN\nAccuracy(%)= ×100 (1)\nTP +FP +FN +TN\nTP\nPrecision(%)= ×100 (2)\nTP +FP\nWhere:\n• TruePositive(TP):Thenumberofsegmentsthatarecorrectlyclassifiedthemovement.\n• TrueNegative(TN):Thenumberofsegmentswherethemovementiscorrectlyrejected.\n• FalsePositive(FP):Thenumberofsegmentsincorrectlyclassifiedthemovement,whenitwasanotherclass.\n• FalseNegative(FN):Thenumberofsegmentswheretheclassifierfailedtopredictthecorrectmovement.\nTheresultsforthesemetricsforMLalgorithmconfigurationscanbe\nfoundinTable2. Theaccuracyscoreisarepresentationoftheoverall\naccuracyofthemodelincorrectlypredictingthecorrectmovement\nfor the 3 classes. The average validation and test accuracy values\nforalltheMLmodelsusedwas81.4%and77.7%respectively. For\nthe recognition of the types of movements, all the algorithms had\nthe best performance at detecting if the individual was stationary,\nwithanaverageF1scoreof88.8%. ThisgreatlydiffersfromtheF1\nscoresofthesitting-to-standingandthelying-to-standingtransitions\nof38.7%and57.1%respectively. Betweenalgorithms,therewere\nsizable differences between the correct recognition of movements.\nThestandarddeviationsbetweentheaveragevaluesoftheF1scores\nforeachalgorithmare±3.4%,±16%and±16.8%forthethreeclasses.\nThisindicatesthatthereisagreaterspreadintherecognitionaccura-\nciesofforthesitting-to-standingandthelying-to-standingtransitions.\nThis can be attributed to some of the algorithms failing to detect\nposturalmovements,suchasthecoarseDTandcoarseKNNfailing Figure14: F1scoresforthewideANN\ntodetectthesitting-to-standingmovements.\nThealgorithmswiththehighestperformingaccuracyscoreswereKNN,withanaveragetestaccuracyof81.1%,and\nANN,withaaveragetestaccuracyof81.6%. ThesealgorithmshadthehighestF1scores,withANNhavingamuch\nbetterperformancethanKNNforthedetectionofthesitting-to-standingtransition. ThisdisparitymeantthatANNhad\nabetteroverallrecognitionperformanceincomparisontoKNN,withanaverageF1scoreof6%higherthanKNN.\nThethreebestperformingalgorithmswerethecubicSVM,withanaverageF1scoreof76.1%,thefineKNN,with\nascoreof76.9%,andthewideANN,withascoreof78.2%. ThefineKNNalgorithmhadthehighestperforming\nvalidationandtestaccuracyscores,with87.8%and86.4%respectively. ThequadraticSVMutilisedaquadratickernel\ntodeterminetheboundariesbetweenclasses. ThefineKNNwastrainedfortherecognitionof1neighbour. Thewide\nANNwasasinglefullyconnectedlayerwithover100neuronsbetweentheinputandoutputlayers.\nWiththegreatestaverageperformanceacrossallclasses, theMLalgorithmthatwaschosenfortherecognitionof\nmovementwasthewideANN.TheevaluationandtestaccuraciesfortheANNare87.7%and85.2%respectively.\nFigure19showsthecorrespondingF1scoresforthecorrectandincorrectlymovementrecognitionfortheANN.\n4 Discussion\nThe results show that postural movement recognition is a feasible option through the analysis of PPG distortions.\nBetweenthemovingandstationarymeasurements,theexpectedchangestothePPGsignaloccurs[27]. Asseenin\n12\nMLAssistedPosturalMovementDetectionusingPPG\nTable2: MachinelearningalgorithmevaluationswithaccuracyscoresforeachmodelandF1scoresforeachclass. S=\nStationary,SS=Sitting-to-standingandLS=Lying-to-standing.\nFigure 8, the effect of orthostatic stress and baroreflex response [10] can be observed in the increase in the blood\nvolume at 30 seconds due to the movement and the decrease back to the values found before the movement at 40\nseconds. Thedifferencesbetweenthemagnitudesofthesechangesbetweenmovements,withthelying-to-standing\nmovementshavinglargervariationscomparedtothesitting-to-standing. ThisallowedthewideANNtorecognise\n13\nMLAssistedPosturalMovementDetectionusingPPG\ntheposturalmovements. ComparedtosimilarHARstudiesforstandalonePPGsignals, theproposedmethodhad\nasimilarperformancefortherecognitionoftherecognitionoftheseactivities[11]. Thissystemwouldallowfora\ngeneral-purposemonitoringsystemtobeusedbycarehomestafftomonitorpeopleatrisksoffallsaroundtheirroom.\nThegreaterperformancefortheMLalgorithminclassifyingthestationaryPPGsignalscouldhavebeenduetothe\nregular morphology of the stationary PPG pulses compared to the PPG signals distorted due to movement. For a\nstationaryparticipant,thenumberoffactorsthatcanincreasethevariabilityofthePPGsignalislessthancompared\ntoiftheparticipantismoving. Thisallowsforclearerpatternstobefoundinthefeatures. Furthermore,thehigher\nperformanceofthelying-to-standingmovementscomparedtothesitting-to-standingcanbeattributedtothemore\ncomplex and the increased time taken for the movement. For a younger adult, these differences may be reduced.\nHowever,forthoseariskoffalls,suchaselderlypeople,OHandagerelatedreductionsinthebaroreflex[26]increase\nthelengthandmagnitudesofthedistortions. Thegreaterchangescouldincreasetheperformanceoftherecognition\nof movements. However, this would have to be further investigated with elderly participants completing postural\nmovements.\nTheChi-squaredtestshowedthatthefeaturesthathadthegreatestimpactonrecognisingthetypesofmovementwere\nthoseassociatedwithsystolicpointandthefeatureswiththelowestimpactwerethoseassociatedwiththediastolic\npointandthedicroticnotch. Thisindicatesthatchangesinthemovementweremorenoticeableandidentifiableforthe\nfeaturesinvolvingthesystolicpoint.\nThe overlap between class features meant that algorithms that looked for clear boundaries in large groups of data\nperformed worse than algorithms that observed differences in classes in more complex, local groupings. Linear\nboundary classifiers were among the lowest performing models, with an average F1 score of 42.6% for LDA and\n37.38%forLinearSVM.TheoverlapmeantthatANNwereabletoperformparticularlywell,withthehighestaverage\nF1scoreforthethreeclasses,asthealgorithmallowsforcomplexmappingofinputsandoutputs. Whencomparingthe\nwideANNtotheothersinglelayerANN,thelargerlayersizeincreasedtheoverallperformanceofthemodel. The\nincreasedsizeallowsforagreatercapacityinlearningmorecomplexpatternsinthedataset,thusallowingforabetter\nabilitytodifferentiatebetweenclasses.\nThisstudyhasseverallimitations. Eventhoughtheconditionfortherecordingofposturalmovementswereanissue\nthathastobeconsideredwassegmentdistributionimbalance. 79%ofthesegmentsinthedatasetwererelatedtowhen\nthedevicewearerwasstationarybeforethemovementandafterthebloodvolumehadreturnedtobaselinevalues. The\nremainingsegmentsweredistributedbetweenthesitting-to-standingandlying-to-standingtransitionrecognitionsets.\nTogiveabetterrepresentationoftheperformanceforindividualclasses,metricsuchastheprecision,sensitivityand\nF1scorewereused. However,duetothelimiteddatasetrepresentingthemovementoftheindividual,resampling\nmethodsthatequalisedthenumberofsegmentsperclasswouldgreatlyreducetheoveralldatasettrainingandevaluation\nsize. Thiscouldleadtoissuessuchasoverfitting,biasandalowperformanceinreal-worldrecognitionofpostural\nmovements.\nMoreover,thedatasetwastakenfromyoungadults. Toimprovetheaccuracyofthemodelforthepurposeoffall\npreventioninacarehome,furtherworkwouldberequiredtoinvestigatetherelationshipbetweenthechangesinthe\nPPGsignalwithmovementwiththosemoreatriskoffalls.\n5 Conclusion\nThisstudyexploredthefeasibilityofemployingaPPGsensorincombinationwithmachinelearningtechniquesto\nrecognizevariousposturalmovements. Aspecializedhardwaredevicewasdevelopedtocaptureandwirelesslytransmit\nPPGsignalsfromindividualsastheytransitionedfromsittingandlyingpositionstostanding. Thedatacollectedfrom\ntheseactivitiesformedacomprehensivedatabaseusedforsubsequentanalysis.\nMachinelearningalgorithmsDT,DA,NB,SVM,KNNandANNwasappliedtoclassifytheseposturalmovements,with\ntheF1scoreservingastheprimarymetrictoevaluatetheeffectivenessofeachalgorithm. Resultsindicatedthatthe\nANNmodelachievedanaccuracyof85%andanaverageF1-scoreof78%,positioningitasthemosteffectivemodel\nforthisapplication. ThesefindingssuggestthattheintegrationofPPGsensorswithMLalgorithmsholdspromisefor\naccuraterecognitionofposturaltransitionsininclusivesettings.\nAcknowledgments\nThisworkwaspartiallysupportedbyUniversityofBristolinternalfunding.\n14\nMLAssistedPosturalMovementDetectionusingPPG\nReferences\n[1] ‘Elderlypeopleandfalls: howhealthcarecanbettersupporttheUK’sageingpopulation’,PPPTakingCare.Ac-\ncessed: Apr.02,2024.[Online].Available: https://taking.care/blogs/resources-advice/elderly-falls-and-healthcare-\nreport\n[2] ‘Falls’,nhs.uk.Accessed: Apr.02,2024.[Online].Available: https://www.nhs.uk/conditions/falls/\n[3] ‘Falls: applying All Our Health’, GOV.UK. Accessed: Apr. 02, 2024. [Online]. Available:\nhttps://www.gov.uk/government/publications/falls-applying-all-our-health/falls-applying-all-our-health\n[4] S. Usmani, A. Saboor, M. Haris, M. A. Khan, and H. Park, ‘Latest Research Trends in Fall Detection and\nPreventionUsingMachineLearning: ASystematicReview’,Sensors(Basel),vol.21,no.15,p.5134,Jul.2021,\ndoi: 10.3390/s21155134.\n[5] J.Hamm,A.G.Money,A.Atwal,andI.Paraskevopoulos,‘Fallpreventioninterventiontechnologies: Aconceptual\nframeworkandsurveyofthestateoftheart’,JournalofBiomedicalInformatics,vol.59,pp.319–345,Feb.2016,\ndoi: 10.1016/j.jbi.2015.12.013.\n[6] ‘Effectivehealthcareforolderpeoplelivingincarehomes’,BritishGeriatricsSociety.Accessed: Apr.09,2024.\n[Online].Available: https://www.bgs.org.uk/resources/effective-healthcare-for-older-people-living-in-care-homes\n[7] C.Lu,J.Huang,Z.Lan,andQ.Wang,‘Bedexitingmonitoringsystemwithfalldetectionfortheelderlyliving\nalone’,in2016InternationalConferenceonAdvancedRoboticsandMechatronics(ICARM),Aug.2016,pp.59–64.\ndoi: 10.1109/ICARM.2016.7606895.\n[8] E.Capezuti,B.L.Brush,S.Lane,H.U.Rabinowitz,andM.Secic,‘Bed-exitalarmeffectiveness’,ArchGerontol\nGeriatr,vol.49,no.1,pp.27–31,2009,doi: 10.1016/j.archger.2008.04.007.\n[9] J.Allen,‘Photoplethysmographyanditsapplicationinclinicalphysiologicalmeasurement’,Physiol.Meas.,vol.\n28,no.3,p.R1,Feb.2007,doi: 10.1088/0967-3334/28/3/R01.\n[10] S.P.Linder,S.M.Wendelken,E.Wei,andS.P.McGrath,‘Usingthemorphologyofphotoplethysmogrampeaks\ntodetectchangesinposture’,JClinMonitComput,vol.20,no.3,pp.151–158,Jun.2006,doi: 10.1007/s10877-\n006-9015-2.\n[11] M.Boukhechba,L.Cai,C.Wu,andL.E.Barnes,‘ActiPPG:Usingdeepneuralnetworksforactivityrecognition\nfrom wrist-worn photoplethysmography (PPG) sensors’, Smart Health, vol. 14, p. 100082, Dec. 2019, doi:\n10.1016/j.smhl.2019.100082.\n[12] M.Alessandrini,G.Biagetti,P.Crippa,L.Falaschetti,andC.Turchetti,‘RecurrentNeuralNetworkforHuman\nActivityRecognitioninEmbeddedSystemsUsingPPGandAccelerometerData’,Electronics,vol.10,no.14,Art.\nno.14,Jan.2021,doi: 10.3390/electronics10141715.\n[13] E. Brophy, J. J. D. Veiga, Z. Wang, A. F. Smeaton, and T. E. Ward, ‘An Interpretable Machine Vision Ap-\nproach to Human Activity Recognition using Photoplethysmograph Sensor Data’. arXiv, Dec. 03, 2018. doi:\n10.48550/arXiv.1812.00668.\n[14] Y.-L.Zhengetal.,‘UnobtrusiveSensingandWearableDevicesforHealthInformatics’,IEEETransactionson\nBiomedicalEngineering,vol.61,no.5,pp.1538–1554,May2014,doi: 10.1109/TBME.2014.2309951.\n[15] D. Ray, T. Collins, S. I. Woolley, and P. V. S. Ponnapalli, ‘A Review of Wearable Multi-Wavelength\nPhotoplethysmography’, IEEE Reviews in Biomedical Engineering, vol. 16, pp. 136–151, 2023, doi:\n10.1109/RBME.2021.3121476.\n[16] L.Chen,A.T.Reisner,andJ.Reifman,‘Automatedbeatonsetandpeakdetectionalgorithmforfield-collected\nphotoplethysmograms’,in2009AnnualInternationalConferenceoftheIEEEEngineeringinMedicineandBiology\nSociety,Sep.2009,pp.5689–5692.doi: 10.1109/IEMBS.2009.5333542.\n[17] J.Park,H.S.Seok,S.-S.Kim,andH.Shin,‘PhotoplethysmogramAnalysisandApplications: AnIntegrative\nReview’,FrontPhysiol,vol.12,p.808451,Mar.2022,doi: 10.3389/fphys.2021.808451.\n[18] P. H. Charlton, P. A. Kyriacou, J. Mant, V. Marozas, P. Chowienczyk, and J. Alastruey, ‘Wearable Photo-\nplethysmography for Cardiovascular Monitoring’, Proc. IEEE, vol. 110, no. 3, pp. 355–381, Mar. 2022, doi:\n10.1109/JPROC.2022.3149785.\n[19] D. Castaneda, A. Esparza, M. Ghamari, C. Soltanpur, and H. Nazeran, ‘A review on wearable photoplethys-\nmography sensors and their potential future applications in health care’, International journal of biosensors &\nbioelectronics,vol.4,no.4,p.195,2018,doi: 10.15406/ijbsbe.2018.04.00125.\n15\nMLAssistedPosturalMovementDetectionusingPPG\n[20] V. Vizbara, ‘Comparison of Green, Blue and Infrared Light in Wrist and Forehead Photoplethysmography’,\nBIOMEDICALENGINEERING2016,vol.17,no.1,Art.no.1,Nov.2013,Accessed: Nov.06,2023.[Online].\nAvailable: http://biomed.ktu.lt/index.php/BME/article/view/460\n[21] A.Chandrasekhar,M.Yavarimanesh,K.Natarajan,J.-O.Hahn,andR.Mukkamala,‘PPGSensorContactPressure\nShouldBeTakenIntoAccountforCuff-LessBloodPressureMeasurement’,IEEETransactionsonBiomedical\nEngineering,vol.67,no.11,pp.3134–3140,Nov.2020,doi: 10.1109/TBME.2020.2976989.\n[22] T.Tamura,Y.Maeda,M.Sekine,andM.Yoshida,‘WearablePhotoplethysmographicSensors—PastandPresent’,\nElectronics,vol.3,no.2,Art.no.2,Jun.2014,doi: 10.3390/electronics3020282.\n[23] M. A. Almarshad, M. S. Islam, S. Al-Ahmadi, and A. S. BaHammam, ‘Diagnostic Features and Potential\nApplicationsofPPGSignalinHealthcare: ASystematicReview’,Healthcare(Basel),vol.10,no.3,p.547,Mar.\n2022,doi: 10.3390/healthcare10030547.\n[24] R.Couceiro,P.Carvalho,R.P.Paiva,J.Henriques,andJ.Muehlsteff,‘Detectionofmotionartifactpatternsin\nphotoplethysmographicsignalsbasedontimeandperioddomainanalysis’,Physiol.Meas.,vol.35,no.12,p.2369,\nNov.2014,doi: 10.1088/0967-3334/35/12/2369.\n[25] P. H. Charlton, P. Celka, B. Farukh, P. Chowienczyk, and J. Alastruey, ‘Assessing mental stress from the\nphotoplethysmogram: anumericalstudy’,Physiol.Meas.,vol.39,no.5,p.054001,May2018,doi: 10.1088/1361-\n6579/aabe6a.\n[26] K.D.Monahan,‘Effectofagingonbaroreflexfunctioninhumans’,AmericanJournalofPhysiology-Regulatory,\nIntegrativeandComparativePhysiology,vol.293,no.1,pp.R3–R12,Jul.2007,doi: 10.1152/ajpregu.00031.2007.\n[27] A.Mol, A.B.Maier, R.J.A.vanWezel, andC.G.M.Meskers, ‘MultimodalMonitoringofCardiovascular\nResponsestoPosturalChanges’,FrontPhysiol,vol.11,p.168,Mar.2020,doi: 10.3389/fphys.2020.00168.\n[28] J.M.Vicente-Samperetal.,‘AnML-BasedApproachtoReconstructHeartRatefromPPGinPresenceofMotion\nArtifacts’,Biosensors(Basel),vol.13,no.7,p.718,Jul.2023,doi: 10.3390/bios13070718.\n[29] C.Wuerich,C.Wiede,andG.Schiele,‘CufflessBeat-to-BeatBloodPressureEstimationfromPhotoplethysmo-\ngramSignals’,in2023IEEE36thInternationalSymposiumonComputer-BasedMedicalSystems(CBMS),Jun.\n2023,pp.305–310.doi: 10.1109/CBMS58004.2023.00235.\n[30] R.G.Priyadarshini,M.Kalimuthu,S.Nikesh,andM.Bhuvaneshwari,‘ReviewofPPGsignalusingMachine\nLearningAlgorithmsforBloodPressureandGlucoseEstimation’,IOPConf.Ser.: Mater.Sci.Eng.,vol.1084,no.\n1,p.012031,Mar.2021,doi: 10.1088/1757-899X/1084/1/012031.\n[31] C.-H.Goh,L.K.Tan,N.H.Lovell,S.-C.Ng,M.P.Tan,andE.Lim,‘RobustPPGmotionartifactdetectionusing\na1-Dconvolutionneuralnetwork’,ComputerMethodsandProgramsinBiomedicine,vol.196,p.105596,Nov.\n2020,doi: 10.1016/j.cmpb.2020.105596.\n[32] M.Alkhodari,D.K.Islayem,F.A.Alskafi,andA.H.Khandoker,‘PredictingHypertensivePatientsWithHigher\nRiskofDevelopingVascularEventsUsingHeartRateVariabilityandMachineLearning’,IEEEAccess,vol.8,pp.\n192727–192739,2020,doi: 10.1109/ACCESS.2020.3033004.\n[33] A.Tharwat,T.Gaber,A.Ibrahim,andA.E.Hassanien,‘Lineardiscriminantanalysis: Adetailedtutorial’,AI\nCommun.,vol.30,no.2,pp.169–190,Jan.2017,doi: 10.3233/AIC-170729.\n[34] S. Mehrang et al., ‘Human Activity Recognition Using A Single Optical Heart Rate Monitoring Wristband\nEquippedwithTriaxialAccelerometer’,inEMBEC&NBC2017,H.Eskola,O.Väisänen,J.Viik,andJ.Hyttinen,\nEds.,Singapore: Springer,2018,pp.587–590.doi: 10.1007/978-981-10-5122-7_147.\n[35] S.Mohamed,M.Ismail,Z.Abidin,andA.Rashid,‘ArtificialNeuralNetworks(ANN)ApproachtoPPGSignal\nClassification’,InternationalJournalofComputing&InformationSciences,vol.2,May2004.\n[36] W.-C.Chou,W.-Y.Lin,M.-Y.Lee,andK.F.Lei,‘DesignandAssessmentofaReal-TimeAccelerometer-Based\nLying-to-SitSensingSystemforBedFallPrevention’,in2013IEEEInternationalConferenceonSystems,Man,\nandCybernetics,Oct.2013,pp.1471–1475.doi: 10.1109/SMC.2013.254.\n[37] E.Fortune,V.A.Lugade,andK.R.Kaufman,‘PostureandMovementClassification: TheComparisonofTri-\nAxialAccelerometerNumbersandAnatomicalPlacement’,JBiomechEng,vol.136,no.5,pp.0510031–0510038,\nMay2014,doi: 10.1115/1.4026230.\n[38] N.Hnoohom,S.Mekruksavanich,andA.Jitpattanakul,‘PhysicalActivityRecognitionBasedonDeepLearning\nUsingPhotoplethysmographyandWearableInertialSensors’,Electronics,vol.12,no.3,Art.no.3,Jan.2023,doi:\n10.3390/electronics12030693.\n[39] ‘MAX30101 Datasheet and Product Info | Analog Devices’. Accessed: Nov. 12, 2023. [Online]. Available:\nhttps://www.analog.com/en/products/max30101.html\n16\nMLAssistedPosturalMovementDetectionusingPPG\n[40] ‘PIM438 Pimoroni | Mouser’, Mouser Electronics. Accessed: Apr. 06, 2024. [Online]. Available:\nhttps://www.mouser.co.uk/ProductDetail/Pimoroni/PIM438?qs=vLWxofP3U2xdALyphE5VGA%3D%3D\n[41] ‘ESP32-DevKitCV4GettingStartedGuide-ESP32-—ESP-IDFProgrammingGuidev5.2.1documentation’.\nAccessed: Apr. 06, 2024. [Online]. Available: https://docs.espressif.com/projects/esp-idf/en/stable/esp32/hw-\nreference/esp32/get-started-devkitc.html\n[42] ‘WiFi - Arduino Reference’. Accessed: Apr. 08, 2024. [Online]. Available:\nhttps://www.arduino.cc/reference/en/libraries/wifi/\n[43] ‘Wire - Arduino Reference’. Accessed: Apr. 08, 2024. [Online]. Available:\nhttps://www.arduino.cc/reference/en/language/functions/communication/wire/\n[44] SparkFunMAX3010xSensorLibrary’.SparkFunElectronics,Apr.08,2024.Accessed: Apr.08,2024.[Online].\nAvailable: https://github.com/sparkfun/SparkFun_MAX3010x_Sensor_Library\n[45] ‘socket—Low-levelnetworkinginterface’,Pythondocumentation.Accessed: Apr.08,2024.[Online].Available:\nhttps://docs.python.org/3/library/socket.html\n17",
    "pdf_filename": "Machine_Learning_Assisted_Postural_Movement_Recognition_using_Photoplethysmography(PPG).pdf"
}