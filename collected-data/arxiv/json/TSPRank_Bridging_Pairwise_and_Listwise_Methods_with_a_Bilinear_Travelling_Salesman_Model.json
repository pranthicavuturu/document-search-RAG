{
    "title": "TSPRank: Bridging Pairwise and Listwise Methods with a Bilinear",
    "abstract": "TraditionalLearning-To-Rank(LETOR)approaches,includingpair- learning-to-rank,pairwise-listwiseranking,travellingsalesman wisemethodslikeRankNetandLambdaMART,oftenfallshortby problem solelyfocusingonpairwisecomparisons,leadingtosub-optimal globalrankings.Conversely,deeplearningbasedlistwisemethods, ACMReferenceFormat: Weixian Waylon Li, Yftah Ziser, Yifei Xie, Shay B. Cohen, and Tiejun whileaimingtooptimiseentirelists,requirecomplextuningand Ma.2025.TSPRank:BridgingPairwiseandListwiseMethodswithaBi- yieldonlymarginalimprovementsoverrobustpairwisemodels.To linearTravellingSalesmanModel.InProceedingsofthe31thACMSIGKDD overcometheselimitations,weintroduceTravellingSalesmanProb- ConferenceonKnowledgeDiscoveryandDataMining(KDDâ€™25),August lemRank(TSPRank),ahybridpairwise-listwiserankingmethod. 3â€“7,2025,Toronto,Canada.ACM,NewYork,NY,USA,23pages.https: TSPRankreframestherankingproblemasaTravellingSalesman //doi.org/XXXXXXX.XXXXXXX Problem(TSP),awell-knowncombinatorialoptimisationchallenge thathasbeenextensivelystudiedforitsnumeroussolutionalgo- rithmsandapplications.Thisapproachenablesthemodellingof 1 INTRODUCTION pairwiserelationshipsandleveragescombinatorialoptimisation LearningtoRank(LETOR)algorithmshavebecomeessentialin todeterminethelistwiseranking.Thisapproachcanbedirectly applicationssuchasrecommendationsystems[16,30,36],question integrated as an additional component into embeddings gener- answering[10,15,27],andinformationretrieval[2,9,34].These atedbyexistingbackbonemodelstoenhancerankingperformance. algorithmsaimtoorderalistofrankingentitiesbasedontheir Ourextensiveexperimentsacrossthreebackbonemodelsondi- features,optimisingforthemostrelevantorpreferredentitiesto verse tasks, including stock ranking, information retrieval, and appearatthetop.Recently,LETORmethodshavealsoexpanded historicaleventsordering,demonstratethatTSPRanksignificantly intootherdomains,suchasstockandportfolioselection[45,50] outperformsbothpurepairwiseandlistwisemethods.Ourqualita- andtextualordering[46,49].Despitethesebroaderapplicationsof tiveanalysisrevealsthatTSPRankâ€™smainadvantageoverexisting LETOR,latestfundamentalworkonLETORstillprimarilyfocused methodsisitsabilitytoharnessglobalinformationbetterwhile onincorporatingclickdataintorankingmodelsandaddressing ranking.TSPRankâ€™srobustnessandsuperiorperformanceacross biasesintroducedbyuserfeedback[20,21,33,54],concentratingon differentdomainshighlightitspotentialasaversatileandeffective retrievalandrecommendationtasks.Limitedresearchhasexplored LETORsolution.Thecodeandpreprocesseddataareavailableat generalrankingmethodsacrossdiversetasksanddomains. https://github.com/waylonli/TSPRank-KDD2025. Overthepastdecade,researchonLETORmodelsmainlyfocuses onpairwiseandlistwiseapproaches,whilepointwisemethodsoften CCSCONCEPTS failtocapturetheintricateinter-entityrelationshipsthatareessen- tialforaccurateranking.Pairwisemethods,suchasLambdaMART â€¢Informationsystemsâ†’Learningtorank. andRankNet[6],primarilyoptimiseforpairwisecomparisonswith- outaholisticviewoftheentirerankinglist,potentiallyleadingto sub-optimalglobalrankings.Listwisemethodsoptimisetheranking ofentirelistsdirectlyratherthanindividualsorpairs.Thiscategory Permissiontomakedigitalorhardcopiesofallorpartofthisworkforpersonalor includesadvancedneuralnetworkarchitectures,particularlyadap- classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation tationsoftheTransformerarchitecture[47],suchasRankformer onthefirstpage.Copyrightsforcomponentsofthisworkownedbyothersthanthe [9] and SetRank [34]. However, existing work shows that deep learning-basedlistwisemodelsrequirecomplextuningtoachieve republish,topostonserversortoredistributetolists,requirespriorspecificpermission and/orafee.Requestpermissionsfrompermissions@acm.org. marginalgainsoverrobustpairwisemodelslikeLambdaMART KDDâ€™25,August3â€“7,2025,Toronto,Canada oninformationretrievalbenchmarks[39].Therefore,pairwiseand Â©2025Copyrightheldbytheowner/author(s).PublicationrightslicensedtoACM. listwisemethodseachhaveinherentdrawbacksandmoreeffective ACMISBN978-1-4503-XXXX-X/18/06 https://doi.org/XXXXXXX.XXXXXXX solutionsforLETORhavenotbeenexhaustivelyexplored. 4202 voN 81 ]IA.sc[ 1v46021.1142:viXra",
    "body": "TSPRank: Bridging Pairwise and Listwise Methods with a Bilinear\nTravelling Salesman Model\nWeixianWaylonLi YftahZiser YifeiXie\nUniversityofEdinburgh NvidiaResearch UniversityofEdinburgh\nUnitedKingdom Israel UnitedKingdom\nwaylon.li@ed.ac.uk yziser@nvidia.com yifei.xie@ed.ac.uk\nShayB.Cohen TiejunMa\nUniversityofEdinburgh UniversityofEdinburgh\nUnitedKingdom UnitedKingdom\nscohen@inf.ed.ac.uk tiejun.ma@ed.ac.uk\nABSTRACT KEYWORDS\nTraditionalLearning-To-Rank(LETOR)approaches,includingpair- learning-to-rank,pairwise-listwiseranking,travellingsalesman\nwisemethodslikeRankNetandLambdaMART,oftenfallshortby problem\nsolelyfocusingonpairwisecomparisons,leadingtosub-optimal\nglobalrankings.Conversely,deeplearningbasedlistwisemethods, ACMReferenceFormat:\nWeixian Waylon Li, Yftah Ziser, Yifei Xie, Shay B. Cohen, and Tiejun\nwhileaimingtooptimiseentirelists,requirecomplextuningand\nMa.2025.TSPRank:BridgingPairwiseandListwiseMethodswithaBi-\nyieldonlymarginalimprovementsoverrobustpairwisemodels.To\nlinearTravellingSalesmanModel.InProceedingsofthe31thACMSIGKDD\novercometheselimitations,weintroduceTravellingSalesmanProb- ConferenceonKnowledgeDiscoveryandDataMining(KDDâ€™25),August\nlemRank(TSPRank),ahybridpairwise-listwiserankingmethod.\n3â€“7,2025,Toronto,Canada.ACM,NewYork,NY,USA,23pages.https:\nTSPRankreframestherankingproblemasaTravellingSalesman //doi.org/XXXXXXX.XXXXXXX\nProblem(TSP),awell-knowncombinatorialoptimisationchallenge\nthathasbeenextensivelystudiedforitsnumeroussolutionalgo-\nrithmsandapplications.Thisapproachenablesthemodellingof 1 INTRODUCTION\npairwiserelationshipsandleveragescombinatorialoptimisation LearningtoRank(LETOR)algorithmshavebecomeessentialin\ntodeterminethelistwiseranking.Thisapproachcanbedirectly applicationssuchasrecommendationsystems[16,30,36],question\nintegrated as an additional component into embeddings gener- answering[10,15,27],andinformationretrieval[2,9,34].These\natedbyexistingbackbonemodelstoenhancerankingperformance. algorithmsaimtoorderalistofrankingentitiesbasedontheir\nOurextensiveexperimentsacrossthreebackbonemodelsondi- features,optimisingforthemostrelevantorpreferredentitiesto\nverse tasks, including stock ranking, information retrieval, and appearatthetop.Recently,LETORmethodshavealsoexpanded\nhistoricaleventsordering,demonstratethatTSPRanksignificantly intootherdomains,suchasstockandportfolioselection[45,50]\noutperformsbothpurepairwiseandlistwisemethods.Ourqualita- andtextualordering[46,49].Despitethesebroaderapplicationsof\ntiveanalysisrevealsthatTSPRankâ€™smainadvantageoverexisting LETOR,latestfundamentalworkonLETORstillprimarilyfocused\nmethodsisitsabilitytoharnessglobalinformationbetterwhile onincorporatingclickdataintorankingmodelsandaddressing\nranking.TSPRankâ€™srobustnessandsuperiorperformanceacross biasesintroducedbyuserfeedback[20,21,33,54],concentratingon\ndifferentdomainshighlightitspotentialasaversatileandeffective retrievalandrecommendationtasks.Limitedresearchhasexplored\nLETORsolution.Thecodeandpreprocesseddataareavailableat generalrankingmethodsacrossdiversetasksanddomains.\nhttps://github.com/waylonli/TSPRank-KDD2025. Overthepastdecade,researchonLETORmodelsmainlyfocuses\nonpairwiseandlistwiseapproaches,whilepointwisemethodsoften\nCCSCONCEPTS failtocapturetheintricateinter-entityrelationshipsthatareessen-\ntialforaccurateranking.Pairwisemethods,suchasLambdaMART\nâ€¢Informationsystemsâ†’Learningtorank.\nandRankNet[6],primarilyoptimiseforpairwisecomparisonswith-\noutaholisticviewoftheentirerankinglist,potentiallyleadingto\nsub-optimalglobalrankings.Listwisemethodsoptimisetheranking\nofentirelistsdirectlyratherthanindividualsorpairs.Thiscategory\nPermissiontomakedigitalorhardcopiesofallorpartofthisworkforpersonalor\nincludesadvancedneuralnetworkarchitectures,particularlyadap-\nclassroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed\nforprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation tationsoftheTransformerarchitecture[47],suchasRankformer\nonthefirstpage.Copyrightsforcomponentsofthisworkownedbyothersthanthe [9] and SetRank [34]. However, existing work shows that deep\nauthor(s)mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,or\nlearning-basedlistwisemodelsrequirecomplextuningtoachieve\nrepublish,topostonserversortoredistributetolists,requirespriorspecificpermission\nand/orafee.Requestpermissionsfrompermissions@acm.org. marginalgainsoverrobustpairwisemodelslikeLambdaMART\nKDDâ€™25,August3â€“7,2025,Toronto,Canada oninformationretrievalbenchmarks[39].Therefore,pairwiseand\nÂ©2025Copyrightheldbytheowner/author(s).PublicationrightslicensedtoACM.\nlistwisemethodseachhaveinherentdrawbacksandmoreeffective\nACMISBN978-1-4503-XXXX-X/18/06\nhttps://doi.org/XXXXXXX.XXXXXXX solutionsforLETORhavenotbeenexhaustivelyexplored.\n4202\nvoN\n81\n]IA.sc[\n1v46021.1142:viXra\nKDDâ€™25,August3â€“7,2025,Toronto,Canada WeixianWaylonLi,YftahZiser,YifeiXie,ShayB.Cohen,andTiejunMa\nRecently,GNNRanksuccessfullyuseddirectedgraphneuralnet- Pairwisemethodsfocusontherelativecomparisonsofentity\nworkstolearnlistwiserankingsfrompairwisecomparisons[23]. pairs,assessingscores(ğ‘ (eğ‘–),ğ‘ (eğ‘—))againstbinarylabelsğ‘¦ ğ‘–ğ‘—,which\nAlthoughtheirmethodisnotapplicabletogeneralLETORprob- denoteifentityeğ‘– shouldberankedhigherthaneğ‘—.Methodsin\nlems,asitrequirespre-knownpairwiserelationshipsliketheout- thiscategoryincludeRankNet[8],LambdaRank[7],andLamb-\ncomesofsportsmatches,itstillsuggestsapotentialapproachfor daMART[6].Listwisemethodsdirectlycomputescoresbasedon\nLETORbyrepresentingpairwisecomparisonsasagraph.Inspired thefeaturesofallentitiesinalist.Thesemethodsaimtooptimise\nbyAbendetal.,whousedcombinatorialoptimisationtechniquesto alistwiseobjective,comparingtheentiresetofcomputedscores\nrecoverthelexicalorderofrecipepieces[1],weproposeTravelling ğ‘ (e) âˆˆRğ‘ againstacompletesetoflabelsyâˆˆRğ‘ .Toadvancethis\nSalesmanProblemRank(TSPRank).Thishybridpairwise-listwise approach,Aietal.introducedtheDeepListwiseContextModel\nmethodreframestherankingproblemasaTravellingSalesman (DLCM)[2].Thismodelwasfurtherrefinedintogeneralmulti-\nProblem(TSP),anNP-hardcombinatorialoptimisationchallenge variatescoringfunctionsin[3].Consideringthatalistofentities\nthatseekstheoptimalsequenceofnodevisitstominimisetotal can be viewed as a sequence, methodologies from Natural Lan-\ntravelcost.Inarankingcontext,TSPRankaimstofindtheoptimal guageProcessing(NLP)areapplicabletorankingtasks.Notably,\npermutationofrankingentitiestomaximisetherankingscore. the Transformer architecture [47], has been adapted to address\nOurmaincontribution,TSPRank,bridgesthegapbetweenpair- listwiserankingchallenges,referredtoaslistwiseTransformersin\nwiseandlistwiserankingmodelsthroughcombinatorialoptimisa- recentwork[9,31,34â€“36,55].\ntion,demonstratingstrongrobustnessacrossdiverserankingprob- Althoughlistwiserankingmethods,primarilyneuralrankers,\nlems.TSPRanksimplifiesthecomplexlistwiserankingproblem havedemonstratedtheiradvantagesinwebsearchrerankingtasks\nintoeasierpairwisecomparisons,thusovercomingthechallenges [2,34],Qinetal.conductedacomprehensiveevaluationcompar-\nofdirectlylearninglistwiserankingsincomplexdataandtasks. inglistwiseneuralrankerstothegradient-boosted-decision-tree\nItalsoenhancespairwisemethodsbyincorporatinglistwiseopti- (GBDT)-basedpairwiseLambdaMART[6,39].Theresultsindicated\nmisationthroughaTSPsolver.Toimproverankingperformance, thatLambdaMARTconsistentlyoutperformslistwiserankersacross\nTSPRankcanbeapplieddirectlyasanadditionalcomponentonem- threewidelyusedinformationretrievaldatasets.Furthermore,it\nbeddingsgeneratedfromdomain-specificbackbonemodels.Toour wasobservedthatlistwiserankersrequiresubstantialeffortsto\nknowledge,itisthefirstLETORmodeltoframetherankingprob- achieveonlymarginalimprovementsoverLambdaMART.Conse-\nlemasacombinatorialoptimisationplusgraphrepresentationtask. quently,itisevidentthatlistwiserankingmodelsarenotuniversally\nWedemonstrateitssuperiorperformanceacrossthreebackbone applicablesolutionsandgenerallylacktherobustnessneededfor\nmodelsondiverserankingtasks:stockranking,informationre- broaderdeployment.Thisconclusionhasalsobeenfurthervali-\ntrieval,andhistoricaleventsordering,coveringbothnumericaland datedbyBuyletal.[9].\ntextualdataacrossmultipledomains.Weintroducetwolearning\nmethodsforTSPRank:alocalmethodusingapre-definedground\n3 TSPRANK\ntruthadjacencymatrixwithouttheTSPsolverduringtrainingand\naglobalend-to-endmethodthatincludesthesolverinthetraining Directlypredictingthelistwiseorderischallenging,ascorrectly\nloopforbettermodel-inferencealignment.Ourempiricalanalysis ranking ğ‘ entities from 1 to ğ‘ is complex. However, breaking\nvisualisesthepredictionsandgraphconnectionstoprovideinsights itdownintoğ‘ Ã—ğ‘ pairwisecomparisonssimplifiesthetask,as\nintoTSPRankâ€™seffectiveness.WedemonstratethattheTSPsolver eachpairwisecomparisonismorestraightforwardthantheentire\nenhancesthemodelâ€™sabilitytoharnessglobalinformationduring listwiseranking.However,afundamentaldrawbackofpairwise\nrankingandincreasestolerancetoerrorsinpairwisecomparisons. ranking,ashighlightedbyCaoetal.[11],isthatthelearningob-\nAdditionally,weassessinferencelatencycausedbythecombinato- jectivesdonotfocusonminimisingthelistwiserankingerrors.\nrialoptimisationsolverandsuggestpotentialsolutionstomitigate Toaddressthisgapandrethinktheapproachofpairwiseranking,\nthisoverhead. weintroduceTSPRank,anovelmethodologyforposition-based\nrankingproblems.Thisapproachintegrateslistwiseoptimisation\nintopairwisecomparisonsbymodellingrankingtasksasTSP.No-\n2 BACKGROUND\ntably,TSPRankcanbeappliedasanadditionalcomponentwith\nLETORalgorithmsaimtorankentitiesbasedontheirfeatures.In embeddingsgeneratedfromdomain-specificbackbonemodelsto\nLETOR, we denote a list of ğ‘ ranking entities as e, containing achieveimprovedrankingperformance.\n{e1,e2,...,eğ‘},witheacheğ‘– âˆˆRğ‘‘ whereğ‘‘representsthedimen-\nsionalityofthefeaturespace.Ascoringfunctionğ‘  : Rğ‘‘ â†’ Ris\n3.1 RankingAsTravellingSalesmanProblem\nappliedontheentities,whicharethenrankedindescendingor-\nderoftheğ‘ (eğ‘–)scores.LETORalgorithmsarebroadlycategorised Wemodeltherankingproblemasanopen-loopTravellingSales-\nintopointwise,pairwise,andlistwiseapproachesbasedontheir manProblem(TSP).Givenasetofentitiese1,e2,...,eğ‘ andallthe\noptimisationstrategies.Pointwisemethodstreatrankingasare- pairwisescorevaluesğ‘ (eğ‘–,eğ‘—)indicatingthegainofrankingentity\ngressionproblem,comparingscoresğ‘ (eğ‘–)tolabelsğ‘¦ ğ‘–.Modelssuch eğ‘— immediatelyaftereğ‘–,wedefineacompletegraphğº = (ğ‘‰,ğ‘Š),\nasOPRF[19],TreeBoost[18],andRankSVM[44],includingnewer whereğ‘‰ represents the entities andğ‘Š represents the pairwise\nimplementationslikeRankCNN[43],areknownfortheircompu- scoresbetweeneverytwoentities.Eachentityeğ‘– intheranking\ntationalefficiencybutmaynotcaptureinter-entityrelationships problemcorrespondstoacityintheTSP.Bymappingentitiesto\nadequately. citiesandpairwisescorestoweights,wecanformulatetheranking\nTSPRank:BridgingPairwiseandListwiseMethodswithaBilinearTravellingSalesmanModel KDDâ€™25,August3â€“7,2025,Toronto,Canada\nproblemasaTSPtofindtheoptimalpermutationğœ‹.Thus,theob- allentities.Thisinferenceprocesseffectivelyperformslistwiseop-\njectiveistofindanoptimalopen-looptourğœ‹âˆ—oftheentitiesdefined timisation,asitdeterminestheoptimalpermutationofentitiesthat\ninEquation1suchthatthetotalpairwisescoreismaximised. maximisestheoverallpairwiserankingscore.\nğ‘âˆ’1\nğœ‹âˆ—=argmax âˆ‘ï¸ ğ‘ (eğœ‹(ğ‘–),eğœ‹(ğ‘–+1)). (1) 4 LEARNING\nğœ‹\nğ‘–=1\nWeintroducetwodistinctlearningmethodologiesfortheTSPRank\nThenextstepisdevelopingascoringfunctionthataccurately\nmodeloutlinedinSection3.Thefirstmethodisalocalapproach,\nmodelsthepairwiserelationshipsbetweentherankingentities,\nfocusingexclusivelyonindividualpairwisecomparisonsduring\ntherebyeffectivelydeterminingthescores.\nthetrainingphase.Thesecondmethodisaglobal,end-to-endap-\nproach,incorporatingtheGurobisolverdirectlyintothetraining\n3.2 ScoringModel\nprocess,therebyallowingtheblack-boxMILPsolvertoinfluence\nThescoringmodeltakesasetofrankingentitiesortheircorre- thelearningdynamically.Figure1illustratesthecompletepipeline\nspondingembeddings{e1,e2,...,eğ‘},whereeacheğ‘– âˆˆRğ‘‘ andğ‘‘is ofthetwolearningmethodsaswellasthemodelarchitecture.\nthedimensionofthefeaturesorembeddings.Itoutputsanğ‘ Ã—ğ‘\nweightedadjacencymatrixğ´thatrepresentsthepairwisescoresof\n4.1 LocalLearning\neverytwoentities.Thescoringmodelcomprisesanoptionalnode\nencoderandatrainablebilinearmodelontop. Inthelocallearningapproach,theobjectiveistounderstandpair-\nwiseconsecutiverelationshipsbetweennodes.Theobjectiveisto\nEncoder. ThedefaultencoderusedistheTransformerencoder\ndeterminewhetherentityeğ‘— shouldrankonepositionaftereğ‘– ina\nblock[47],butitcanbereplacedwithanyotherencodersuited\ngivenpairofnodes.Therefore,thescoreğ‘ (eğ‘–,eğ‘—)issethighifeğ‘— is\ntothespecifictaskanddataset.Additionally,usinganencoderis\nsupposedtorankconsecutivelyaftereğ‘–,andlowotherwise.\noptionalifsufficientlyrobustbackbonemodelsareavailable.\nTotailortheTSPRankmodeltorankingscenarioswherepenal-\nTrainableBilinearModel. Givenapairofencodedrepresentations tiesvarybasedontheactualpositions,weapplyaweightedloss.We\nofentities(eğ‘–,eğ‘—),thebilinearmodelcomputesthepairwisescore denotethepredictedadjacencymatrixğ´ğ‘ fromthebilinearmodel,\nusingthefollowingbilinearform: whereğ‘ ğ‘–ğ‘ ğ‘— âˆˆğ´ğ‘ representsthepredictedpairwisescores.Thetarget\nâŠº adjacencymatrixğ´ğ‘¡ = {ğ‘ ğ‘–ğ‘¡ ğ‘—}isdefinedsuchthatğ‘ ğ‘–ğ‘¡ ğ‘— âˆˆğ´ğ‘¡ equals\nğ‘ (eğ‘–,eğ‘—)=e ğ‘– Weğ‘— +ğ‘, (2) 1ifeğ‘— ranksimmediatelyaftereğ‘–,and0otherwise.Weapplythe\nwhereWandğ‘ arelearnableparametersthatcanbeoptimised weightedcross-entropyloss(definedinEquation5)oneachrow\nalongwiththeencoderparameters. toidentifythenextentityeğœ‹(ğ‘–+1) toberankedgiveneğœ‹(ğ‘–).The\nTheadjacencymatrixğ´isconstructedasfollows: modelistrainedasamulti-classclassificationproblem,aimingto\nmaximisetheprobabilityofğ‘ƒ(eğœ‹(ğ‘–+1) |eğœ‹(ğ‘–)).Weweighttheloss\nğ´ ğ‘–ğ‘— =ğ‘ (eğ‘–,eğ‘—), forallğ‘–,ğ‘— âˆˆ{1,...,ğ‘}, (3) bythetruerankinglabelğ‘¦,allowingthepenaltytovaryaccording\nwhereeachentryğ´ ğ‘–ğ‘—directlycorrespondstothecomputedpairwise\ntodifferentrankingpositions.Additionally,ğ‘¦canbeadjustedto\nğ‘+1âˆ’ğ‘¦dependingonwhetherğ‘¦representsascendingordescend-\ncomparisonscorefromentityeğ‘– toentityeğ‘—.\ningorder.\n3.3 Inference\nInferenceofTSPRank,describedinEquation1,requiressolvingthe\no n cop a nte on sr i- sil a to l oo o fp p etT ximS aP ci ts, aw at lih goi onc rh ip tr his o mbw l seid (m be . rl uy T nhr ce e hc so o ag nlun dtis i boe ond uaa nls g da o [n r 3i 7tN h ]P )m- ash na o dr fd at phc peo rm T oS xb P ii -- Lğ‘™ğ‘œğ‘ğ‘ğ‘™(ğ´ğ‘,ğ´ğ‘¡ )=âˆ’âˆ‘ï¸ ğ‘–ğ‘ =1ğ‘¦ ğ‘˜log (cid:205)ğ‘ ğ‘—ğ‘’ =ğ´ 1ğ‘–ğ‘ ğ‘’ğ‘˜ ğ´ ğ‘–ğ‘ ğ‘—, ğ‘˜ =arg ğ‘—maxğ´ ğ‘–ğ‘¡ ğ‘—. (5)\nmationalgorithms(antcolonyoptimisation[52]).Giventhescale\noftherankingproblemandthedesiredrankingaccuracy,weprefer\n4.2 GlobalLearning\ntoobtainanexactsolutionfortheTSPratherthananapproximate\none.Therefore,weformulatetheTSPasaMixedIntegerLinear WeexpectthatagloballytrainedTSPRankmodelwillfurtheren-\nProgramming(MILP)problem[40],wheretheintegervariables hancetheperformanceasthelocallearningmethodfocusessolely\nrepresentbinarydecisionsonwhetherapathbetweentwonodes onpairwisecomparisonsinisolationduringtraining.Incorporating\nisincludedintheoptimaltour.WethenuseanMILPoptimization theTSPsolverinthetrainingprocedurewillbetteralignthemodel\nsolver,suchasCPLEX[14]orGurobi[22],tofindtheexactoptimal withtheinferenceprocess.Therefore,weintroduceanend-to-end\nsolution.\napproach.Afterobtainingthepredictedadjacencymatrixğ´ğ‘\n,de-\nThedecisionvariablesaredefinedasfollows: finedinSection4.1,wedefinethegolddecisionvariablexğ‘¡ ={ğ‘¥ ğ‘–ğ‘¡ ğ‘—},\n(cid:40) 1, ifentityeğ‘— isrankedimmediatelyaftereğ‘–. whereğ‘¥ ğ‘–ğ‘¡ ğ‘— is defined as in Equation 4. We aim to train a model\nğ‘¥ ğ‘–ğ‘— = (4) tosatisfythemarginconstraints(Equation6)forallthepossible\n0, otherwise.\ndecisionvariablesxbyminimisingthemax-marginlossdefinedin\nWethenapplytheTSPoptimisationproblemdefinedinAppen- Equation7.Whenx = xğ‘¡,thepredictedrankingperfectlyaligns\ndixAtoensuretheresultisasingle,completerankingthatincludes withthegoldranking,resultinginalossofzero.\nKDDâ€™25,August3â€“7,2025,Toronto,Canada WeixianWaylonLi,YftahZiser,YifeiXie,ShayB.Cohen,andTiejunMa\nLocal Learning\nTransformer\nEncoder\n(Optional)\nBilinear Adjacency\nAdd & Norm Model Matrix\nFeed Forward\nPredicted Matrix Ground Truth Matrix\nAdd & Norm\nGlobal Learning\nMulti-Head\nAttention\nGurobi\nTSP Solver\nGround Truth Decision Variable\nBackbone Model\nFigure1:IllustrationofTSPRankandthecompletepipelineoflocalandgloballearning.ThepipelinestartswithaTransformer\nEncoderoranyembeddingsgeneratedfromanotherexistingBackboneModel,followedbyaBilinearModelgeneratingpairwise\nscorestoformanAdjacencyMatrix.Locallearningcomparesthepredictedmatrixwiththegroundtruthtocalculatethelocal\nlossLğ‘™ğ‘œğ‘ğ‘ğ‘™.Globallearningusesthemax-marginlossLğ‘”ğ‘™ğ‘œğ‘ toincorporatetheGurobiTSPsolverduringtraining.\nandbackbonemodelsfromdiversedomains:stockranking,infor-\nxğ‘¡ Â·ğ´ğ‘ â‰¥xÂ·ğ´ğ‘ +Î”(xğ‘¡,x),\nforallx, (6)\nmation retrieval, and historical events ordering. These datasets\ncovervariousdatamodalities,includingtabularandtextualdata.\nLğ‘”ğ‘™ğ‘œğ‘(ğ´ğ‘,xğ‘¡ )=max(0,max[Î”(x,xğ‘¡ )+xÂ·ğ´ğ‘ ]âˆ’xğ‘¡ Â·ğ´ğ‘\n) (7) AllthreetaskscanbeformulatedaspresentedinSection3.1.We\nxâ‰ xğ‘¡\naimtoanswerthefollowingresearchquestions(RQs):\nThestructuredscore\nÎ”(x,xğ‘¡),definedinEquation8,aimsto\nenforceamarginforeachincorrectlyidentifiededge.\nâ€¢ RQ1:Doesthepairwise-listwiseTSPRankoutperformthecur-\nğ‘ ğ‘ rentSOTAgeneralpairwiseandlistwiserankingmethodsacross\nÎ”(x,xğ‘¡ )=âˆ‘ï¸âˆ‘ï¸ max(0,ğ‘¥ ğ‘–ğ‘— âˆ’ğ‘¥ ğ‘–ğ‘¡ ğ‘—). (8) differentbackbonemodelsanddatasets?\nğ‘–=1 ğ‘—=1 â€¢ RQ2:Doesgloballearningleadtobetterperformance?\nThisapproacheliminatestheneedtomanuallydefinethetarget â€¢ RQ3:Doesthepurepairwisemethodreallyconsistentlyout-\nadjacencymatrix.Instead,itemploystheoutputfromtheblack-box performthedeeplearningbasedlistwisemethodacrossdifferent\noptimisertodirectlyguidetheupdatesofthemodelparameters. domains?\nThismethodologynotonlysimplifiestheprocessbutalsoensures â€¢ RQ4:Whataretheadvantagesofhybridpairwise-listwiseTSPRank\nacloseralignmentwiththesolverâ€™sproceduraldynamics.Toaccel- overothermethods?\nerateconvergence,weintegrateahybridoflocalandgloballoss.\nRelyingsolelyonthegloballossrequiressignificantlymoreepochs\nThissectiondetailstheexperimentalsetupforeachtask.All\ntoconverge.Therefore,duringtraining,wealternatebatchesbe-\nexperimentswereconductedonasingleNvidiaA10080GGPU.\ntweenthegloballossandthelocalloss,ensuringfasterandmore\nefficientmodelconvergence.\n5 EXPERIMENTALSETUP 5.1 BenchmarkModels\nWe evaluate TSPRankâ€™s effectiveness as a prediction layer inte- Webenchmarkourpairwise-listwiseTSPRankmodelagainstthe\ngratedintovariousbackbonemodels.Ourgoalistodemonstrate originalbackbonemodels(iftheyoriginallycontainaprediction\nthatTSPRankenhancesperformancecomparedtotheoriginalback- layer),LambdaMART[6],andRankformer[9],asLambdaMART\nboneandothergeneralrankingalgorithmsacrossdifferentdomains. isstillconsideredtheSOTApairwiserankingmethodandRank-\nWhileachievingstate-of-the-art(SOTA)performancestilldepends formeristheSOTAdeeplearning-basedlistwiserankingmethod.\nonthebackbonedesign,TSPRankservesasacomponenttoim- Thebenchmarkmodelschosenincludethebestpurepairwiseand\nproverankingperformance.Wefocusonscenarioswhere(i)the purelistwisemethods,whichissufficienttodemonstratetheeffec-\ndatacontainordinalrankinglabelsratherthanbinaryorrelevance tivenessofourapproach.\nlevellabels,and(ii)thecompleterankingoratleastthetop-ken- Inpractice,wereplacetheoriginalpredictionlayer,whichpre-\ntitiesareimportant,extendingthetaskâ€™sinterestbeyondmerely dictstherankingscoresforeachentity,withdifferentbenchmark\nidentifyingthetop-1entity.Wetestourmethodwiththreedatasets modelstoevaluatetheperformanceachievedbythismodification.\nTSPRank:BridgingPairwiseandListwiseMethodswithaBilinearTravellingSalesmanModel KDDâ€™25,August3â€“7,2025,Toronto,Canada\n5.2 Datasets HistoricalEventsOrdering. Concatenatingeventtitlesandin-\nStockRanking. Thetaskofstockrankingfocusesonaccurately formation can result in contexts spanning thousands of tokens.\npredictingandrankingstocksaccordingtotheiranticipatedfuture\nTherefore,weusethetext-embedding-3-small4embeddingsfrom\nreturnsratio,whichaidsinvestorsinselectingstocksforinvest- OpenAIasthebackbonemodel,whichsupportsupto8191tokens.\nmentpurposes[17,41,53].Weusethedataset1introducedbyFeng OurgoalisnottoachieveSOTAperformancebuttoensureafair\netal.[17],whichincludeshistoricaltradingdatafrom2013to2017 comparison.Thesmallversion(text-embedding-3-small)with1536\nfortwosignificantmarkets,NASDAQandNYSE,containing1026 dimensions,comparedtothelargeversionâ€™s3072dimensions(text-\nand1737stocks,respectively.Wemaintainaconsistentsettingfor embedding-3-large),ismorecomputationallyefficientandsufficient\nsplittingthedataintotraining,validation,andtestingsetsovera forourpurposes.\n3-year,1-year,and1-yearperiod.\n5.4 TechnicalSetup\nInformationRetrieval. Informationretrievalisanothercritical\nStockRanking. ConsideringthatTSPRankspecialisesinsmall-\nareawhererankingmodelsareextensivelyapplied.Thetaskof\nscalerankingproblems,weimplementrankingswithinindividual\ninformation retrieval focuses on accurately ranking documents\nsectors,categorisingstocksintogroupsbasedontheirsectors.We\nbased on their relevance to a given query, which is crucial for\nexcludeallsectorgroupscontainingthreeorfewerstocksandre-\nsearchengines.LambdaMARTandRankformerarebothoriginally\nmovestockswithunidentifiedsectorinformation.Detaileddescrip-\nproposedforinformationretrievaltask[6,9].WeusetheMQ2008-\ntionsofthesector-specificgroupingareprovidedinAppendixE.For\nlist2datasetfromMicrosoftLETOR4.0[38],apopularbenchmark\nthebenchmarkingprocess,weuseoutputsfromtherelationalem-\ndatasetforLETORalgorithms.Weacknowledgetheexistenceof\nbeddinglayerintroducedbyFengetal.[17],replacingtheoriginal\nmorerecentinformationretrievaldatasets,buttheyonlyprovide\npredictionlayerwiththeotherbenchmarkmodels.Thismodifica-\nrelevance-levellabelswithoutordinalrankinglabels,makingthem\ntionenablesustoassesstheextenttowhichtransitioningfroma\nunsuitableforourmodelevaluation.\npoint-wise(originalmodel)topairwise,listwise,andourhybrid\napproachescanenhanceperformance.Allbenchmarkmodelsand\nHistoricalEventsOrdering. Inthefinaltask,weincludeatextual\ndatasetcalledâ€œOnThisDay2â€(OTD2)3forchronologicallyordering TSPRankwithlocallearningaretrainedfor100epochsforeach\nsector,as100epochsaresufficientforthebenchmarkmodelsto\nhistoricalevents.Originally,Honovichetal.constructedthisdataset\nconverge.WefindthatTSPRankwithgloballearninggenerally\nforaregressiontasktopredicttheyearofoccurrence[26].However,\nrequiresmoreepochstoconverge;therefore,TSPRank-globalis\nitcanalsobeapproachedasarankingtasktopredictthechrono-\ntrainedforanadditional50epochstoensureconvergence.Other\nlogicalorderofeventswithinagivengroupofevents.TheOTD2\nhyperparametersarespecifiedinAppendixB.ForLambdaMART,\ndataset,sourcedfromtheâ€œOnThisDayâ€website,includes71,484\nweuse10,000treessincepreviousexperimentsindicatedthatRank-\neventsenrichedwithadditionalcontextualinformation.Scrapedin\nformerfailedtooutperformLambdaMARTwiththisconfiguration\nApril2020,itincorporatesrecenteventsandcorrectionsbythesite.\n[9].Wechoosethewidely-usedXGBoost5[12]implementationof\nPreprocessingexcludedeventsbefore1CEandfutureprojections\nLambdaMART,especiallyduetotheperformanceenhancementsin\nsuchasâ€œ31stpredictedperihelionpassageofHalleyâ€™sCometâ€in\nitsversion2.0.\n2061CE.Wefollowthe80%/10%/10%train/validation/testsplitas\nprovided.\nInformationRetrieval. IntheMQ2008-listdataset,aquerymight\ncontainover1,000documents,resultinginagraphthatistoolarge\n5.3 Backbones\nfortheTSPsolvertohandleefficiently.Therefore,wefocusona\nStockRanking. WeusethemethodbyFengetal.[17]astheback- rerankingorpost-rerankingstage.Specifically,weextractthetop\nbonemodel,replacingthepredictionlayerwithdifferentbenchmark 10andtop30documentsforeachquerytoconducttwoseparate\nrankingmodels.AlthoughotherpotentialmethodssuchasSTHAN- experiments.Thisapproachallowsustomanagethecomputational\nSR[42],ALSP-TF[48],andCI-STHPAN[51]havebeenproposed complexitywhilestillevaluatingtheeffectivenessofTSPRankin\nforstockselection,wedonotincludethemduetothelackoflast- arealisticrankingscenario.Weusesimilarhyperparametersas\nstateembeddingsneededtointegrateTSPRank,unavailabilityof inthestockrankingtaskbutincreasethenumberoftransformer\nsourcecode,orreproducibilityissues.Sinceourprimarygoalis layersinbothRankformerandTSPRanktofour,aswedonotuse\ntodemonstrateTSPRankasaversatilerankingapproachrather anypretrainedembeddingshere.Toensurefairness,wealsofollow\nthanachievingSOTAresultsonasingledataset,thisselectionof the5-foldcross-validationsetupasprovidedbyMicrosoft.\nbackboneissufficienttovalidateourmodelâ€™sperformance.\nHistoricalEventsOrdering. Werandomlyallocatetheeventsinto\nInformationRetrieval. GiventhatthefeaturesintheMQ2008-list rankinggroupsandtraintherankingmodelstopredicttheground\nareencodedusingacombinationofBM25andTF-IDFmethods, truthorderofoccurrenceswithinthesegroups.Wetestwithgroup\nwetreatBM25andTF-IDFasthebackbonemodelsandusethese sizesof10,30and50forfaircomparisons.Foreachgroupsize,we\nencodedfeaturesasembeddings. generatethegroupallocationsusingfivedifferentrandomseedsand\nreporttheaverageperformancetomitigatetheeffectsofrandom\ngroupallocation.Regardingthemodels,weobservedoverfitting\n1https://github.com/fulifeng/Temporal_Relational_Stock_Ranking/\n2https://www.microsoft.com/en-us/research/project/letor-learning-rank-\ninformation-retrieval/letor-4-0/ 4https://platform.openai.com/docs/guides/embeddings\n3https://github.com/ltorroba/machine-reading-historical-events 5https://xgboost.readthedocs.io/en/latest/tutorials/learning_to_rank.html\nKDDâ€™25,August3â€“7,2025,Toronto,Canada WeixianWaylonLi,YftahZiser,YifeiXie,ShayB.Cohen,andTiejunMa\nwithRankformerandTSPRankwhenincludingthetransformer HistoricalEventsOrdering. WereporttheKendallâ€™sTau,MRR,\nblock,evenwitha0.5dropoutrate.Thisislikelyduetothestrong ExactMatch(EM)ofordering,andtheRootMeanSquareError\nrepresentationalpowerofthecontextualembeddingandtherel- (RMSE)ofthepredictedandgroundtruthrankings.EMisdefined\natively small size of the OTD2 dataset compared to other NLP astheratioofthenumberofeventswhosepredictedorderexactly\ncorpora.Consequently,weretainedonlythescoringnetworkin matches the ground truth order to the total number of events,\nRankformer and the trainable bilinear model in TSPRank, inte- formulatedas:EM= #correctlyorderedevents .\n#events\ngratingthemdirectlywiththetext-embedding-3-smallembeddings.\nThissettingnotonlypreventsoverfittingbutalsoensuressimilar\n6 RESULTS\nmodelsizes.OtherhyperparametersarespecifiedinAppendixB.\nWeremovetheweightsintheweightedlossfunctionforTSPRank- Theaggregatedresultsforallbenchmarkmodelsonthestockrank-\nLocalheresincealleventsshouldbeweightedequallywithoutany ingdatasetarepresentedinTable1.Theseresultsrepresentthe\nadditionalrequirementsinthistask. averageperformanceacross50sectorsintheNASDAQmarketand\n70sectorsintheNYSEmarket,excludingsectorswiththreeor\nfewerstocksasoutlinedintheexperimentalsetup.Detailedresults\n5.5 Evaluation\nforeachindividualsectorareprovidedinAppendixE.Theresults\nStockRanking. Giventhatourtaskencompassesbothranking ontheMQ2008-listretrievaldatasetareshowninTable2.A5-fold\nandstockselectionfunctionalities,weemploybothtraditionalrank- cross-validationwasperformed,withdetailedresultsforeachfold\ningmetricsandfinancialperformancemetricsinourevaluation. providedinAppendixF.Lastly,theresultsonOTD2forhistorical\nForrankingeffectiveness,weusetheMeanAveragePrecisionatğ¾\neventsorderingarepresentedinTable3,withcompleteresultsfor\n(MAP@K),whichevaluatestheprecisionofthetopğ¾rankedstocks\ndifferentrandomgroupallocationsprovidedinAppendixG.\nbyaveragingtheprecisionscoresateachrelevantstockposition. The results highlight the comparisons among three types of\nWealsouseKendallâ€™sTau,definedas:ğœ = (ğ¶âˆ’ğ·) ,whereğ¶ is models:pairwise(LambdaMART),listwise(Rankformer),andour\n1ğ‘›(ğ‘›âˆ’1)\nthenumberofconcordantpairs(pairsofent2 itiesthatareinthe pairwise-listwisemethod(TSPRank).\nsameorderinbothpredictedandgroundtruthrankings),ğ·isthe\nBetterPerformanceofPairwise-ListwiseMethodAcrossDi-\nnumberofdiscordantpairs(pairsofentitiesthatareindifferent verseTasks(RQ1).Ourpairwise-listwisemethod,TSPRank-Global,\nordersintherankings),andğ‘›isthetotalnumberofentitiesbeing\ndemonstratesoutstandingrobustnessandsuperiorperformance\nranked.Kendallâ€™sTauisacorrelationcoefficientthatmeasuresthe across diverse datasets and domains. For instance, on the NAS-\nordinalassociationbetweentworankedlists.Thisissuitableinour DAQstockrankingdataset(Table1),TSPRank-Globalachievesa\ncase,whereweneedtoassessthesimilaritybetweenthepredicted Kendallâ€™sTauof0.0447,significantlysurpassingbothLambdaMART\nrankingsandtheground-truthrankings.Furthermore,toassess (0.0071)andRankformer(0.0110).Similarly,ontheNYSEdataset\nthefinancialimpactoftherankings,wesimulatetradingactivities (Table1),TSPRank-GlobalattainsaKendallâ€™sTauof0.0422,out-\nbypredictingtherankingsofallindividualstocksineverysector performingLambdaMART(0.0054)andRankformer(0.0181).Both\nforthenexttradingdayğ‘¡+1ontradingdayğ‘¡.Thissimulationis\nTSPRank-LocalandTSPRank-Globalalsoconsistentlyachievehigher\nconsistentwiththeonepresentedbyFengetal.[17].Wethenrank IRRandSR,yieldingimprovedfinancialperformance.Themodelâ€™s\nthesestocks,holdthetopğ‘˜stocksğ‘† ğ‘˜,andsellthemontradingday robustnessisfurtherevidencedbyitsconsistenttopperformance\nğ‘¡+1.Thepriceofstockğ‘–ondayğ‘¡ isdenotedasğ‘ ğ‘–(ğ‘¡) pershare.The acrossotherdatasets.Forexample,intheMQ2008-list(Table2),\ncumulativeInvestmentReturnRatio(IRR)andSharpeRatio(SR) TSPRank-GloballeadswithNDCG@10scoresof0.8884forthetop\naredefinedinEquation9,whereğ‘… ğ‘ isthereturnoftheportfolio, 10documentsand0.7631forthetop30documents,indicatingsu-\nğ‘… ğ‘“ istherisk-freerate,andğœisthestandarddeviation: periorrankingaccuracy,despiteaminordifferenceinKendallâ€™s\nTaucomparedtoRankformer(around0.01to0.02).Additionally,\nTSPRank-Globalachievestopperformanceinthehistoricalevents\nIRRğ‘˜ = âˆ‘ï¸ ğ‘ ğ‘–(ğ‘¡) âˆ’ğ‘ ğ‘–(ğ‘¡âˆ’1) , SR= ğ¸(ğ‘… ğ‘ âˆ’ğ‘… ğ‘“) . (9) orderingtask(Table3),regardlessofthegroupsize(10,30,and50).\nğ‘(ğ‘¡âˆ’1) ğœ(ğ‘… ğ‘) TSPRankCanBeExtraComponentUponEmbeddingsFor\nğ‘–âˆˆğ‘†ğ‘˜ ğ‘–\nBoostingThePerformance.Inthestockrankingandordering\nInformationRetrieval. Weevaluatetheperformanceofourmod- tasksforhistoricalevents,wedirectlydeployedTSPRankonthe\nelsusingseveralwell-establishedrankingmetrics:NormalizedDis- stockembeddingsandtextembeddings.Asdemonstrated,TSPRank\ncountedCumulativeGain(NDCG) atvariouscutofflevels(3, 5, effectivelyservesasanadditionalcomponentonembeddings,sig-\n10),MeanReciprocalRank(MRR),andKendallâ€™stau.NDCGmea- nificantlyenhancingrankingperformance.Thiscapabilityallows\nsuresadocumentâ€™susefulnessbasedonitspositionintheresult TSPRanktohavebroaderapplicationsacrossvariousdomains.\nlist,withhigherpositionsreceivingmoreweight.Ontheother\nStrongerRobustnessTowardsNumberofentities.TSPRank-\nhand,MRRassessestherankpositionofthefirstrelevantdocu-\nGlobalalsoshowsgreaterrobustnessconcerningthenumberof\nment,calculatedastheaverageofthereciprocalranksofthefirst\nentitiescomparedtothepurepairwiseLambdaMARTandlistwise\nrelevantdocumentforeachquery.TheformulaforMRRisdefined\nRankformer.AsevidencedbytheMQ2008(Table2)results,thegap\nbyMRR= |ğ‘„1 | (cid:205) ğ‘–|ğ‘„ =1| ran1 kğ‘–,where|ğ‘„|isthetotalnumberofqueries betweenLambdaMARTandRankformernarrowsasthenumberof\nandrankğ‘– istherankpositionofthefirstrelevantdocumentforthe documentsincreasesfrom10to30,withtheNDCG@3scorediffer-\nğ‘–-thquery. encebetweenthesetwomethodsreducingfrom-0.0387to-0.0146.\nTSPRank:BridgingPairwiseandListwiseMethodswithaBilinearTravellingSalesmanModel KDDâ€™25,August3â€“7,2025,Toronto,Canada\nMarket Model ğœ IRR@1 SR@1 MAP@1 IRR@3 SR@3 MAP@3 IRR@5 SR@5 MAP@5\nFengetal.+MLP(Original) 0.0093 0.1947 0.5341 0.1690 0.2366 0.9881 0.3253 0.1892 0.9682 0.5871\nFengetal.+LambdaMART 0.0071 0.0310 -0.0873 0.1539 0.0340 0.0445 0.3144 0.0505 0.2678 0.5858\nNASDAQ Fengetal.+Rankformer 0.0110 0.2257 0.5464 0.1620 0.2857 1.1245 0.3216 0.2309 1.0943 0.5860\nFengetal.+TSPRank-Local 0.0291 0.5353 1.2858 0.1658 0.4416 1.7401 0.3297 0.2537 1.2623 0.5932\nFengetal.+TSPRank-Global 0.0447 0.7849 1.7471 0.1633 0.5224 2.0359 0.3364 0.2937 1.4331 0.5999\nFengetal.+MLP(Original) 0.0162 0.4170 1.0755 0.1791 0.2574 1.2367 0.2841 0.2257 1.3186 0.4649\nFengetal.+LambdaMART 0.0054 0.1005 0.1367 0.1307 0.0732 0.4192 0.2592 0.1063 0.6882 0.4574\nNYSE Fengetal.+Rankformer 0.0181 0.2924 0.9113 0.1535 0.2701 1.2890 0.2758 0.2515 1.4200 0.4651\nFengetal.+TSPRank-Local 0.0313 0.5012 1.5710 0.1424 0.3974 1.9735 0.2756 0.2788 1.6662 0.4680\nFengetal.+TSPRank-Global 0.0422 0.4787 1.4552 0.1392 0.3889 1.9976 0.2756 0.2816 1.7350 0.4732\nTable1:PerformancecomparisonofFengetal.,LambdaMART,Rankformer,andTSPRankontheNASDAQandNYSEstock\nrankingdataset,averagedacrossallfilteredsectors.\nTop10 Top30\nModel Type NDCG@3 NDCG@5 NDCG@10 MRR ğœ NDCG@3 NDCG@5 NDCG@10 MRR ğœ\nLambdaMART Pairwise 0.6833 0.7222 0.8707 0.4259 0.1474 0.7340 0.7298 0.7403 0.3617 0.2372\nRankformer Listwise 0.7220 0.7565 0.8865 0.4661 0.2317 0.7486 0.7470 0.7596 0.3732 0.2834\nTSPRank-Local Pairwise-Listwise 0.6858 0.7213 0.8719 0.4266 0.1544 0.7189 0.7240 0.7362 0.3206 0.2054\nTSPRank-Global Pairwise-Listwise 0.7281 0.7585 0.8884 0.4861 0.2212 0.7582 0.7558 0.7631 0.3895 0.2647\nTable2:EvaluationofLambdaMART,Rankformer,andTSPRankonMQ2008-listinformationretrievaldatasetfortop10and\ntop30documents.\nGroupSize 10 30 50\nModel Type ğœâ†‘ EMâ†‘ MRRâ†‘ RMSEâ†“ ğœâ†‘ EMâ†‘ MRRâ†‘ RMSEâ†“ ğœâ†‘ EMâ†‘ MRRâ†‘ RMSEâ†“\nte-3-small+LambdaMART Pairwise 0.6297 0.3008 0.7554 1.993 0.5929 0.1064 0.6122 5.969 0.6000 0.0639 0.5596 9.618\nte-3-small+Rankformer Listwise 0.6190 0.2899 0.7361 1.998 0.5859 0.0921 0.4911 5.973 0.5724 0.0527 0.3526 10.069\nte-3-small+TSPRank-Local Pairwise-Listwise 0.5658 0.2856 0.7679 2.296 0.5095 0.0873 0.5739 6.930 0.4713 0.0460 0.3949 12.084\nte-3-small+TSPRank-Global Pairwise-Listwise 0.6301 0.3350 0.7936 2.057 0.6302 0.1384 0.7300 5.770 0.6207 0.0871 0.6618 9.602\nTable3:EvaluationofLambdaMART,Rankformer,andTSPRankonOTD2datasetforhistoricaleventsorderingforgroupsizes\nof10,30,and50.â€œte-3-smallâ€standsforâ€œtext-embedding-3-smallâ€.\nSimilarly,inhistoricaleventsordering(Table3),LambdaMART scenarioofstockranking,LambdaMARTshowsmarkedlypoorer\nandRankformerâ€™sperformancefluctuatesmoresignificantlywith performance.Specifically,LambdaMARTachievesaKendallâ€™sTau\ngroupsizechanges.Thisisevidentfromthevaryingdifferencesin of0.0071onNASDAQand0.0054onNYSE,trailingbehindRank-\ntheirKendallâ€™sTauandMRRcomparedtothoseofTSPRank-Global. former(0.0110and0.0181)andTSPRank-Global(0.0447and0.0422).\nConversely,TSPRank-Globalconsistentlyperformswellregardless Table2furthervalidatesthisobservation.Inboththetop10and\nofgroupsize,maintainingtopperformanceacrossmostmetrics. top30documentsettings,LambdaMARTconsistentlyunderper-\nformsRankformerandTSPRank-Globalwhenadaptingtoordinal\nGlobalLearningOutperformsLocalLearning(RQ2). Asevi-\nranking labels across all metrics. These results underscore that\ndencedbytheperformanceofTSPRank-GlobalcomparedtoTSPRank-\nwhileLambdaMARTperformswellwithbinaryrelevancelabels\nLocalonMQ2008andOTD2.Forexample,ontheOTD2dataset\norrelevancelevelslabels,itisnotalwaystheoptimalchoicefor\n(Table3),TSPRank-GlobalachievesaKendallâ€™sTauof0.6301,0.6302,\nrecoveringcompleterankings.\n0.6207forthethreedifferentgroupsizes,comparedtoTSPRank-\nOverall,TSPRankâ€™ssuccesssuggeststhatcombiningpairwise\nLocalâ€™s0.5658,0.5095,and0.4713.Theseresultssuggestthatthe\nandlistwiseapproacheshelpsthemodelcapturetherelativeor-\nend-to-endglobaloptimisationapproachofTSPRank-Globalaligns\nderingofentitiesandtheoverallrankingstructure.Thisdualfo-\nmoreeffectivelywithoveralloptimisationgoals,whereasthenon-\ncuslikelycontributestoitssuperiorperformanceacrossvarious\nend-to-endmethodmaynotperfectlyalignwithglobaloptimisation\ndatasetsandmetrics,makingitversatileandpowerful.\nbytheTSPsolver.\nLambdaMARTDoesNotAlwaysOutperformDeepLearning\nBasedRankingAlgorithm(RQ3). AlthoughQinetal.suggests 7 VISUALISATIONANALYSIS\nthatGBDTmodels,suchasLambdaMART,generallyoutperform\nAs mentioned before, our pairwise-listwise TSPRank addresses\ndeeplearningmodelsonstandardinformationretrievaldatasets\nboththelackoflistwiseoptimisationinpairwiseLambdaMART\n[39],ourresultsindicatethatthisisnotalwaysthecaseinother\nandtherobustnessissuesinlistwiseRankformer,whicharisefrom\ncontexts.AsdemonstratedinTable1,withinthedomain-specific\nattemptingtopredictthecompleterankingsdirectly.\nKDDâ€™25,August3â€“7,2025,Toronto,Canada WeixianWaylonLi,YftahZiser,YifeiXie,ShayB.Cohen,andTiejunMa\nToempiricallyvalidatethisandanswerRQ4(theadvantages EventTitle Year Rank Label\nofhybridpairwise-listwiseTSPRankoverothermethods),wecon- 1stUSstoretoinstallelectriclights,Philadelphia 1878 3 US-1\nductedanotherexperimentontheOTD2dataset,chosenbecauseof\n1stsittingUSPresidenttovisitSouthAmerica,FDR 1934 5 US-2\nthebetterinterpretabilityprovidedbytext.Wearbitrarilysample\ninColombia\nthreeeventseachfromtheUS,UK,andChina,ensuringthatthe\n75thUSMastersTournament,AugustaNationalGC: 2011 8 US-3\neventswithineachcountryoccurredatleast50yearsapart(detailed\nCharlSchwartzelofSouthAfricabirdiesthefinal4\ninTable4).WethenusethepretrainedLambdaMART,Rankformer, holestowinhisfirstmajortitle,2strokesaheadof\nandTSPRank-GlobalfromtheexperimentsdescribedinSection5 AustralianpairAdamScottandJasonDay\ntopredicttherankingsforthisconstructedgroup.Wevisualisethe\nCharlesWatson-Wentworth,2ndMarquessofRock- 1782 2 UK-1\npredictionsgivenbythethreerankersinFigure2.Boththepairwise ingham,becomesPrimeMinisterofGreatBritain\nLambdaMARTandpairwise-listwiseTSPRank-Globalsuccessfully\n1stmainlineelectrictraininUK(LiverpooltoSouth- 1904 4 UK-2\nrecovertheintra-countryeventorder,correctlyidentifyingtherel- port)\nativeorderwithinthesamecolourgroup.However,thelistwise\nUKTerrorismAct2006becomeslaw 2006 7 UK-3\nRankformerincorrectlypredictsthatâ€œUS-2â€occursearlierthan\nAMongolianvictoryatthenavalBattleofYamenends 1279 1 CN-1\nâ€œUS-1â€.\ntheSongDynastyinChina\nAlthoughLambdaMARTsuccessfullyrecoverstheintra-country\neventorder,itmakesmistakesintheoverallranking,particularly USSenaterejectsChinaPeopleâ€™sRepublicmember- 1953 6 CN-2\nshiptoUN\nfailingtorecoverthecorrectorderof[â€œUS-1â€,â€œUK-1â€,â€œCN-1â€]and\n[â€œUS-3â€,â€œUK-3â€,â€œCN-3â€],validatingitsweakerabilityforlistwise Chinaâ€™sHubeiprovince,theoriginalcenterofthe 2020 9 CN-3\ncoronavirusCOVID-19outbreakeasesrestrictionson\nrankingoptimisation.Incontrast,TSPRankaccuratelyrecovers\ntravelafteranearlytwo-monthlockdown\nmostorders,withonlyaminorerrorbetweenâ€œUS-2â€andâ€œUK-2â€,\nTable4:Eventtitlesintheconstructedgroup.Labelsindicate\nwhichonlyhavea30-yeargap(1934and1904).\ntheorderofoccurrencewithineachcountry,e.g.,â€œUS-1â€de-\nWealsovisualisetheintra-countryconnectionsusingtheadja-\nnotestheearliesteventintheUSwithinthegroup.\ncencymatrixpredictedbyTSPRankâ€™sbilinearmodelinFigure3,\nomittingcross-countryconnectionsforclarity.Ashighlightedin\nUS-1 UK-1 CN-1\nr se ind c, eth ğ‘ e (Udi Sr -e 1c ,t Uc So -m 3)pa shri oso un ldb be etw he ie gn heâ€œ rU tS h-1 aâ€ na ğ‘ n (d USâ€œU -3S ,- U3 Sâ€ -i 1s )i ,n bc uo trr te hc et 0.130 (2) -1.177 -1.781 (1) -2.371 -1.334 (3) -0.490\n0.732 0.490 2.241-3.324 -0.684-1.228\nmodelfailsinthiscase.However,asshowninFigure2,TSPRank\nUS-2 -2.095 US-3 UK-2 -0.442 UK-3 CN-2 0.448 CN-3\nstillcorrectlyplacesâ€œUS-1â€atposition3andâ€œUS-3â€atposition8. (5) (8) (4) (7) (6) (9)\nThisindicatesthatthemodelbenefitsfromthecross-countrycon- -2.133 -1.371 0.005\nnectionsandthelistwiseoptimisationprovidedbytheTSPsolver.\nFigure3:Illustrationoftheintra-countrypairwisecompar-\nThismakesthemodelmoretoleranttoerrorsoruncertaintiesin\nison graph. Edges between pairs of events from different\npairwisecomparisons,asthelistwiseoptimisationensuresthat\ncountriesareomittedforclarity.Scoreshighlightedinredin-\nthehighest-scoringpermutationisselected.Weprovideadditional\ndicateerrorsinthepairwisepredictionforTSPRank-Global.\nexamplesinAppendixCtofurthervalidatethisobservation.\ntothediscreteTSPsolver.Whenthegroupsizereaches100,the\nsolverconsumesapproximately99.8%oftheinferencetime,while\nLambdaMART UK-1 CN-1 US-1 UK-2 US-2 CN-2 CN-3 UK-3 US-3 theencodingtimeremainssimilartothatofRankformer.There-\n(2) (1) (3) (4) (5) (6) (9) (7) (8)\nfore,TSPRankismoresuitableforsmall-scalerankingproblems\nRankformer US-2 UK-1 CN-1 UK-2 US-1 CN-2 US-3 CN-3 UK-3 with fewer than 30 entities, where its inference time is compa-\n(5) (2) (1) (4) (3) (6) (8) (9) (7)\nrabletoRankformer.Itisalsoadvantageousinscenarioswhere\nTSPRankâ€™sperformanceimprovementsoutweightheincreasedla-\nTSPRank-Global C (N 1)-1 U (K 2)-1 U (S 3- )1 U (S 5- )2 U (K 4- )2 C (N 6- )2 U (K 7)-3 U (S 8- )3 C (N 9- )3 tency.SolverslikeGurobiareefficientforsmallTSPgraphs.How-\never, exact solutions for larger graphs require specialised tech-\nFigure 2: Visualisation of predictions by LambdaMART, niques, such as the Concorde TSP Solver6, which uses cutting-\nRankformer,andTSPRank-Globalontheconstructedgroup. planealgorithmsandabranch-and-boundapproachtosolvegraphs\nNumbersinparenthesesindicatethetrueranking. withupto85,900nodes[4].Beyondexactsolvers,heuristicalgo-\nrithms like the Christofidesâ€“Serdyukov algorithm [13] and the\n8 INFERENCELATENCY Linâ€“Kernighanâ€“Helsgaunheuristic[24,25,32]arealsoused.\nMoreover, recent advances in neural networks have enabled\nIncorporatingacombinatorialoptimisationsolverisknowntocause\ntheuseofdeeplearningtoapproximatetheTSPrewardfunction,\nadditionalcomputationaloverhead,whichcanimpacttheinference\nemployingreinforcementlearningtosolvetheproblem[5,28,29].\nlatency. Therefore, we compare the average inference time per\nWhilewedonotdelvedeeplyintothevariousTSPsolutionsinthis\nrankinggroupforTSPRankandRankformerontheOTD2historical\npaper,wedemonstratethatinferencelatencystemsfromtheTSP\neventsorderingdataset.Theexperimentalsetupanddetailedresults\nsolveranddiscusspotentialenhancementsforreducinginference\nareprovidedinAppendixD.\nlatencyandtacklinglarge-scalerankingproblems.\nWeobservethattheinferencetimeforTSPRankincreasesex-\nponentially with the number of ranking entities, primarily due 6https://www.math.uwaterloo.ca/tsp/concorde/index.html\nTSPRank:BridgingPairwiseandListwiseMethodswithaBilinearTravellingSalesmanModel KDDâ€™25,August3â€“7,2025,Toronto,Canada\n9 CONCLUSION\n[11] ZheCao,TaoQin,Tie-YanLiu,Ming-FengTsai,andHangLi.2007. Learning\ntorank:frompairwiseapproachtolistwiseapproach.InProceedingsofthe24th\nThisstudyintroducesTSPRank,anovelpairwise-listwiseapproach\nInternationalConferenceonMachineLearning(Corvalis,Oregon,USA)(ICML\nforposition-basedrankingtasks,bymodellingthemastheTrav- â€™07).AssociationforComputingMachinery,NewYork,NY,USA,129â€“136. https:\nellingSalesmanProblem(TSP).Wepresenttwolearningmethods //doi.org/10.1145/1273496.1273513\n[12] TianqiChenandCarlosGuestrin.2016. XGBoost:AScalableTreeBoosting\nforTSPRank,integratinglistwiseoptimizationintopairwisecom- System.InProceedingsofthe22ndACMSIGKDDInternationalConferenceon\nparisonstoaddressthelimitationsoftraditionalpurepairwiseand KnowledgeDiscoveryandDataMining(KDDâ€™16).ACM. https://doi.org/10.1145/\n2939672.2939785\nlistwiserankingmodels.TSPRankâ€™sapplicationtodiverseback-\n[13] NicosChristofides.2022.Worst-caseanalysisofanewheuristicforthetravelling\nbonemodelsanddatasets,includingstockranking,information salesmanproblem.InOperationsResearchForum,Vol.3.Springer,20. \"https:\nretrieval, and historical events ordering, demonstrates its supe- //doi.org/10.1007/s43069-021-00101-z\"\n[14] IBMILOGCplex.2009.V12.1:Userâ€™sManualforCPLEX.InternationalBusiness\nriorperformanceandrobustness.KeyfindingsincludeTSPRankâ€™s\nMachinesCorporation46,53(2009),157.\nabilitytooutperformexistingmodelssuchasLambdaMARTand [15] YangDeng,WenxuanZhang,andWaiLam.2021.LearningtoRankQuestion\nRankformeracrossmultipledatasetsandvariousmetrics.Further- AnswerPairswithBilateralContrastiveDataAugmentation.InProceedingsofthe\nSeventhWorkshoponNoisyUser-generatedText,W-NUT2021,Online,November11,\nmore,TSPRankâ€™scapabilitytofunctionasanadditionalcomponent 2021,WeiXu,AlanRitter,TimBaldwin,andAfshinRahimi(Eds.).Associationfor\nonembeddingssuggestsitsversatilityandpotentialforbroader ComputationalLinguistics,175â€“181. https://doi.org/10.18653/V1/2021.WNUT-\n1.20\napplicationsacrossdifferentdomains.\n[16] XinyanFan,JianxunLian,WayneXinZhao,ZhengLiu,ChaozhuoLi,andXing\nOurempiricalanalysisrevealsthatTSPRankâ€™ssuperiorperfor- Xie.2022. Ada-Ranker:ADataDistributionAdaptiveRankingParadigmfor\nmanceisduetothediscreteTSPsolverâ€™sabilitytomoreeffectively SequentialRecommendation.InProceedingsofthe45thInternationalACMSIGIR\nConferenceonResearchandDevelopmentinInformationRetrieval(SIGIRâ€™22).\nutiliselistwiseinformation.ItalsoenhancesTSPRankâ€™stolerance\nAssociationforComputingMachinery,NewYork,NY,USA,1599â€“1610. https:\ntouncertaintiesinpairwisecomparisonsbyensuringtheselection //doi.org/10.1145/3477495.3531931\nofthehighest-scoringpermutation.Futureworkcouldexplorethe [17] FuliFeng,XiangnanHe,XiangWang,ChengLuo,YiqunLiu,andTat-SengChua.\n2019.TemporalRelationalRankingforStockPrediction.ACMTrans.Inf.Syst.\nuseofalternativeTSPsolversandfurtherenhancementstothe 37,2,Article27(mar2019),30pages. https://doi.org/10.1145/3309547\nGurobisolvertoreduceinferencelatencyandimprovescalability. [18] JeromeHFriedman.2001.Greedyfunctionapproximation:agradientboosting\nmachine.Annalsofstatistics(2001),1189â€“1232.\n[19] NorbertFuhr.1989.Optimumpolynomialretrievalfunctionsbasedontheproba-\nbilityrankingprinciple.ACMTransactionsonInformationSystems(TOIS)7,3\nREFERENCES (1989),183â€“204.\n[20] RuochengGuo,XiaotingZhao,AdamHenderson,LiangjieHong,andHuan\n[1] OmriAbend,ShayB.Cohen,andMarkSteedman.2015. LexicalEventOr- Liu.2020.DebiasingGrid-basedProductSearchinE-commerce.InProceedings\nderingwithanEdge-FactoredModel.InProceedingsofthe2015Conferenceof ofthe26thACMSIGKDDInternationalConferenceonKnowledgeDiscovery&\ntheNorthAmericanChapteroftheAssociationforComputationalLinguistics: DataMining(VirtualEvent,CA,USA)(KDDâ€™20).AssociationforComputing\nHumanLanguageTechnologies,RadaMihalcea,JoyceChai,andAnoopSarkar Machinery,NewYork,NY,USA,2852â€“2860. https://doi.org/10.1145/3394486.\n(Eds.).AssociationforComputationalLinguistics,Denver,Colorado,1161â€“1171. 3403336\nhttps://doi.org/10.3115/v1/N15-1122 [21] ShashankGupta,PhilippHager,JinHuang,AliVardasbi,andHarrieOosterhuis.\n[2] QingyaoAi,KepingBi,JiafengGuo,andW.BruceCroft.2018.LearningaDeep 2024.UnbiasedLearningtoRank:OnRecentAdvancesandPracticalApplications.\nListwiseContextModelforRankingRefinement.InThe41stInternationalACM InProceedingsofthe17thACMInternationalConferenceonWebSearchandData\nSIGIRConferenceonResearch&DevelopmentinInformationRetrieval(AnnArbor, Mining(Merida,Mexico)(WSDMâ€™24).AssociationforComputingMachinery,\nMI,USA)(SIGIRâ€™18).AssociationforComputingMachinery,NewYork,NY,USA, NewYork,NY,USA,1118â€“1121. https://doi.org/10.1145/3616855.3636451\n135â€“144. https://doi.org/10.1145/3209978.3209985 [22] GurobiOptimization,LLC.2023.GurobiOptimizerReferenceManual. https:\n[3] QingyaoAi,XuanhuiWang,SebastianBruch,NadavGolbandi,MichaelBender- //www.gurobi.com\nsky,andMarcNajork.2019.LearningGroupwiseMultivariateScoringFunctions [23] YixuanHe,QuanGan,DavidWipf,GesineDReinert,JunchiYan,andMihaiCu-\nUsingDeepNeuralNetworks.InProceedingsofthe2019ACMSIGIRInterna- curingu.2022.GNNRank:LearningGlobalRankingsfromPairwiseComparisons\ntionalConferenceonTheoryofInformationRetrieval(SantaClara,CA,USA) viaDirectedGraphNeuralNetworks.InInternationalConferenceonMachine\n(ICTIRâ€™19).AssociationforComputingMachinery,NewYork,NY,USA,85â€“92. Learning.PMLR,8581â€“8612.\nhttps://doi.org/10.1145/3341981.3344218 [24] KeldHelsgaun.2000.AneffectiveimplementationoftheLinâ€“Kernighantraveling\n[4] DavidLApplegate.2006.Thetravelingsalesmanproblem:acomputationalstudy. salesmanheuristic.Europeanjournalofoperationalresearch126,1(2000),106â€“130.\nVol.17.Princetonuniversitypress. \"https://doi.org/10.1016/S0377-2217(99)00284-2\"\n[5] IrwanBello,HieuPham,QuocV.Le,MohammadNorouzi,andSamyBen- [25] KeldHelsgaun.2017.AnextensionoftheLin-Kernighan-HelsgaunTSPsolverfor\ngio. 2017. Neural Combinatorial Optimization with Reinforcement Learn- constrainedtravelingsalesmanandvehicleroutingproblems.Roskilde:Roskilde\ning.In5thInternationalConferenceonLearningRepresentations,ICLR2017, University12(2017),966â€“980.\nToulon,France,April24-26,2017,WorkshopTrackProceedings.OpenReview.net. [26] OrHonovich,LucasTorrobaHennigen,OmriAbend,andShayB.Cohen.2020.\nhttps://openreview.net/forum?id=Bk9mxlSFx MachineReadingofHistoricalEvents.InProceedingsofthe58thAnnualMeeting\n[6] ChristopherBurges.2010. Fromranknettolambdaranktolambdamart:An oftheAssociationforComputationalLinguistics,DanJurafsky,JoyceChai,Natalie\noverview.Learning11(012010). Schluter,andJoelTetreault(Eds.).AssociationforComputationalLinguistics,\n[7] ChristopherBurges,RobertRagno,andQuocLe.2006.Learningtorankwith Online,7486â€“7497. https://doi.org/10.18653/v1/2020.acl-main.668\nnonsmoothcostfunctions.Advancesinneuralinformationprocessingsystems19 [27] ZongchengJiandBinWang.2013. Learningtorankforquestionroutingin\n(2006). communityquestionanswering.InProceedingsofthe22ndACMInternational\n[8] ChrisBurges,TalShaked,ErinRenshaw,AriLazier,MattDeeds,NicoleHamilton, ConferenceonInformation&KnowledgeManagement(SanFrancisco,California,\nandGregHullender.2005.Learningtorankusinggradientdescent.InProceedings USA)(CIKMâ€™13).AssociationforComputingMachinery,NewYork,NY,USA,\nofthe22ndinternationalconferenceonMachinelearning.89â€“96. 2363â€“2368. https://doi.org/10.1145/2505515.2505670\n[9] MaartenBuyl,PaulMissault,andPierre-AntoineSondag.2023. RankFormer: [28] EliasKhalil,HanjunDai,YuyuZhang,BistraDilkina,andLeSong.2017.Learn-\nListwiseLearning-to-RankUsingListwideLabels.InProceedingsofthe29th ingcombinatorialoptimizationalgorithmsovergraphs. Advancesinneural\nACMSIGKDDConferenceonKnowledgeDiscoveryandDataMining(KDDâ€™23). informationprocessingsystems30(2017).\nAssociationforComputingMachinery,NewYork,NY,USA,3762â€“3773. https: [29] WouterKool,HerkeVanHoof,andMaxWelling.2019.Attention,learntosolve\n//doi.org/10.1145/3580305.3599892 routingproblems!InternationalConferenceonLearningRepresentations(2019).\n[10] StefanoCampese,IvanoLauriola,andAlessandroMoschitti.2024.Pre-Training [30] RogerZheLi,JuliÃ¡nUrbano,andAlanHanjalic.2021.NewInsightsintoMetric\nMethodsforQuestionReranking.InProceedingsofthe18thConferenceofthe OptimizationforRanking-basedRecommendation.InProceedingsofthe44th\nEuropeanChapteroftheAssociationforComputationalLinguistics(Volume2:Short InternationalACMSIGIRConferenceonResearchandDevelopmentinInformation\nPapers),YvetteGrahamandMatthewPurver(Eds.).AssociationforComputa- Retrieval(SIGIRâ€™21).AssociationforComputingMachinery,NewYork,NY,USA,\ntionalLinguistics,St.Julianâ€™s,Malta,469â€“476. https://aclanthology.org/2024.eacl- 932â€“941. https://doi.org/10.1145/3404835.3462973\nshort.41\nKDDâ€™25,August3â€“7,2025,Toronto,Canada WeixianWaylonLi,YftahZiser,YifeiXie,ShayB.Cohen,andTiejunMa\n[31] YiLi,JiemingZhu,WeiwenLiu,LiangcaiSu,GuohaoCai,QiZhang,Ruiming 76908â€“76922. https://proceedings.neurips.cc/paper_files/paper/2023/file/\nTang,XiXiao,andXiuqiangHe.2022. PEAR:PersonalizedRe-rankingwith f2a11632520f4b7473d7838f074a7d25-Paper-Conference.pdf\nContextualizedTransformerforRecommendation.InCompanionProceedingsof [50] Mei-ChenWu,Szu-HaoHuang,andAn-PinChen.2024.Momentumportfolio\ntheWebConference2022(VirtualEvent,Lyon,France)(WWWâ€™22).Association selectionbasedonlearning-to-rankalgorithmswithheterogeneousknowledge\nforComputingMachinery,NewYork,NY,USA,62â€“66. https://doi.org/10.1145/ graphs.AppliedIntelligence54(032024),1â€“21. https://doi.org/10.1007/s10489-\n3487553.3524208 024-05377-2\n[32] ShenLinandBrianWKernighan.1973.Aneffectiveheuristicalgorithmforthe [51] HongjieXia,HuijieAo,LongLi,YuLiu,SenLiu,GuangnanYe,andHongfeng\ntraveling-salesmanproblem.Operationsresearch21,2(1973),498â€“516. \"https: Chai.2024.CI-STHPAN:Pre-trainedAttentionNetworkforStockSelectionwith\n//doi.org/10.1287/opre.21.2.498\" Channel-IndependentSpatio-TemporalHypergraph. ProceedingsoftheAAAI\n[33] HarrieOosterhuis.2023.DoublyRobustEstimationforCorrectingPositionBias ConferenceonArtificialIntelligence38(032024),9187â€“9195. https://doi.org/10.\ninClickFeedbackforUnbiasedLearningtoRank. ACMTrans.Inf.Syst.41,3, 1609/aaai.v38i8.28770\nArticle61(feb2023),33pages. https://doi.org/10.1145/3569453 [52] JinhuiYang,XiaohuShi,MaurizioMarchese,andYanchunLiang.2008.Anant\n[34] LiangPang,JunXu,QingyaoAi,YanyanLan,XueqiCheng,andJirongWen. colonyoptimizationmethodforgeneralizedTSPproblem.Progressinnatural\n2020. Setrank:Learningapermutation-invariantrankingmodelforinforma- science18,11(2008),1417â€“1422. https://doi.org/10.1016/j.pnsc.2008.03.028\ntionretrieval.InProceedingsofthe43rdInternationalACMSIGIRConferenceon [53] XinZhang,LanWu,andZhixueChen.2022. Constructinglong-shortstock\nResearchandDevelopmentinInformationRetrieval.499â€“508. portfoliowithanewlistwiselearn-to-rankalgorithm.QuantitativeFinance22,2\n[35] RamaKumarPasumarthi,HongleiZhuang,XuanhuiWang,MichaelBendersky, (2022),321â€“331.\nandMarcNajork.2020.PermutationEquivariantDocumentInteractionNetwork [54] YunanZhang,LeYan,ZhenQin,HongleiZhuang,JiamingShen,XuanhuiWang,\nforNeuralLearningtoRank.InProceedingsofthe2020ACMSIGIRonInternational MichaelBendersky,andMarcNajork.2023.TowardsDisentanglingRelevance\nConferenceonTheoryofInformationRetrieval(VirtualEvent,Norway)(ICTIR andBiasinUnbiasedLearningtoRank.InProceedingsofthe29thACMSIGKDD\nâ€™20).AssociationforComputingMachinery,NewYork,NY,USA,145â€“148. https: ConferenceonKnowledgeDiscoveryandDataMining(LongBeach,CA,USA)\n//doi.org/10.1145/3409256.3409819 (KDDâ€™23).AssociationforComputingMachinery,NewYork,NY,USA,5618â€“5627.\n[36] ChanghuaPei,YiZhang,YongfengZhang,FeiSun,XiaoLin,HanxiaoSun, https://doi.org/10.1145/3580305.3599914\nJianWu,PengJiang,JunfengGe,WenwuOu,andDanPei.2019.Personalized [55] HongleiZhuang,ZhenQin,XuanhuiWang,MichaelBendersky,XinyuQian,\nre-rankingforrecommendation.InProceedingsofthe13thACMConferenceon PoHu,andDanCharyChen.2021. Cross-PositionalAttentionforDebiasing\nRecommenderSystems(Copenhagen,Denmark)(RecSysâ€™19).Associationfor Clicks.InProceedingsoftheWebConference2021(Ljubljana,Slovenia)(WWW\nComputingMachinery,NewYork,NY,USA,3â€“11. https://doi.org/10.1145/ â€™21).AssociationforComputingMachinery,NewYork,NY,USA,788â€“797. https:\n3298689.3347000 //doi.org/10.1145/3442381.3450098\n[37] StefanPoikonen,BruceGolden,andEdwardAWasil.2019.Abranch-and-bound\napproachtothetravelingsalesmanproblemwithadrone.INFORMSJournalon\nComputing31,2(2019),335â€“346. https://doi.org/10.1287/ijoc.2018.0826\n[38] TaoQinandTie-YanLiu.2013. IntroducingLETOR4.0Datasets. ArXiv\nabs/1306.2597(2013). https://api.semanticscholar.org/CorpusID:12130755\n[39] ZhenQin,LeYan,HongleiZhuang,YiTay,RamaKumarPasumarthi,Xuanhui\nWang,MikeBendersky,andMarcNajork.2021.AreNeuralRankersstillOut-\nperformedbyGradientBoostedDecisionTrees?.InInternationalConferenceon\nLearningRepresentations(ICLR).\n[40] JuliaRieckandJÃ¼rgenZimmermann.2010.Anewmixedintegerlinearmodel\nforarichvehicleroutingproblemwithdockingconstraints.AnnalsofOperations\nResearch181(2010),337â€“358. https://doi.org/10.1007/s12046-018-1048-y\n[41] SumanSaha,JunbinGao,andRichardGerlach.2021.Stockrankingprediction\nusinglist-wiseapproachandnodeembeddingtechnique.IEEEAccess9(2021),\n88981â€“88996.\n[42] RamitSawhney,ShivamAgarwal,ArnavWadhwa,TylerDerr,andRajivRatn\nShah.2021.StockSelectionviaSpatiotemporalHypergraphAttentionNetwork:\nALearningtoRankApproach.InProceedingsoftheAAAIConferenceonArtificial\nIntelligence,Vol.35.497â€“504.\n[43] AliakseiSeverynandAlessandroMoschitti.2015.Learningtorankshorttextpairs\nwithconvolutionaldeepneuralnetworks.InProceedingsofthe38thinternational\nACMSIGIRconferenceonresearchanddevelopmentininformationretrieval.373â€“\n382.\n[44] AmnonShashuaandAnatLevin.2002. Taxonomyoflargemarginprinciple\nalgorithmsforordinalregressionproblems. Advancesinneuralinformation\nprocessingsystems15(2002),937â€“944.\n[45] QiangSong,AnqiLiu,andSteveY.Yang.2017.Stockportfolioselectionusing\nlearning-to-rankalgorithmswithnewssentiment.Neurocomputing264(2017),\n20â€“28. https://doi.org/10.1016/j.neucom.2017.02.097Machinelearninginfinance.\n[46] JiweiTan,XiaojunWan,andJianguoXiao.2013. LearningtoOrderNatural\nLanguageTexts.InProceedingsofthe51stAnnualMeetingoftheAssociationfor\nComputationalLinguistics(Volume2:ShortPapers),HinrichSchuetze,Pascale\nFung,andMassimoPoesio(Eds.).AssociationforComputationalLinguistics,\nSofia,Bulgaria,87â€“91. https://aclanthology.org/P13-2016\n[47] AshishVaswani,NoamShazeer,NikiParmar,JakobUszkoreit,LlionJones,\nAidanN.Gomez,ÅukaszKaiser,andIlliaPolosukhin.2017.Attentionisallyou\nneed.InProceedingsofthe31stInternationalConferenceonNeuralInformation\nProcessingSystems(LongBeach,California,USA)(NIPSâ€™17).CurranAssociates\nInc.,RedHook,NY,USA,6000â€“6010.\n[48] HeyuanWang,TengjiaoWang,ShunLi,JiayiZheng,ShijieGuan,andWeiChen.\n2022.AdaptiveLong-ShortPatternTransformerforStockInvestmentSelection.\nInProceedingsoftheThirty-FirstInternationalJointConferenceonArtificialIntelli-\ngence,IJCAI-22,LudDeRaedt(Ed.).InternationalJointConferencesonArtificial\nIntelligenceOrganization,3970â€“3977. https://doi.org/10.24963/ijcai.2022/551\nMainTrack.\n[49] RuiWang,PeipeiLi,HuaiboHuang,ChunshuiCao,RanHe,andZhaofengHe.\n2023. Learning-to-Rank Meets Language: Boosting Language-Driven\nOrdering Alignment for Ordinal Classification. In Advances in Neu-\nral Information Processing Systems, A. Oh, T. Naumann, A. Globerson,\nK.Saenko,M.Hardt,andS.Levine(Eds.),Vol.36.CurranAssociates,Inc.,\nTSPRank:BridgingPairwiseandListwiseMethodswithaBilinearTravellingSalesmanModel KDDâ€™25,August3â€“7,2025,Toronto,Canada\nA TSPOPTIMISATIONPROBLEM Dataset Hyperparameter Value Model\nn_estimators 104\nRankingentityeğ‘— immediatelyafterentityeğ‘– isanalogoustotravel-\nloss_fn rank:pairwise\nlingfromcityğ‘–tocityğ‘—.Letğ‘ bethetotalnumberofentitiestobe AllTasks eval_metric auc LambdaMART\nrankedandğ‘§ ğ‘– variablestorepresentthenumberofentitiesranked early_stopping 50\nbeforeentityğ‘–.TheMILPformulationoftheTSPRankinferenceis loss OrdinalLoss[9] Rankformer\nlr 1e-4\nasfollows: weight_decay 1e-5\ntflayer 1\nStocks Rankformer,TSPRank\ntfnheads 8\nğ‘ ğ‘\nâˆ‘ï¸ âˆ‘ï¸ tfdim_ff 128\nmin ğ‘ ğ‘–ğ‘—ğ‘¥ ğ‘–ğ‘— (10) batch_size 128\nğ‘¥ğ‘–ğ‘—\nğ‘–=1ğ‘—=1,ğ‘—â‰ ğ‘– lr 1e-4\nğ‘ weight_decay 1e-5\nâˆ‘ï¸ tflayer 4\nğ‘ .ğ‘¡. ğ‘¥ ğ‘–ğ‘— â‰¤1 forallğ‘– (11) MQ2008 tfnheads 8 Rankformer,TSPRank\nğ‘—=1,ğ‘—â‰ ğ‘– tfdim_ff 128\nğ‘ batchsize 64\nâˆ‘ï¸ ğ‘¥ ğ‘–ğ‘— â‰¤1 forallğ‘— (12) l wr eight_decay 1 1e e- -4 5\nğ‘–=1,ğ‘–â‰ ğ‘— HistoricalEvents tfdim_ff 0 Rankformer,TSPRank\nğ‘ ğ‘ batchsize 32\nâˆ‘ï¸ âˆ‘ï¸\nğ‘¥ ğ‘–ğ‘— =ğ‘ âˆ’1 (13) Table5:HyperparametersforLambdaMARTmodelacross\nğ‘–=1ğ‘—=1,ğ‘—â‰ ğ‘– different tasks: Stock Ranking, MQ2008, and Historical\nğ‘§ ğ‘– +1â‰¤ğ‘§ ğ‘— +ğ‘(1âˆ’ğ‘¥ ğ‘–ğ‘—) ğ‘–,ğ‘— =2,...,ğ‘, ğ‘– â‰  ğ‘— (14) EventsOrdering.\nğ‘§ ğ‘– â‰¥0 ğ‘– =2,...,ğ‘ (15)\n[Japan, Russia, Germany]\nConstraints(11)and(12)ensurethateachentityhasatmost\no 2ğ‘ne âˆ’pr 2ed lie nc ee as rso inr ea qn ud alo itn iee ss .u Cc oc ne ss ts ro ar inin t(t 1h 3e )r ea nn sk ui rn eg s, te hx ap tr te hs ese td ota as\nl\nLambdaMART D (E 1)-1 D (E 2- )2 R (U 3)-1 J (P 4- )1 J (P 5- )2 R (U 7)-2 D (E 6- )3 J (P 8- )3 R (U 9- )3\nnumberofpairwisecomparisonsisexactlyğ‘âˆ’1.Theseconstraints\nensurethattheselectedsetofpairwisecomparisonsformsavalid\nRankformer D (E 2- )2 D (E 1)-1 R (U 3)-1 J (P 4- )1 J (P 5- )2 R (U 9- )3 D (E 6- )3 R (U 7)-2 J (P 8- )3\nrankingsequence.Constraints(14)and(15)introducevariablesğ‘§\ntoeliminatemultipleseparatesequencesandenforcethatthereis TSPRank-Global D (E 1)-1 D (E 2- )2 R (U 3)-1 J (P 4- )1 J (P 5- )2 D (E 6- )3 R (U 7)-2 J (P 8- )3 R (U 9- )3\nasingle,completerankingthatincludesallentities.\n[France, Korean, Brazil]\nB HYPERPARAMETERSSETTING\nThehyperparametersarespecifiedinTable5.Inthetable,several\nLambdaMART F (R 2- )1 F (R 3- )2 K (R 1)-1 B (R 4)-1 K (R 6- )2 B (R 5- )2 F (R 7- )3 B (R 9- )3 K (R 8- )3\nabbreviationsareusedforconcisenessandclarity:\nâ€¢ lr:Learningrate,whichcontrolsthestepsizeduringtheopti-\nRankformer F (R 2- )1 F (R 3- )2 K (R 1)-1 B (R 4)-1 B (R 5- )2 K (R 6- )2 K (R 8- )3 B (R 9- )3 F (R 7- )3\nmizationprocess.\nâ€¢ tflayer:Numberoftransformerlayers,indicatingthedepthof TSPRank-Global F (R 2- )1 F (R 3- )2 B (R 4)-1 K (R 1)-1 B (R 5- )2 K (R 6- )2 F (R 7- )3 K (R 8- )3 B (R 9- )3\nthetransformermodel.\nâ€¢ tfnheads:Numberofattentionheads,whichspecifiesthenum- [India, Italy, Australia]\nberofparallelattentionmechanismswithinthetransformerlayer.\nâ€¢ tfdim_ff:Dimensionalityofthefeed-forwardnetworkwithin LambdaMART I (T 2- )1 A (U 3)-1 I (N 1- )1 I (T 5- )2 I (N 4- )2 A (U 6- )2 I (N 7- )3 I (T 9- )3 A (U 8- )3\nthetransformerlayer.\nRankformer I (N 1- )1 I (T 2- )1 I (T 5- )2 A (U 3)-1 I (N 4- )2 A (U 6- )2 I (T 9- )3 I (N 7- )3 A (U 8- )3\nC ADDITIONALVISUALISATIONEXAMPLES\nWefurtherconstructthreemoregroupsusingeventsfromdifferent TSPRank-Global I (N 1- )1 I (T 2- )1 A (U 3)-1 I (T 5- )2 I (N 4- )2 A (U 6- )2 I (N 7- )3 A (U 8- )3 I (T 9- )3\ncountries.Theeventtitles,labels,andtruerankingsareprovidedin\nTable6.Thevisualisationofthemodelsâ€™predictionsareshownin\nFigure4.WeobservesimilarpatternstothosediscussedinSection7. Figure4:Visualisationofthemodelpredictionsonadditional\ngroups.Numbersinparenthesesindicatethetrueranking.\nD LATENCYANALYSISDETAILS\nWeconductaninferencetimeanalysisonastandalonedevicewith Figure5illustratestheaverageinferencetimeinsecondsper\nan AMD Ryzen 7 5800X 8-Core CPU and an Nvidia RTX 4070 rankinggroupforTSPRankandRankformerontheOTD2historical\nSuperGPU.Usingthestandalonedeviceinsteadoftheoneused eventsorderingdataset,withaninputdimensionalityof1536.We\nfortrainingistoavoidinterferencefromotherrunningjobsonthe providetheinferencetimesforvariousgroupsizes:5,10,30,50,\nsharedcomputingnode. and100.\nKDDâ€™25,August3â€“7,2025,Toronto,Canada WeixianWaylonLi,YftahZiser,YifeiXie,ShayB.Cohen,andTiejunMa\nGroup EventTitle Year Rank Label\nJapaneseimmigrationtoBrazilbeginswhen781peoplearriveinSantosaboardtheKasato-Maruship 1908 4 JP-1\nPassengershipLurlinesendsradiosignalofsightingJapanesewarfleet 1941 5 JP-2\nAreactorattheFukushimaDaiichinuclearpowerplantmeltsandexplodesandreleasesradioactivityintotheatmospherea 2011 8 JP-3\ndayafterJapanâ€™searthquake.\n1 TheStateBankoftheRussianEmpireisestablished. 1860 3 RU-1\n\"Mirror\",RussianfilmdirectedbyAndreiTarkovsky,starringMargaritaTerekhovaandIgnatDaniltsev,isreleased 1975 7 RU-2\nRussiancityMoscowbeginsacity-widelockdownafter4hoursnoticeduetocoronavirusCOVID-19 2020 9 RU-3\nAlbrechtIIofHabsburgbecomeskingofGermany 1438 1 DE-1\nMagdeburginGermanyseizedbyforcesoftheHolyRomanEmpireunderearlJohannTilly,mostinhabitantsmassacred,one 1631 2 DE-2\nofthebloodiestincidentsoftheThirtyYearsâ€™War\nThecultclassic\"OneMillionYearsB.C.\",starringRaquelWelch,isreleased1stinWestGermany 1966 6 DE-3\nFrenchKingCharlesVIIIoccupiesFlorence 1494 2 FR-1\n1ststeamboat,Pyroscaphe,1struninFrance 1783 3 FR-2\nFrancoisMitterrandbecomespresidentofFrance 1981 7 FR-3\nTheHangulalphabetispublishedinKorea 1446 1 KR-1\n2 KoreaisdividedintoNorthandSouthKoreaalongthe38thparallel 1945 6 KR-2\nNorthKoreablocksaSouthKoreansupplydelegationfromtheKaesongjointindustrialzone 2013 8 KR-3\nBahiaIndependenceDay:theendofPortugueseruleinBrazil,withthefinaldefeatofthePortuguesecrownloyalistsinthe 1823 4 BR-1\nprovinceofBahia\nBeloHorizonte,thefirstplannedcityofBrazil,founded 1897 5 BR-2\nBraziliancourtblocksPresidentMichelTemerfromabolishingRenca,whichwouldopenpartsoftheAmazontomining 2017 9 BR-3\nIndianMutinyagainstrulebytheBritishEastIndiaCompanybeginswiththerevoltoftheSepoysoldiersinMeerut 1857 1 IN-1\nGandhisupportstheAfricanPeopleâ€™sOrganisationsresolutiontodeclarethePrinceofWalesdayofarrivalinSouthAfricaa 1910 4 IN-2\ndayofmourning,inprotestagainsttheSouthAfricaActsdisenfranchisementofIndians,ColouredsandAfricans\nBombattackontraininAssamIndia(27soldierskilled) 1995 7 IN-3\n3 1stItalianParliamentmeetsatTurin 1860 2 IT-1\nKingVictorEmmanuelIIIofItalyabdicatesandissucceededbyhissonUmbertoIIwhoreignsforonly34daysbeforethe 1946 5 IT-2\nmonarchyisabolished\nStormsinItalykillatleast11with75%ofVenicefloodedandtwotornadoesstrikingTerracina 2018 9 IT-3\nEdmundBartoniselectedPrimeMinisterinAustraliaâ€™sfirstparliamentaryelection 1901 3 AU-1\nAustralianChampionshipsWomenâ€™sTennis:BerylPenrosewinsheronlyAustraliansinglestitle;beatsThelmaCoyneLong 1955 6 AU-2\n6-4,6-3\nCricketWorldCup,Melbourne(MCG):AustraliadefeatsfellowhostNewZealandby7wicketstowintheir5thtitle;Playerof 2015 8 AU-3\nSeries:MitchelStarc\nTable6:Threeadditionallyconstructedgroupsusingeventsfromdifferentcountries.\nThe comparison shows that the inference time for TSPRank TSPRank (solver only) TSPRank Rankformer\nincreasesexponentiallywiththenumberofrankingentitiesina 0.6\ngroup.ThisincreaseisprimarilyduetothediscreteTSPsolver,\n0.5\nasindicatedbytheoverlappingblueandredlines.Theblueline\nrepresentsthetimetakenbytheTSPsolver,whiletheredlineshows 0.4\nthetotalinferencetimeforarankinggroup.Whenthegroupsize\nreaches100,approximately99.8%oftheinferencetimeisconsumed 0.3\nbythesolver.Theencodingtimefromtheinputtotheadjacency\n0.2\nmatrixremainssimilartothatofRankformer(purple).\n0.1\n0.0\nE COMPLETESTOCKSRANKINGRESULTS 5 10 30 50 100\nGroup Size\nFORSECTORS\nTable7to16presentsthecomprehensiveresultsforeachsectorin Figure 5: Mean inference time per ranking group for\nNASDAQandNYSEafterfiltering. TSPRankandRankformeronOTD2acrossgroupsizesof5,\n10,30,50,and100.Theblue(TSPRanksolveronly)andred\n(TSPRank)linesoverlapwithminordifferences.\nF MQ2008COMPLETERESULTS\nTable17presentsthedetailedperformanceresultsontheMQ2008\ndatasetacrossdifferentfolds.\nsdnoceS\nnI\nemiT\necnerefnI\n)puorg\nrep(\nTSPRank:BridgingPairwiseandListwiseMethodswithaBilinearTravellingSalesmanModel KDDâ€™25,August3â€“7,2025,Toronto,Canada\nSector Stocks ğœ IRR@1 SR@1 MAP@1 IRR@3 SR@3 MAP@3 IRR@5 SR@5 MAP@5\nComputerManufacturing 5 -0.0521 -0.3767 -1.2666 0.1857 0.1037 0.5894 0.4529 0.2167 1.3724 1.0000\nTransportationServices 5 -0.0185 -0.3402 -1.1114 0.1941 0.2663 1.2239 0.4590 0.1263 0.7757 1.0000\nMedical/DentalInstruments 17 0.0227 -0.1845 -0.2096 0.1055 0.2604 1.2060 0.1519 0.3940 2.0538 0.1922\nProperty-CasualtyInsurers 19 0.0044 -0.3242 -0.5479 0.1055 -0.1942 -0.4679 0.2075 -0.2643 -1.0239 0.2131\nMedicalSpecialities 5 -0.0101 -0.0157 0.0948 0.1814 0.0702 0.4433 0.4902 -0.0402 -0.1500 1.0000\nBiotechnology:BiologicalProducts(NoDiagnosticSubstances) 12 0.0288 0.5664 1.1922 0.1224 0.7839 2.1772 0.2253 0.4882 1.7150 0.3138\nTelecommunicationsEquipment 16 -0.0046 -0.6169 -1.1101 0.1646 -0.2057 -0.4332 0.1718 -0.1449 -0.4478 0.2132\nMedical/NursingServices 6 0.0507 1.0367 1.8435 0.1688 0.7042 2.3042 0.4062 0.4471 1.8070 0.7530\nWaterSupply 9 0.0131 0.2849 1.0457 0.1561 0.2404 1.1933 0.2417 0.2146 1.1336 0.4176\nRealEstateInvestmentTrusts 8 -0.0084 -0.0165 -0.0359 0.1055 0.0948 0.8628 0.2625 0.0099 0.1480 0.4738\nBusinessServices 17 0.0130 0.4041 1.1789 0.1266 0.2231 1.1491 0.1589 0.3422 1.7452 0.1987\nMajorPharmaceuticals 29 0.0008 0.2889 0.7399 0.0970 0.7151 1.4622 0.1273 0.4020 1.2343 0.1419\nFarming/Seeds/Milling 6 0.0227 0.1512 0.7310 0.1688 -0.0104 0.0358 0.3945 0.0634 0.4711 0.7495\nIndustrialSpecialties 11 0.0346 2.0118 4.1591 0.1224 0.7883 2.8012 0.2304 0.4046 2.0223 0.3336\nAirFreight/DeliveryServices 6 -0.0014 -0.0397 0.0735 0.1899 -0.0147 0.0708 0.3680 0.0704 0.4319 0.7407\nElectricalProducts 13 -0.0202 -0.2313 -0.6316 0.0675 -0.0352 -0.0250 0.1517 0.0833 0.5303 0.2264\nTelevisionServices 8 -0.0054 -0.0664 -0.0262 0.1224 -0.1397 -0.4674 0.2876 -0.0528 -0.1493 0.4848\nInvestmentBankers/Brokers/Service 18 0.0195 1.5618 3.0264 0.1899 0.2890 1.8445 0.2187 0.2075 1.3520 0.2438\nCatalog/SpecialtyDistribution 7 0.0210 -0.0168 0.1895 0.1814 0.5484 1.8405 0.3354 0.4288 1.8188 0.5961\nSavingsInstitutions 20 0.0460 0.5287 1.5253 0.1181 0.3299 1.5116 0.1646 0.2436 1.2962 0.1981\nOtherConsumerServices 9 0.0079 -0.0556 0.3305 0.2532 -0.2156 -0.6957 0.2904 -0.0076 0.0782 0.4044\nAutoParts:O.E.M. 6 -0.0104 -0.1260 -0.1430 0.2152 -0.1427 -0.5708 0.3638 0.0074 0.1431 0.7229\nTruckingFreight/CourierServices 11 0.0265 0.6905 1.5795 0.1772 0.4522 1.4994 0.2501 0.5216 1.8957 0.3417\nRadioAndTVBroadcastingAndCommunicationsEquipment 10 -0.0055 0.1535 0.5546 0.0970 0.0259 0.2365 0.2168 0.2805 1.2102 0.3377\nBiotechnology:Electromedical&ElectrotherapeuticApparatus 5 0.0513 1.1212 2.2247 0.2532 0.8664 2.9716 0.5070 0.3760 1.9405 1.0000\nHomeFurnishings 8 0.0303 -0.1578 -0.3445 0.1308 0.1396 0.6085 0.2752 0.1764 0.8462 0.4762\nMajorChemicals 7 -0.0118 -0.3026 -0.8089 0.1730 0.0614 0.3825 0.3291 0.0943 0.6049 0.5455\nOtherSpecialtyStores 8 0.0027 0.4400 1.1201 0.1561 -0.1071 -0.3697 0.2623 0.0242 0.2259 0.4928\nComputerSoftware:Programming,DataProcessing 7 -0.0118 -0.1717 -0.2653 0.2363 0.4192 1.6818 0.3425 0.2852 1.5359 0.5278\nRestaurants 20 -0.0264 -0.4583 -1.2790 0.0464 -0.0233 0.0328 0.1416 -0.0919 -0.3906 0.1653\nAutomotiveAftermarket 6 0.0059 0.0265 0.2472 0.1646 0.1734 0.9593 0.3872 0.2190 1.3142 0.7483\nInvestmentManagers 5 0.0092 0.2662 1.3199 0.2236 0.1422 0.9601 0.4869 0.0976 0.7306 1.0000\nOilRefining/Marketing 6 -0.0132 -0.2807 -1.0433 0.2785 0.1007 0.5836 0.3687 0.1559 0.9894 0.6879\nRealEstate 7 0.0226 0.3281 1.2869 0.1857 0.2733 1.6266 0.3202 0.2303 1.5590 0.6019\nApparel 8 -0.0081 0.0019 0.2242 0.1308 0.3005 1.1491 0.2600 0.1953 0.9464 0.4672\nOil&GasProduction 6 -0.0036 -0.1716 -0.3582 0.1730 -0.3052 -1.1493 0.3697 -0.2423 -0.8614 0.7456\nComputerCommunicationsEquipment 5 -0.0025 0.8757 1.9336 0.2152 0.2596 1.3220 0.4681 0.0383 0.3025 1.0000\nClothing/Shoe/AccessoryStores 8 -0.0153 -0.1938 -0.2218 0.1730 -0.2163 -0.4854 0.2675 -0.0573 -0.0205 0.4725\nCommercialBanks 5 0.0034 0.0180 0.1952 0.1561 0.2602 1.4412 0.5117 0.1656 0.9570 1.0000\nHospital/NursingManagement 5 -0.0244 0.0170 0.3074 0.2278 0.1864 0.9844 0.4473 0.2216 1.3716 1.0000\nBanks 5 0.0689 0.4518 1.8758 0.2194 0.3074 1.6594 0.5326 0.0939 0.6403 1.0000\nProfessionalServices 6 0.0350 -0.2014 -0.6058 0.1646 0.2080 1.1435 0.3901 0.1859 1.1313 0.7501\nPackagedFoods 7 0.0162 -0.0081 0.1270 0.1688 -0.0930 -0.4279 0.3333 -0.0692 -0.3715 0.5875\nMetalFabrications 12 -0.0010 -0.1004 -0.1038 0.1392 0.1738 0.8350 0.2014 0.2037 1.0968 0.2687\nDiversifiedCommercialServices 6 0.0294 0.0471 0.3382 0.2658 0.5017 2.1019 0.4004 0.2662 1.5863 0.7258\nComputerperipheralequipment 6 0.0434 0.3923 1.0476 0.2110 0.2852 1.2401 0.4163 0.2432 1.3341 0.7431\nSteel/IronOre 7 0.0250 0.6945 1.8428 0.1814 0.4356 1.7598 0.3472 0.1355 0.7523 0.5850\nHotels/Resorts 5 0.0471 0.9652 2.2147 0.2405 1.2521 4.3657 0.5136 0.8753 3.8558 1.0000\nBiotechnology:InVitro&InVivoDiagnosticSubstances 5 0.0126 0.3358 0.9351 0.1857 0.5339 1.9262 0.4754 0.4424 2.1666 1.0000\nElectronicComponents 8 0.0081 0.5326 1.3140 0.1350 0.7561 2.3124 0.2850 0.7520 2.7036 0.4646\nAverage 9.12 0.0094 0.1947 0.5341 0.1690 0.2366 0.9881 0.3254 0.1892 0.9682 0.5871\nTable7:Performanceofbaselinemodelproposedin[17]onNASDAQ\nG OTD2COMPLETERESULTS\nTable 18 shows the detailed performance results on the OTD2\ndatasetwithfivedifferentrandomgroupallocations.\nKDDâ€™25,August3â€“7,2025,Toronto,Canada WeixianWaylonLi,YftahZiser,YifeiXie,ShayB.Cohen,andTiejunMa\nSector Stocks ğœ IRR@1 SR@1 MAP@1 IRR@3 SR@3 MAP@3 IRR@5 SR@5 MAP@5\nBiotechnology:LaboratoryAnalyticalInstruments 5 0.0244 0.9165 2.6132 0.2447 0.5556 3.2469 0.4930 0.4553 3.1498 1.0000\nDiversifiedCommercialServices 9 0.0315 1.9463 2.2132 0.2827 1.0483 2.8712 0.3033 0.7726 2.9765 0.3992\nOtherSpecialtyStores 11 -0.0083 -0.2757 -0.4046 0.1350 0.1972 0.7898 0.2220 0.2008 0.9486 0.3136\nInvestmentManagers 18 0.0147 1.2026 3.1766 0.1224 0.7153 3.3275 0.1547 0.5711 3.2101 0.2090\nElectricalProducts 13 0.0021 0.2232 0.7774 0.1266 0.1747 0.9553 0.1699 0.2038 1.2445 0.2505\nMajorPharmaceuticals 18 0.0083 -0.1707 -0.0414 0.1730 -0.1365 -0.3281 0.2218 -0.0340 -0.0488 0.2218\nOtherPharmaceuticals 5 0.0420 0.7478 2.6057 0.2700 0.2195 1.2131 0.4916 0.1719 1.0601 1.0000\nAutomotiveAftermarket 10 0.0289 0.2186 0.8903 0.0717 0.1810 0.7936 0.2117 0.1168 0.5851 0.3680\nPreciousMetals 11 -0.0163 0.6813 1.6358 0.1857 0.0364 0.2783 0.2150 0.0238 0.2233 0.3088\nPublishing 5 0.0151 -0.4553 -1.1204 0.2743 -0.1287 -0.3477 0.4744 -0.1218 -0.5510 1.0000\nMilitary/Government/Technical 11 0.0094 0.3709 1.3192 0.1013 0.2765 1.3624 0.1962 0.1733 1.0585 0.3280\nBusinessServices 22 0.0371 0.8236 2.3041 0.0633 0.5385 2.6426 0.1423 0.6044 3.6581 0.1825\nPackagedFoods 16 0.0130 0.0371 0.3576 0.1055 0.2376 1.1822 0.1892 0.2100 1.2396 0.2425\nLifeInsurance 17 0.0316 0.4408 1.1822 0.1730 0.3049 1.3894 0.1927 0.4008 2.1153 0.2161\nPowerGeneration 15 -0.0011 -0.2409 -1.1783 0.1181 0.0223 0.2317 0.1723 0.0708 0.6655 0.2197\nClothing/Shoe/AccessoryStores 15 0.0175 1.9787 2.2021 0.1097 0.3421 0.9112 0.1711 0.1680 0.6053 0.2362\nMedicalSpecialities 11 0.0526 0.2179 0.7375 0.2194 0.5787 2.5074 0.2525 0.4993 2.7790 0.3406\nProperty-CasualtyInsurers 30 0.0192 0.2673 0.7250 0.1561 0.0009 0.1354 0.1425 0.0476 0.3467 0.1597\nAccident&HealthInsurance 5 -0.0143 0.4029 1.0810 0.2785 0.4239 2.0508 0.4489 0.2645 1.7726 1.0000\nFarming/Seeds/Milling 7 0.0286 0.5901 2.1545 0.2110 0.0935 0.7004 0.3469 0.0952 0.7942 0.5747\nEngineering&Construction 5 0.0126 -0.4365 -0.4714 0.3080 -0.0482 0.0147 0.4684 -0.0339 -0.0130 1.0000\nAerospace 9 0.0033 0.0075 0.2826 0.2110 0.2362 1.0729 0.2651 0.3670 1.9615 0.3881\nIndustrialSpecialties 9 0.0000 1.0994 1.8806 0.2025 0.4923 1.9735 0.2921 0.3469 1.9804 0.3838\nSpecialtyInsurers 6 0.0311 0.4101 2.1419 0.2236 0.3361 2.9795 0.3976 0.3112 3.1113 0.7424\nMajorChemicals 29 0.0367 2.0708 1.9914 0.0591 0.8546 2.3885 0.1067 0.7252 2.8721 0.1438\nIntegratedoilCompanies 19 0.0051 -0.1042 -0.0241 0.1181 0.2789 1.1388 0.1840 0.2697 1.2332 0.2238\nAirFreight/DeliveryServices 8 0.0255 -0.1557 0.0996 0.2152 0.2922 1.1280 0.3223 0.1947 1.0094 0.4667\nAutoParts:O.E.M. 18 0.0028 0.0070 0.1948 0.1308 0.0986 0.5461 0.1505 0.1639 0.8894 0.1828\nMetalFabrications 23 -0.0221 -0.2684 -0.7043 0.0802 -0.1461 -0.4471 0.1493 -0.0714 -0.2014 0.1765\nProfessionalServices 11 0.0264 0.3941 1.4152 0.1181 0.4917 2.3416 0.1934 0.4289 2.3950 0.3339\nConsumerElectronics/Appliances 6 0.0177 0.0551 0.3653 0.2152 0.2219 1.5692 0.3870 0.1651 1.4599 0.7282\nFluidControls 7 0.0054 0.4329 1.2246 0.1899 0.0558 0.3530 0.3397 0.1384 0.7871 0.5731\nOtherConsumerServices 17 0.0035 0.2075 0.6701 0.1350 -0.0566 -0.0291 0.1894 0.0480 0.3380 0.2213\nSteel/IronOre 9 0.0161 1.3380 1.9147 0.1730 0.7475 1.9947 0.2719 0.2903 1.1482 0.4063\nOil/GasTransmission 6 0.0597 0.1326 0.7732 0.1941 0.2167 1.7503 0.4048 0.1632 1.5104 0.7235\nPlasticProducts 6 0.0434 0.5573 1.8102 0.2068 0.2234 1.1718 0.4102 0.2424 1.6670 0.7250\nAgriculturalChemicals 7 -0.0338 -0.0122 0.0616 0.1308 -0.0179 0.0328 0.3043 0.0169 0.1883 0.5500\nContainers/Packaging 9 0.0532 0.3567 1.6435 0.1857 0.4655 2.9107 0.2787 0.3857 2.8297 0.4273\nWaterSupply 7 0.0738 0.7212 1.9706 0.2489 0.6259 2.6691 0.3610 0.5509 2.8809 0.6004\nFinance:ConsumerServices 20 -0.0260 0.2587 0.9367 0.1097 0.3842 1.5753 0.1486 -0.0273 -0.0406 0.1818\nCommercialBanks 21 0.0054 0.2928 1.1736 0.1055 0.4938 2.5922 0.1517 0.4329 2.4692 0.1838\nMedical/DentalInstruments 12 0.0329 0.7236 2.3267 0.1477 0.7127 3.6677 0.2138 0.4851 3.0057 0.3029\nComputerSoftware:PrepackagedSoftware 11 0.0123 -0.2829 -0.3307 0.1941 0.2058 0.8394 0.2593 0.3625 1.6677 0.3238\nOilRefining/Marketing 9 -0.0159 0.1866 0.6283 0.2447 -0.0744 -0.1300 0.2857 -0.1153 -0.5105 0.3784\nHotels/Resorts 10 0.0259 0.7732 3.1388 0.1350 0.5796 3.2348 0.2466 0.4231 2.9367 0.3681\nRestaurants 7 -0.0202 -0.0501 -0.0017 0.1899 -0.1252 -0.5018 0.3136 -0.0738 -0.3704 0.5521\nDepartment/SpecialtyRetailStores 8 -0.0060 -0.1601 -0.1885 0.1603 -0.0338 0.0994 0.3261 -0.0367 -0.0017 0.4595\nMarineTransportation 14 -0.0003 0.6801 1.3866 0.1603 -0.0446 0.0176 0.2203 0.1103 0.5606 0.2719\nEDPServices 11 0.0025 0.4429 1.0640 0.1899 0.0527 0.3354 0.2445 0.0562 0.3661 0.3146\nHospital/NursingManagement 10 -0.0374 0.5054 0.9916 0.1941 -0.0250 0.1177 0.2586 0.0100 0.1850 0.3317\nSavingsInstitutions 6 0.0412 0.5441 2.1445 0.2236 0.3033 1.9788 0.4058 0.1754 1.4319 0.7565\nInvestmentBankers/Brokers/Service 13 -0.0064 0.2290 0.8349 0.1181 -0.0216 -0.0215 0.1873 0.0205 0.2107 0.2678\nMeat/Poultry/Fish 5 -0.0151 -0.2439 -0.6973 0.2743 0.0403 0.3354 0.4512 0.0990 0.8471 1.0000\nBeverages(Production/Distribution) 12 0.0239 0.2351 1.0409 0.1013 0.2266 1.5338 0.2250 0.2515 1.9701 0.2991\nHomebuilding 16 0.0310 1.6988 3.3707 0.1603 0.9321 3.4975 0.1765 1.0189 4.3494 0.2300\nShoeManufacturing 5 0.0429 1.4649 1.9803 0.2658 0.4093 1.3059 0.5056 0.3139 1.3117 1.0000\nConstruction/AgEquipment/Trucks 6 0.0423 0.5257 1.4138 0.1772 0.5199 2.0191 0.3840 0.4947 2.1520 0.7582\nRealEstate 13 0.0009 -0.0317 -0.0225 0.0759 0.1550 1.0338 0.1716 0.1310 1.0304 0.2399\nPackageGoods/Cosmetics 10 -0.0003 -0.0312 0.0688 0.1477 0.0314 0.2598 0.2396 0.2293 1.3812 0.3537\nOilfieldServices/Equipment 8 0.0162 -0.1475 -0.2068 0.1772 -0.3710 -1.2420 0.3026 -0.3021 -1.2370 0.4645\nPaper 8 0.0141 0.6179 1.8996 0.2405 0.2799 1.4098 0.3134 0.1059 0.6770 0.4843\nMining&QuarryingofNonmetallicMinerals(NoFuels) 6 0.0468 -0.0296 0.1624 0.2954 0.0354 0.2772 0.4271 0.0090 0.1427 0.7184\nRailroads 10 -0.0005 0.4472 1.7451 0.1477 0.3417 1.6340 0.2414 0.2757 1.6390 0.3544\nHomeFurnishings 8 0.0309 0.3454 1.1039 0.2025 0.2405 1.0716 0.3136 0.1870 1.0300 0.4658\nApparel 10 -0.0188 -0.5308 -1.3461 0.1603 0.0835 0.4380 0.2529 0.1563 0.7771 0.3381\nOfficeEquipment/Supplies/Services 9 0.0418 0.4468 1.4524 0.1646 -0.0953 -0.3830 0.2719 -0.0194 -0.0141 0.4290\nForestProducts 5 0.0311 0.9493 2.0567 0.2785 0.5285 2.1856 0.4836 0.3948 1.9793 1.0000\nAutoManufacturing 9 0.0282 0.5113 1.4388 0.2152 0.1761 0.9958 0.2564 0.3446 2.0070 0.4000\nServices-Misc.Amusement&Recreation 6 0.0787 0.8940 2.7186 0.2616 0.5470 3.0031 0.4278 0.3861 2.8966 0.7456\nSemiconductors 5 0.0361 1.1884 2.5332 0.2489 0.4766 1.9157 0.4909 0.3035 1.5702 1.0000\nAverage 10.97 0.0162 0.4170 1.0755 0.1791 0.2574 1.2367 0.2841 0.2257 1.3186 0.4649\nTable8:Performanceofbaselinemodelproposedin[17]onNYSE\nTSPRank:BridgingPairwiseandListwiseMethodswithaBilinearTravellingSalesmanModel KDDâ€™25,August3â€“7,2025,Toronto,Canada\nSector Stocks ğœ IRR@1 SR@1 MAP@1 IRR@3 SR@3 MAP@3 IRR@5 SR@5 MAP@5\nComputerManufacturing 5 0.0143 -0.0477 0.0634 0.2658 0.1977 1.0821 0.4838 0.1648 1.0999 1.0000\nTransportationServices 5 0.0303 -0.3902 -1.3876 0.2405 -0.3105 -1.6243 0.4913 0.0701 0.4840 1.0000\nMedical/DentalInstruments 17 0.0164 1.2784 2.6419 0.0591 0.2390 1.0163 0.1275 0.0349 0.2789 0.1781\nProperty-CasualtyInsurers 19 0.0438 -0.4535 -0.9007 0.1392 -0.2711 -1.1097 0.1636 -0.2591 -1.3919 0.1832\nMedicalSpecialities 5 0.0286 -0.3505 -0.5935 0.2321 -0.3086 -1.5448 0.5000 -0.1143 -0.6432 1.0000\nBiotechnology:BiologicalProducts(NoDiagnosticSubstances) 12 0.0167 -0.5780 -0.9332 0.1224 -0.3050 -1.1125 0.1941 -0.1622 -0.6921 0.2982\nTelecommunicationsEquipment 16 -0.0026 -0.7386 -1.5655 0.1435 -0.4117 -1.4491 0.1535 -0.3187 -1.4648 0.1932\nMedical/NursingServices 6 -0.0149 -0.0497 -0.0130 0.2110 0.1909 0.7797 0.3657 0.1880 0.9182 0.7504\nWaterSupply 9 0.0138 -0.2709 -0.4976 0.1181 0.2231 1.0461 0.2353 0.2432 1.2927 0.4097\nRealEstateInvestmentTrusts 8 0.0090 -0.3951 -2.2191 0.1139 -0.0881 -0.5507 0.2759 -0.0085 -0.0022 0.4790\nBusinessServices 17 0.0134 0.7775 1.8770 0.0759 0.1112 0.5812 0.1421 0.2183 1.2653 0.2053\nMajorPharmaceuticals 29 -0.0131 -0.3425 -0.1044 0.0633 0.1920 0.6252 0.1113 0.2564 0.8491 0.1307\nFarming/Seeds/Milling 6 0.0070 -0.2211 -0.6017 0.1435 -0.0610 -0.2920 0.3863 0.0426 0.3586 0.7456\nIndustrialSpecialties 11 0.0141 1.9566 3.0194 0.0844 1.2322 4.2824 0.1960 0.8835 4.1077 0.3188\nAirFreight/DeliveryServices 6 -0.0120 -0.0647 -0.0398 0.1603 -0.1099 -0.4199 0.3741 -0.0872 -0.3385 0.7380\nElectricalProducts 13 0.0040 0.2195 0.7759 0.0802 -0.0645 -0.2118 0.1458 -0.0673 -0.3283 0.2409\nTelevisionServices 8 0.0048 -0.4989 -1.9251 0.1097 -0.3301 -1.6766 0.2724 -0.2817 -1.6943 0.4904\nInvestmentBankers/Brokers/Service 18 0.0049 -0.4233 -1.4110 0.1435 -0.4133 -2.8575 0.1620 -0.2782 -2.1985 0.1965\nCatalog/SpecialtyDistribution 7 0.0018 0.0361 0.3542 0.1392 0.4392 1.4817 0.3129 0.3009 1.3728 0.5969\nSavingsInstitutions 20 0.0073 -0.5940 -2.4198 0.0380 -0.2556 -1.3820 0.0956 -0.1932 -1.1429 0.1436\nOtherConsumerServices 9 0.0184 -0.5178 -1.9858 0.1688 -0.2258 -1.0093 0.2571 -0.0715 -0.3173 0.4181\nAutoParts:O.E.M. 6 0.0048 0.1345 0.5066 0.1730 0.0763 0.4337 0.3884 -0.0166 0.0164 0.7414\nTruckingFreight/CourierServices 11 0.0228 0.0093 0.2164 0.1519 0.0257 0.2385 0.2135 0.0142 0.1851 0.3134\nRadioAndTVBroadcastingAndCommunicationsEquipment 10 -0.0251 1.3940 2.4058 0.1139 0.5622 1.8837 0.2053 0.4707 1.9249 0.3386\nBiotechnology:Electromedical&ElectrotherapeuticApparatus 5 -0.0219 0.3264 1.1313 0.1646 0.5856 2.5303 0.4655 0.3959 2.0268 1.0000\nHomeFurnishings 8 0.0183 -0.7652 -2.4810 0.1308 -0.4145 -1.7633 0.2893 -0.2704 -1.3645 0.4916\nMajorChemicals 7 0.0006 0.4466 1.4170 0.1308 -0.1249 -0.6651 0.3113 -0.1602 -0.9885 0.5976\nOtherSpecialtyStores 8 -0.0114 -0.6167 -2.5278 0.1392 -0.3897 -2.4056 0.2696 -0.2322 -1.4418 0.4623\nComputerSoftware:Programming,DataProcessing 7 -0.0158 0.1778 0.6673 0.2025 0.0463 0.3354 0.3059 0.1507 0.9838 0.5630\nRestaurants 20 -0.0096 -0.3113 -1.1495 0.0675 -0.2282 -1.0070 0.1078 -0.1540 -0.7702 0.1484\nAutomotiveAftermarket 6 -0.0081 -0.1409 -0.4848 0.1646 0.0733 0.4952 0.3854 0.0569 0.4265 0.7266\nInvestmentManagers 5 -0.0412 -0.0107 0.1591 0.1899 0.0263 0.2434 0.4667 0.0409 0.3532 1.0000\nOilRefining/Marketing 6 0.0143 0.6837 1.9976 0.1266 0.2552 1.4019 0.3999 0.0009 0.0929 0.7491\nRealEstate 7 0.0154 0.2837 1.1850 0.1181 0.1146 0.7490 0.3291 0.2638 1.7563 0.5990\nApparel 8 -0.0267 -0.1962 -0.4159 0.1435 -0.2422 -1.1042 0.2485 -0.3126 -1.7706 0.4580\nOil&GasProduction 6 -0.0177 0.0560 0.3511 0.1603 -0.1765 -0.4981 0.3704 -0.2671 -1.0112 0.7382\nComputerCommunicationsEquipment 5 0.0395 0.3573 1.1938 0.2405 0.1316 0.8054 0.5035 0.0113 0.1607 1.0000\nClothing/Shoe/AccessoryStores 8 0.0252 -0.5559 -1.6409 0.1519 -0.5269 -2.1383 0.2799 -0.3526 -1.4378 0.4914\nCommercialBanks 5 0.0580 -0.1046 -0.2805 0.2236 0.0350 0.2759 0.4944 0.1142 0.7075 1.0000\nHospital/NursingManagement 5 0.0092 -0.0562 -0.0759 0.2405 0.1333 0.7221 0.4655 0.1524 0.9918 1.0000\nBanks 5 0.0059 -0.2917 -1.6896 0.2025 -0.1515 -0.9863 0.4880 0.1027 0.6914 1.0000\nProfessionalServices 6 0.0188 -0.5588 -2.1915 0.1224 -0.4077 -2.9101 0.3978 0.0101 0.1476 0.7492\nPackagedFoods 7 0.0154 1.0455 2.4185 0.1688 0.2836 1.3385 0.3228 -0.0336 -0.1327 0.5925\nMetalFabrications 12 0.0239 1.4819 2.5295 0.1139 0.9541 2.9503 0.1934 0.2094 1.0487 0.2905\nDiversifiedCommercialServices 6 0.0048 -0.5072 -1.6332 0.2321 -0.0854 -0.3199 0.3924 0.2212 1.3537 0.7200\nComputerperipheralequipment 6 0.0546 1.0655 2.2080 0.1983 0.1955 0.9741 0.4048 0.1572 0.9538 0.7455\nSteel/IronOre 7 0.0054 -0.2630 -0.6538 0.1688 -0.0995 -0.3004 0.3380 -0.0112 0.0507 0.5844\nHotels/Resorts 5 -0.0235 -0.1496 -0.4177 0.2152 0.2568 1.2714 0.4735 0.6803 3.0630 1.0000\nBiotechnology:InVitro&InVivoDiagnosticSubstances 5 0.0454 -0.2929 -0.5666 0.2278 0.5973 2.0998 0.5101 0.3823 1.9659 1.0000\nElectronicComponents 8 -0.0312 0.5785 1.3210 0.1603 0.5248 1.9204 0.2548 0.3378 1.5919 0.4711\nAverage 9.12 0.0071 0.0310 -0.0873 0.1539 0.0340 0.0445 0.3144 0.0505 0.2678 0.5858\nTable9:CompleteresulttableforLambdaMARTonNASDAQ.\nKDDâ€™25,August3â€“7,2025,Toronto,Canada WeixianWaylonLi,YftahZiser,YifeiXie,ShayB.Cohen,andTiejunMa\nSector Stocks ğœ IRR@1 SR@1 MAP@1 IRR@3 SR@3 MAP@3 IRR@5 SR@5 MAP@5\nBiotechnology:LaboratoryAnalyticalInstruments 5 0.0000 0.6418 3.0829 0.1899 0.4841 3.4649 0.4970 0.4841 3.4492 1.0000\nDiversifiedCommercialServices 9 0.0128 1.5345 2.2816 0.1983 0.6707 2.3281 0.2647 0.4743 2.2261 0.4146\nOtherSpecialtyStores 11 0.0016 -0.4049 -0.7317 0.1435 -0.2758 -0.8344 0.2161 -0.1138 -0.3821 0.3255\nInvestmentManagers 18 0.0280 -0.0565 -0.0769 0.0970 0.2047 1.1636 0.1484 0.3683 2.2241 0.1888\nElectricalProducts 13 0.0080 -0.0764 -0.2386 0.1055 -0.0166 -0.0226 0.1578 0.0685 0.5614 0.2450\nMajorPharmaceuticals 18 0.0318 0.7983 1.4109 0.1308 0.1837 0.8006 0.1835 0.1154 0.6883 0.2122\nOtherPharmaceuticals 5 -0.0143 -0.0489 -0.0297 0.2025 -0.0429 -0.1446 0.4712 0.1293 0.8351 1.0000\nAutomotiveAftermarket 10 0.0268 0.3631 1.0532 0.0886 -0.0249 0.0486 0.2075 -0.0197 0.0353 0.3614\nPreciousMetals 11 0.0147 -0.2612 -0.9794 0.1139 -0.2128 -1.0622 0.2063 0.0052 0.1263 0.3314\nPublishing 5 0.0479 -0.0885 -0.1322 0.2447 -0.0158 0.0293 0.5084 -0.1535 -0.7639 1.0000\nMilitary/Government/Technical 11 -0.0206 0.3135 1.2221 0.1181 0.2572 1.3468 0.1880 0.2948 1.7646 0.2961\nBusinessServices 22 0.0118 -0.2033 -1.0205 0.0844 -0.3400 -2.8763 0.1045 -0.2780 -2.4584 0.1312\nPackagedFoods 16 0.0146 -0.0450 -0.0991 0.0675 -0.1055 -0.6338 0.1153 -0.0492 -0.3276 0.1915\nLifeInsurance 17 0.0013 0.4844 2.2569 0.0338 0.9186 5.5226 0.1235 0.7000 4.8547 0.1734\nPowerGeneration 15 0.0001 0.4149 1.4183 0.1055 0.1330 1.0341 0.1486 0.0962 0.9612 0.2192\nClothing/Shoe/AccessoryStores 15 -0.0152 -0.3638 -1.1112 0.0802 -0.5180 -2.2291 0.1378 -0.4522 -1.8764 0.1949\nMedicalSpecialities 11 0.0163 0.1157 0.9983 0.0549 0.0511 0.5236 0.2002 0.0434 0.4638 0.3105\nProperty-CasualtyInsurers 30 -0.0150 -0.3339 -1.8750 0.0253 -0.2293 -1.7631 0.0539 -0.1881 -1.6600 0.0851\nAccident&HealthInsurance 5 0.0193 0.0647 0.3770 0.2658 0.1197 0.8376 0.4862 0.2289 1.5754 1.0000\nFarming/Seeds/Milling 7 0.0210 -0.2092 -1.0287 0.1730 -0.0773 -0.5290 0.3408 -0.0765 -0.6195 0.5825\nEngineering&Construction 5 -0.0286 -0.6108 -1.9237 0.2236 -0.3614 -1.7340 0.4709 -0.0749 -0.2026 1.0000\nAerospace 9 0.0138 -0.0585 -0.0292 0.1435 0.2664 1.3216 0.2480 0.2080 1.3286 0.4100\nIndustrialSpecialties 9 -0.0093 0.2417 0.7658 0.1308 0.3355 1.7741 0.2419 0.4916 2.9676 0.3970\nSpecialtyInsurers 6 0.0132 0.0248 0.2510 0.1772 0.1812 1.7888 0.3905 0.1476 1.5814 0.7401\nMajorChemicals 29 -0.0014 0.9222 2.1943 0.0633 0.2557 1.3246 0.0759 0.2242 1.4245 0.1104\nIntegratedoilCompanies 19 0.0107 0.1442 0.6068 0.1181 0.2332 1.1554 0.1397 0.2060 1.1236 0.1846\nAirFreight/DeliveryServices 8 0.0123 0.5049 1.8273 0.1603 -0.0349 -0.0056 0.3019 -0.0296 -0.0516 0.4711\nAutoParts:O.E.M. 18 -0.0036 0.3236 1.1766 0.0633 0.3508 1.5749 0.1041 0.4035 1.9846 0.1615\nMetalFabrications 23 0.0044 0.2061 0.7621 0.0844 0.4328 1.6071 0.1085 0.2989 1.3637 0.1329\nProfessionalServices 11 -0.0002 0.0308 0.2546 0.1392 0.1195 0.7118 0.2135 0.1413 0.9830 0.3149\nConsumerElectronics/Appliances 6 0.0244 0.4636 1.7942 0.1899 0.3072 2.2109 0.3929 0.1913 1.7115 0.7528\nFluidControls 7 0.0094 -0.2719 -0.7571 0.1435 0.0033 0.1266 0.3298 0.0295 0.2601 0.5846\nOtherConsumerServices 17 0.0155 -0.1323 0.0756 0.1097 -0.2485 -0.9130 0.1418 -0.0400 -0.0941 0.1920\nSteel/IronOre 9 0.0121 0.1835 0.5921 0.1266 0.2446 0.8770 0.2471 0.2832 1.1043 0.4234\nOil/GasTransmission 6 -0.0165 0.0695 0.5316 0.1477 0.1606 1.4076 0.3868 0.1223 1.2065 0.7418\nPlasticProducts 6 -0.0003 -0.1394 -0.2104 0.1814 0.0448 0.3587 0.3715 0.2178 1.5464 0.7333\nAgriculturalChemicals 7 0.0262 -0.1353 -0.3462 0.1561 0.1867 0.9687 0.3371 0.0902 0.6374 0.5874\nContainers/Packaging 9 0.0100 0.4112 2.4134 0.1013 0.2591 2.1785 0.2278 0.2204 1.9453 0.4089\nWaterSupply 7 0.0302 -0.3861 -1.7638 0.1814 -0.1310 -0.6964 0.3469 0.0101 0.1464 0.5939\nFinance:ConsumerServices 20 0.0096 0.9553 2.8125 0.0422 0.5232 2.5844 0.1184 0.2217 1.4814 0.1665\nCommercialBanks 21 0.0075 0.1036 0.5447 0.0506 0.4271 2.3475 0.1055 0.4649 3.0711 0.1418\nMedical/DentalInstruments 12 0.0127 -0.2963 -1.7528 0.1139 -0.2316 -2.0540 0.1707 -0.2241 -2.1604 0.2663\nComputerSoftware:PrepackagedSoftware 11 0.0120 -0.4054 -1.0410 0.0802 -0.0426 -0.0959 0.1878 0.0912 0.6130 0.3252\nOilRefining/Marketing 9 0.0049 -0.4859 -1.2104 0.0759 -0.2478 -1.1750 0.2351 -0.2189 -1.3731 0.4055\nHotels/Resorts 10 -0.0106 -0.1800 -0.6967 0.1224 -0.0396 -0.1907 0.2023 0.1254 0.9986 0.3454\nRestaurants 7 -0.0126 -0.4359 -2.0032 0.1519 -0.0917 -0.5576 0.3139 -0.0712 -0.4825 0.5702\nDepartment/SpecialtyRetailStores 8 0.0051 0.0043 0.2435 0.1857 -0.1060 -0.1541 0.3040 -0.1186 -0.3509 0.4650\nMarineTransportation 14 0.0335 -0.2724 -0.6564 0.0970 -0.2722 -1.0105 0.1756 -0.1424 -0.6389 0.2513\nEDPServices 11 -0.0057 -0.1577 -0.4264 0.1055 0.1571 0.9432 0.1845 0.2683 1.5957 0.2959\nHospital/NursingManagement 10 0.0193 4.2295 3.5191 0.1097 0.8279 2.2462 0.2389 0.5408 1.9074 0.3636\nSavingsInstitutions 6 0.0205 -0.0950 -0.5292 0.1730 0.0393 0.3589 0.4001 0.0866 0.7941 0.7442\nInvestmentBankers/Brokers/Service 13 -0.0240 0.2734 1.0000 0.0802 0.0255 0.2335 0.1606 -0.0393 -0.1499 0.2442\nMeat/Poultry/Fish 5 -0.0135 -0.0616 -0.1277 0.2363 0.1429 1.0507 0.4669 0.1074 0.9181 1.0000\nBeverages(Production/Distribution) 12 0.0299 -0.1384 -0.6496 0.0802 -0.0516 -0.3698 0.1929 -0.0390 -0.3551 0.2900\nHomebuilding 16 0.0151 -0.2566 -1.3115 0.0759 0.0165 0.1893 0.1428 0.0038 0.1021 0.2014\nShoeManufacturing 5 0.0361 -0.3162 -0.5245 0.2236 -0.1060 -0.2621 0.5164 0.2378 1.0544 1.0000\nConstruction/AgEquipment/Trucks 6 -0.0373 0.1895 0.7694 0.1857 0.3942 1.5671 0.3788 0.4011 1.8141 0.7335\nRealEstate 13 -0.0286 -0.6280 -3.5603 0.0802 -0.3128 -2.2656 0.1423 -0.1233 -0.9755 0.2367\nPackageGoods/Cosmetics 10 -0.0092 -0.0532 -0.0795 0.1013 0.1455 1.1054 0.2028 0.1955 1.6992 0.3396\nOilfieldServices/Equipment 8 -0.0315 -0.2869 -0.8246 0.1181 -0.4142 -1.9334 0.2386 -0.3447 -1.6829 0.4587\nPaper 8 0.0141 -0.2248 -0.8357 0.1266 -0.1451 -0.7288 0.2860 0.0000 0.0900 0.4747\nMining&QuarryingofNonmetallicMinerals(NoFuels) 6 0.0389 2.0392 4.2855 0.1730 0.5500 2.5453 0.3837 0.1273 0.8274 0.7666\nRailroads 10 -0.0085 0.1485 0.6666 0.1055 0.1695 1.0637 0.1922 0.1236 0.9389 0.3336\nHomeFurnishings 8 0.0165 -0.3182 -0.7994 0.1477 -0.0887 -0.3797 0.2792 -0.0377 -0.1389 0.4869\nApparel 10 -0.0281 -0.4196 -0.8942 0.1350 -0.1056 -0.3244 0.2353 0.0245 0.2272 0.3297\nOfficeEquipment/Supplies/Services 9 0.0301 0.1822 0.7178 0.1392 -0.0653 -0.1916 0.2836 -0.0758 -0.3325 0.4270\nForestProducts 5 -0.0185 0.0951 0.5010 0.1983 0.2182 1.1585 0.4662 0.3766 1.8965 1.0000\nAutoManufacturing 9 -0.0187 0.1151 0.5711 0.1055 0.0523 0.4158 0.2260 0.0694 0.5413 0.3996\nServices-Misc.Amusement&Recreation 6 0.0182 -0.2761 -1.3759 0.1899 0.0169 0.1929 0.4046 0.1916 1.5817 0.7536\nSemiconductors 5 -0.0118 -0.4208 -1.7579 0.1730 -0.0284 -0.0098 0.4759 0.4026 2.0180 1.0000\nAverage 10.97 0.0054 0.1005 0.1367 0.1307 0.0732 0.4192 0.2593 0.1063 0.6882 0.4574\nTable10:CompleteresulttableforLambdaMARTonNYSE.\nTSPRank:BridgingPairwiseandListwiseMethodswithaBilinearTravellingSalesmanModel KDDâ€™25,August3â€“7,2025,Toronto,Canada\nSector Stocks ğœ IRR@1 SR@1 MAP@1 IRR@3 SR@3 MAP@3 IRR@5 SR@5 MAP@5\nComputerManufacturing 5 -0.0244 -0.0458 0.0585 0.2110 0.2554 1.1537 0.4627 0.2167 1.3724 1.0000\nTransportationServices 5 -0.0193 -0.3402 -1.1114 0.1941 0.2787 1.2932 0.4557 0.1263 0.7757 1.0000\nMedical/DentalInstruments 17 0.0492 0.1590 0.6044 0.1055 0.6454 2.2254 0.1592 0.6764 2.7925 0.2023\nProperty-CasualtyInsurers 19 0.0136 0.1661 0.6221 0.0928 -0.0236 0.0176 0.1306 -0.1705 -0.7351 0.1768\nMedicalSpecialities 5 0.0336 -0.0239 0.1681 0.2405 0.2459 1.1755 0.4768 -0.0402 -0.1500 1.0000\nBiotechnology:BiologicalProducts(NoDiagnosticSubstances) 12 0.0395 1.4993 2.0935 0.1519 1.4277 3.3088 0.2429 0.5337 1.8510 0.3092\nTelecommunicationsEquipment 16 -0.0179 -0.7585 -1.6430 0.1688 -0.2981 -0.7723 0.1779 -0.1275 -0.3238 0.2197\nMedical/NursingServices 6 -0.0311 0.1104 0.4698 0.1561 0.3651 1.4513 0.3659 0.3374 1.5209 0.7409\nWaterSupply 9 0.0574 0.4483 1.3802 0.2068 0.5629 2.3886 0.2843 0.3641 1.8486 0.4219\nRealEstateInvestmentTrusts 8 -0.0132 0.0069 0.1270 0.0844 -0.0191 -0.0712 0.2595 -0.0638 -0.4460 0.4922\nBusinessServices 17 0.0253 0.4529 1.0647 0.1392 0.5424 1.9924 0.1655 0.6901 2.8825 0.2158\nMajorPharmaceuticals 29 0.0079 -0.1586 -0.0520 0.0506 0.3816 0.8635 0.1174 0.5645 1.3108 0.1410\nFarming/Seeds/Milling 6 0.0216 0.3578 1.1610 0.1899 0.1054 0.6186 0.3685 0.1074 0.7423 0.7387\nIndustrialSpecialties 11 0.0355 2.0407 2.9100 0.0886 1.1427 3.4837 0.2028 0.8774 3.5009 0.3327\nAirFreight/DeliveryServices 6 0.0008 0.0305 0.2780 0.1983 -0.0337 -0.0015 0.3706 0.0795 0.4713 0.7377\nElectricalProducts 13 0.0238 0.7368 1.5589 0.0675 0.5567 1.8610 0.1782 0.7503 2.7229 0.2683\nTelevisionServices 8 -0.0102 -0.1655 -0.3784 0.1266 -0.1655 -0.5383 0.2979 -0.1354 -0.5403 0.4825\nInvestmentBankers/Brokers/Service 18 0.0182 0.9022 2.0099 0.1688 0.1769 1.1874 0.2114 0.1941 1.2786 0.2410\nCatalog/SpecialtyDistribution 7 0.0354 0.2672 0.7606 0.1435 0.7167 1.8853 0.3401 0.5044 1.9389 0.5866\nSavingsInstitutions 20 0.0530 0.5454 1.5980 0.1224 0.2679 1.2659 0.1615 0.2020 1.1164 0.1943\nOtherConsumerServices 9 -0.0166 -0.0931 -0.2221 0.1055 0.1196 0.7069 0.2257 0.1118 0.7043 0.3956\nAutoParts:O.E.M. 6 0.0345 -0.1027 -0.3203 0.1055 -0.0189 0.0618 0.3987 -0.0246 -0.0228 0.7652\nTruckingFreight/CourierServices 11 0.0244 0.4114 0.9919 0.1899 0.4502 1.3182 0.2658 0.4701 1.4809 0.3332\nRadioAndTelevisionBroadcastingAndCommunicationsEquipment 10 0.0109 -0.0742 -0.1502 0.0633 0.1295 0.7907 0.1845 -0.0134 0.0003 0.3628\nBiotechnology:Electromedical&ElectrotherapeuticApparatus 5 0.0496 1.1587 2.2743 0.2532 0.8958 3.0769 0.5075 0.3760 1.9405 1.0000\nHomeFurnishings 8 0.0285 -0.2161 -0.4893 0.1435 -0.0517 -0.0146 0.2785 0.0614 0.3821 0.4723\nMajorChemicals 7 -0.0138 -0.2516 -0.6296 0.1772 0.1080 0.5532 0.3317 0.0866 0.5661 0.5419\nOtherSpecialtyStores 8 -0.0180 -0.3415 -0.4555 0.2110 -0.2925 -0.7834 0.2745 -0.0670 -0.1054 0.4397\nComputerSoftware:Programming,DataProcessing 7 -0.0158 -0.1693 -0.2412 0.2194 0.1802 0.8314 0.3338 0.3037 1.6221 0.5186\nRestaurants 20 -0.0124 -0.3350 -0.8094 0.0380 0.1699 0.7861 0.1470 0.1158 0.6462 0.1718\nAutomotiveAftermarket 6 0.0675 0.9524 2.4494 0.2489 0.3451 1.5889 0.4456 0.2365 1.3197 0.7386\nInvestmentManagers 5 -0.0479 -0.0173 -0.0278 0.1308 0.0694 0.4809 0.4447 0.0976 0.7306 1.0000\nOilRefining/Marketing 6 -0.0177 -0.2807 -1.0433 0.2785 0.0871 0.5231 0.3664 0.1192 0.7835 0.6866\nRealEstate 7 0.0346 0.0248 0.2712 0.1435 0.3611 1.8716 0.3226 0.3814 2.2677 0.6013\nApparel 8 -0.0126 -0.1179 -0.4358 0.1055 -0.0198 0.0517 0.2583 0.1292 0.7542 0.4581\nOil&GasProduction 6 -0.0317 -0.3547 -0.9233 0.1688 -0.3303 -1.1890 0.3507 -0.3033 -1.1135 0.7115\nComputerCommunicationsEquipment 5 0.0084 1.4289 2.4003 0.2405 0.3316 1.4066 0.4632 0.0383 0.3025 1.0000\nClothing/Shoe/AccessoryStores 8 -0.0123 -0.3926 -0.7858 0.1435 -0.1718 -0.3006 0.2778 -0.0946 -0.1198 0.4774\nCommercialBanks 5 0.0008 0.2494 0.8646 0.2236 0.2425 1.0891 0.4749 0.1656 0.9570 1.0000\nHospital/NursingManagement 5 0.0168 0.4520 1.3993 0.2194 0.5566 2.6969 0.5056 0.2216 1.3716 1.0000\nBanks 5 0.0975 0.4188 1.6950 0.2194 0.3821 1.9376 0.5333 0.0939 0.6403 1.0000\nProfessionalServices 6 0.0367 -0.1459 -0.4075 0.1646 0.2578 1.3598 0.3896 0.2896 1.7259 0.7525\nPackagedFoods 7 0.0262 -0.0358 0.0393 0.1561 0.0106 0.1580 0.3479 0.0664 0.4664 0.5737\nMetalFabrications 12 0.0107 0.8319 1.7550 0.1266 0.3500 1.3203 0.2131 0.4291 1.7411 0.2848\nDiversifiedCommercialServices 6 0.0451 0.1541 0.5682 0.2743 0.5603 2.3008 0.4030 0.3485 2.0433 0.7311\nComputerperipheralequipment 6 0.0076 0.2860 0.8418 0.2152 0.4543 1.7633 0.3826 0.3222 1.6209 0.7227\nSteel/IronOre 7 -0.0190 -0.2737 -0.9245 0.1097 -0.1345 -0.4884 0.2989 -0.0798 -0.2852 0.5987\nHotels/Resorts 5 -0.0109 0.5641 2.9180 0.1646 0.9370 3.6587 0.4780 0.8753 3.8558 1.0000\nBiotechnology:InVitro&InVivoDiagnosticSubstances 5 -0.0151 0.9486 2.0263 0.2110 0.4172 1.5755 0.4665 0.4424 2.1666 1.0000\nElectronicComponents 8 -0.0069 0.3731 1.0121 0.1392 0.7566 2.3061 0.2789 0.6594 2.3433 0.4611\nAverage 9.12 0.0110 0.2257 0.5464 0.1620 0.2857 1.1245 0.3216 0.2309 1.0943 0.5860\nTable11:CompleteresulttableforRankformeronNASDAQ.\nKDDâ€™25,August3â€“7,2025,Toronto,Canada WeixianWaylonLi,YftahZiser,YifeiXie,ShayB.Cohen,andTiejunMa\nSector Stocks ğœ IRR@1 SR@1 MAP@1 IRR@3 SR@3 MAP@3 IRR@5 SR@5 MAP@5\nBiotechnology:LaboratoryAnalyticalInstruments 5 -0.0025 0.6902 2.1537 0.1983 0.5843 3.4616 0.4698 0.4553 3.1498 1.0000\nDiversifiedCommercialServices 9 0.0367 1.4739 1.9763 0.2405 1.0969 2.9188 0.3043 0.8108 3.0485 0.4004\nOtherSpecialtyStores 11 0.0059 -0.1341 -0.0301 0.1519 0.3229 1.1175 0.2370 0.0706 0.4060 0.3223\nInvestmentManagers 18 0.0376 0.7707 2.4018 0.1139 0.6134 3.1095 0.1526 0.5251 3.1464 0.2086\nElectricalProducts 13 0.0253 0.5033 1.4703 0.1097 0.1957 1.1061 0.1695 0.3724 2.1064 0.2651\nMajorPharmaceuticals 18 0.0117 -0.1838 -0.0680 0.1772 -0.1492 -0.3752 0.2199 0.0132 0.1763 0.2236\nOtherPharmaceuticals 5 -0.0034 0.3746 1.4293 0.2405 0.1998 1.1667 0.4583 0.1719 1.0601 1.0000\nAutomotiveAftermarket 10 0.0421 0.1357 0.6239 0.0591 0.2499 0.9958 0.2112 0.2311 0.9409 0.3905\nPreciousMetals 11 -0.0154 -0.2354 -0.4765 0.1646 -0.1428 -0.5177 0.1969 -0.0027 0.0953 0.3068\nPublishing 5 -0.0160 0.0131 0.1672 0.1013 -0.0435 -0.1085 0.4831 -0.1218 -0.5510 1.0000\nMilitary/Government/Technical 11 0.0274 0.3260 1.0909 0.1181 0.2801 1.3298 0.1887 0.2861 1.5777 0.3309\nBusinessServices 22 0.0470 0.5503 1.6952 0.0675 0.6726 3.2061 0.1472 0.6842 4.0307 0.1781\nPackagedFoods 16 0.0202 0.0653 0.4200 0.1097 0.3028 1.2772 0.1920 0.2975 1.5563 0.2549\nLifeInsurance 17 0.0321 0.7816 1.8057 0.1814 0.3132 1.4290 0.1920 0.3749 1.9991 0.2148\nPowerGeneration 15 0.0293 0.0506 0.3164 0.1097 0.1053 0.7563 0.1774 0.1561 1.3379 0.2333\nClothing/Shoe/AccessoryStores 15 0.0225 0.6554 1.1923 0.0759 0.1537 0.5621 0.1535 0.1204 0.5030 0.2334\nMedicalSpecialities 11 0.0630 0.1184 0.5023 0.2236 0.5825 2.4361 0.2487 0.5778 3.0334 0.3436\nProperty-CasualtyInsurers 30 0.0222 0.3422 0.8457 0.1561 0.0831 0.4595 0.1430 0.0884 0.5538 0.1626\nAccident&HealthInsurance 5 0.0160 0.2131 1.1893 0.1899 0.2929 1.9963 0.4965 0.2645 1.7726 1.0000\nFarming/Seeds/Milling 7 0.0458 0.7947 2.8643 0.2110 0.1444 0.9477 0.3516 0.0944 0.7830 0.5795\nEngineering&Construction 5 -0.0177 -0.0470 -0.0562 0.1857 0.0668 0.4253 0.4752 -0.0339 -0.0130 1.0000\nAerospace 9 0.0070 0.0075 0.2826 0.2110 0.2110 0.9805 0.2700 0.3692 1.9613 0.3847\nIndustrialSpecialties 9 0.0233 0.5945 1.2360 0.1814 0.4902 1.9122 0.2867 0.4382 2.3662 0.3906\nSpecialtyInsurers 6 0.0266 0.2417 1.9522 0.1772 0.2524 2.3140 0.4182 0.1542 1.5739 0.7641\nMajorChemicals 29 0.0385 0.7861 2.3038 0.0506 0.9033 2.5378 0.1083 0.9413 3.3278 0.1439\nIntegratedoilCompanies 19 0.0030 -0.1368 -0.1112 0.1181 0.3038 1.2159 0.1861 0.2780 1.2721 0.2256\nAirFreight/DeliveryServices 8 -0.0264 -0.1159 -0.4758 0.1224 0.0035 0.1200 0.2447 0.0342 0.2842 0.5034\nAutoParts:O.E.M. 18 0.0093 -0.0773 -0.1814 0.0169 0.1225 0.6453 0.1027 0.2304 1.2174 0.1590\nMetalFabrications 23 0.0315 0.4166 1.2780 0.0464 0.2232 1.1539 0.0748 0.3343 1.8060 0.1225\nProfessionalServices 11 0.0424 0.3269 1.2574 0.0928 0.7564 3.3393 0.2011 0.4197 2.2984 0.3334\nConsumerElectronics/Appliances 6 0.0143 -0.0331 -0.0448 0.2236 0.1965 1.3905 0.3849 0.1815 1.6288 0.7276\nFluidControls 7 0.0046 0.2013 0.8376 0.1308 0.0164 0.1977 0.3425 0.1301 0.7341 0.5530\nOtherConsumerServices 17 0.0112 -0.1938 -0.3318 0.1055 0.0592 0.3613 0.1786 0.0714 0.4484 0.2146\nSteel/IronOre 9 0.0063 0.4187 0.9607 0.1308 0.4679 1.4640 0.2604 0.3296 1.2657 0.4055\nOil/GasTransmission 6 0.0429 0.0450 0.3377 0.1772 0.1682 1.3444 0.4004 0.1402 1.2989 0.7125\nPlasticProducts 6 0.0445 0.5481 1.7984 0.1983 0.2097 1.1128 0.4119 0.2402 1.6555 0.7280\nAgriculturalChemicals 7 -0.0274 -0.1482 -0.5050 0.1139 0.0579 0.3661 0.3099 0.0235 0.2252 0.5530\nContainers/Packaging 9 0.0560 0.3614 1.6604 0.1857 0.4993 3.0729 0.2811 0.4182 3.0827 0.4291\nWaterSupply 7 0.0434 0.3842 1.2216 0.2321 0.4928 2.1438 0.3462 0.5040 2.6645 0.5847\nFinance:ConsumerServices 20 0.0222 -0.0371 0.0167 0.0928 0.3712 1.6133 0.1367 0.3801 1.8747 0.1840\nCommercialBanks 21 0.0191 0.1958 0.9104 0.0759 0.2458 1.3927 0.1327 0.2432 1.5127 0.1786\nMedical/DentalInstruments 12 0.0359 0.9956 3.0300 0.1139 0.7530 3.7000 0.2131 0.6578 3.9586 0.3012\nComputerSoftware:PrepackagedSoftware 11 0.0051 0.3920 1.8192 0.0802 0.3935 2.3690 0.1770 0.3880 2.4915 0.2962\nOilRefining/Marketing 9 -0.0131 -0.0392 0.2148 0.2194 -0.0582 -0.0842 0.2806 -0.1034 -0.4494 0.3798\nHotels/Resorts 10 0.0302 0.5783 2.1517 0.1603 0.4510 2.6568 0.2363 0.4765 3.1656 0.3614\nRestaurants 7 -0.0250 -0.0055 0.1315 0.1941 -0.1752 -0.7641 0.3181 -0.0880 -0.4705 0.5514\nDepartment/SpecialtyRetailStores 8 -0.0093 -0.0487 -0.6587 0.1181 0.0553 0.4820 0.2581 0.1323 0.9452 0.5083\nMarineTransportation 14 -0.0028 0.3115 0.8296 0.1561 -0.0475 0.0074 0.2211 0.1118 0.5671 0.2705\nEDPServices 11 0.0016 0.3955 0.9938 0.1857 0.2148 0.8664 0.2482 0.0830 0.4807 0.3157\nHospital/NursingManagement 10 0.0094 0.3321 1.0789 0.1139 0.0799 0.4927 0.2016 0.0709 0.4200 0.3503\nSavingsInstitutions 6 0.0233 0.5687 2.2148 0.1983 0.2700 1.7638 0.4015 0.1603 1.3813 0.7545\nInvestmentBankers/Brokers/Service 13 -0.0005 0.2942 1.0115 0.1181 0.0082 0.1411 0.1854 0.0205 0.2107 0.2678\nMeat/Poultry/Fish 5 -0.0143 -0.2439 -0.6973 0.2743 0.0873 0.6218 0.4543 0.0990 0.8471 1.0000\nBeverages(Production/Distribution) 12 0.0192 0.1427 0.6925 0.1055 0.2875 1.9098 0.2288 0.2508 1.9447 0.2990\nHomebuilding 16 0.0415 1.1992 2.3832 0.1139 0.9380 3.1958 0.1707 1.1283 4.2944 0.2342\nShoeManufacturing 5 0.0387 0.8778 1.4294 0.2110 0.5701 1.6533 0.5089 0.3139 1.3117 1.0000\nConstruction/AgEquipment/Trucks 6 0.0457 0.7575 1.8814 0.1730 0.4618 1.8972 0.3821 0.5135 2.2277 0.7643\nRealEstate 13 0.0035 -0.0317 -0.0225 0.0759 0.1757 1.1769 0.1742 0.1773 1.3251 0.2446\nPackageGoods/Cosmetics 10 0.0098 -0.0312 0.0688 0.1477 0.0474 0.3356 0.2410 0.2505 1.5186 0.3546\nOilfieldServices/Equipment 8 -0.0069 -0.4508 -0.9192 0.2321 -0.1833 -0.5156 0.2717 -0.2205 -0.8215 0.4629\nPaper 8 0.0150 0.6198 1.8548 0.2152 0.3067 1.4751 0.3050 0.0984 0.6318 0.4842\nMining&QuarryingofNonmetallicMinerals(NoFuels) 6 0.0569 -0.0299 0.1618 0.2954 0.0305 0.2549 0.4313 -0.0001 0.0885 0.7188\nRailroads 10 -0.0109 0.4033 1.3568 0.1266 0.2680 1.2789 0.2410 0.2466 1.4833 0.3504\nHomeFurnishings 8 0.0336 0.2567 0.8786 0.1899 0.2967 1.3483 0.3080 0.1965 1.0645 0.4663\nApparel 10 0.0079 0.2067 0.8641 0.1055 0.1946 0.9773 0.2025 0.3079 1.4040 0.3496\nOfficeEquipment/Supplies/Services 9 -0.0390 -0.3344 -1.2649 0.0844 -0.3280 -1.6894 0.2274 -0.2768 -1.5305 0.3900\nForestProducts 5 0.0664 0.9244 2.0120 0.2532 0.7321 2.7681 0.5052 0.3948 1.9793 1.0000\nAutoManufacturing 9 0.0252 0.0875 0.4246 0.2025 0.1577 0.9115 0.2520 0.3126 1.8921 0.3949\nServices-Misc.Amusement&Recreation 6 0.0602 0.5462 2.0205 0.1857 0.4993 2.8017 0.4308 0.3038 2.2588 0.7432\nSemiconductors 5 0.0378 0.7516 1.9347 0.2236 0.4438 1.8223 0.4859 0.3035 1.5702 1.0000\nAverage 10.97 0.0181 0.2924 0.9113 0.1535 0.2701 1.2890 0.2758 0.2515 1.4200 0.465\nTable12:CompleteresulttableforRankformeronNYSE.\nTSPRank:BridgingPairwiseandListwiseMethodswithaBilinearTravellingSalesmanModel KDDâ€™25,August3â€“7,2025,Toronto,Canada\nSector Stocks ğœ IRR@1 SR@1 MAP@1 IRR@3 SR@3 MAP@3 IRR@5 SR@5 MAP@5\nComputerManufacturing 5 0.0345 0.1128 0.6215 0.1983 0.3465 2.3286 0.5059 0.2167 1.3724 1.0000\nTransportationServices 5 0.0008 0.4351 1.2510 0.2489 0.2339 1.1572 0.4838 0.1263 0.7757 1.0000\nMedical/DentalInstruments 17 0.0090 0.5775 1.9145 0.0802 0.4503 2.3065 0.1254 0.4129 2.3442 0.1809\nProperty-CasualtyInsurers 19 0.0194 -0.0452 0.1845 0.1013 0.0247 0.2305 0.1751 0.0401 0.2988 0.1967\nMedicalSpecialities 5 0.0303 -0.0239 0.1681 0.2405 0.0473 0.3352 0.4930 -0.0402 -0.1500 1.0000\nBiotechnology:BiologicalProducts(NoDiagnosticSubstances) 12 0.0186 2.4685 2.9704 0.1688 1.0795 3.2313 0.2117 0.4928 1.8969 0.3013\nTelecommunicationsEquipment 16 0.0312 0.2872 0.9428 0.0675 0.0301 0.2521 0.1292 0.1160 0.6588 0.2023\nMedical/NursingServices 6 0.0345 0.6698 1.5659 0.1688 0.7648 2.4595 0.3915 0.3438 1.4557 0.7572\nWaterSupply 9 0.0392 0.4756 1.4303 0.2110 0.4821 2.1976 0.2785 0.3584 1.8276 0.4219\nRealEstateInvestmentTrusts 8 0.0063 0.1655 1.0105 0.1392 0.1347 1.1262 0.2818 0.0755 0.6959 0.4834\nBusinessServices 17 0.0268 1.6051 2.4223 0.1603 0.9827 3.3542 0.1798 0.7203 3.4705 0.2180\nMajorPharmaceuticals 29 0.0147 1.7511 2.5307 0.0380 1.1160 2.4861 0.0649 0.7787 2.4209 0.0850\nFarming/Seeds/Milling 6 0.0479 0.2494 0.8739 0.2152 0.2853 1.4940 0.4044 0.0968 0.6758 0.7522\nIndustrialSpecialties 11 0.0219 1.4803 2.9657 0.0844 0.9133 2.7340 0.2220 0.7123 2.9349 0.3298\nAirFreight/DeliveryServices 6 0.0165 0.5981 1.5902 0.1772 0.1919 0.8855 0.4121 0.0617 0.3960 0.7350\nElectricalProducts 13 0.0139 0.7310 2.2919 0.1055 0.3622 1.6007 0.1772 0.4157 1.8738 0.2609\nTelevisionServices 8 0.0318 -0.0302 0.0737 0.1181 0.0519 0.3379 0.3061 -0.0576 -0.1870 0.5070\nInvestmentBankers/Brokers/Service 18 0.0366 0.0700 0.3793 0.1055 0.4111 2.0910 0.1343 0.5326 3.0702 0.1857\nCatalog/SpecialtyDistribution 7 0.0474 1.0474 1.6694 0.1730 0.9757 2.4631 0.3209 0.6368 2.3162 0.6066\nSavingsInstitutions 20 0.0341 0.4459 1.3907 0.1266 0.3911 1.7948 0.1472 0.2374 1.2924 0.1919\nOtherConsumerServices 9 0.0327 -0.0204 0.1423 0.1350 0.3638 1.6126 0.2714 0.1654 0.8493 0.4181\nAutoParts:O.E.M. 6 0.0205 0.1364 0.5079 0.2278 0.0853 0.4936 0.4083 -0.0303 -0.0533 0.7472\nTruckingFreight/CourierServices 11 0.0236 1.2633 1.9697 0.1941 0.8822 2.3363 0.2698 0.4234 1.4514 0.3321\nRadioAndTVBroadcastingAndCommunicationsEquipment 10 0.0020 0.6117 1.1721 0.1097 0.5461 1.8837 0.2218 0.2672 1.3208 0.3429\nBiotechnology:Electromedical&ElectrotherapeuticApparatus 5 0.0336 0.3490 1.3161 0.2152 0.6316 2.6888 0.4892 0.3760 1.9405 1.0000\nHomeFurnishings 8 0.0255 -0.5294 -0.9480 0.1772 -0.0071 0.1231 0.2902 0.0675 0.4162 0.4921\nMajorChemicals 7 0.0386 0.0550 0.3581 0.1266 0.2015 1.0694 0.3293 0.1306 0.8491 0.6094\nOtherSpecialtyStores 8 0.0666 0.6364 2.0735 0.1266 0.9138 3.1965 0.3033 0.1963 1.0324 0.5221\nComputerSoftware:Programming,DataProcessing 7 0.0470 0.7064 2.3288 0.1814 0.6583 3.4336 0.3305 0.3598 2.1732 0.6190\nRestaurants 20 0.0077 0.1668 0.6579 0.0506 0.1775 0.9692 0.0942 0.1184 0.7246 0.1443\nAutomotiveAftermarket 6 0.0328 0.3689 1.2364 0.2025 0.3357 1.7185 0.3999 0.2355 1.3734 0.7544\nInvestmentManagers 5 0.0471 -0.0055 0.1115 0.2110 0.0272 0.2449 0.5087 0.0976 0.7306 1.0000\nOilRefining/Marketing 6 0.0317 0.5765 1.6158 0.2532 0.3921 1.8925 0.4154 0.1472 0.9318 0.7284\nRealEstate 7 0.0454 0.0186 0.2540 0.1350 0.4378 2.0464 0.3376 0.3771 2.2129 0.5996\nApparel 8 0.0366 0.9977 1.9552 0.1688 0.4962 1.6474 0.3054 0.3216 1.4747 0.4992\nOil&GasProduction 6 0.0160 -0.3752 -1.0564 0.1519 -0.0738 -0.0969 0.3826 -0.2398 -0.8349 0.7308\nComputerCommunicationsEquipment 5 0.0168 0.8553 2.3743 0.2785 0.2458 1.1800 0.4777 0.0383 0.3025 1.0000\nClothing/Shoe/AccessoryStores 8 0.0582 0.0546 0.3739 0.1477 0.1752 0.6443 0.3064 0.1487 0.6079 0.5038\nCommercialBanks 5 0.0361 0.0714 0.4419 0.1603 0.4664 2.2140 0.5415 0.1656 0.9570 1.0000\nHospital/NursingManagement 5 0.0076 0.4818 1.7654 0.2321 0.4274 2.4203 0.4794 0.2216 1.3716 1.0000\nBanks 5 0.0227 0.2333 1.0907 0.2194 0.1565 0.9575 0.5002 0.0939 0.6403 1.0000\nProfessionalServices 6 0.0625 0.6336 2.1653 0.2194 0.3393 1.7894 0.4255 0.2238 1.3882 0.7533\nPackagedFoods 7 0.0262 -0.0920 -0.1460 0.1730 -0.0812 -0.3737 0.3474 -0.0810 -0.4288 0.5873\nMetalFabrications 12 0.0157 0.1418 0.6525 0.0464 0.4426 1.7620 0.1650 0.1618 0.8427 0.2879\nDiversifiedCommercialServices 6 0.0501 0.6682 2.4055 0.1899 0.5824 2.4056 0.4144 0.1631 1.0603 0.7604\nComputerperipheralequipment 6 0.0199 1.3021 2.2781 0.1857 0.7407 2.5088 0.3971 0.2258 1.2091 0.7362\nSteel/IronOre 7 0.0510 0.9485 1.9659 0.2068 0.3539 1.4568 0.3633 0.1541 0.8421 0.5944\nHotels/Resorts 5 0.0168 2.2934 3.7945 0.2869 1.1013 4.1555 0.4829 0.8753 3.8558 1.0000\nBiotechnology:InVitro&InVivoDiagnosticSubstances 5 0.0252 0.4688 1.5839 0.2068 0.8971 3.0465 0.4845 0.4424 2.1666 1.0000\nElectronicComponents 8 0.0234 0.6777 1.6029 0.1435 0.8915 2.7138 0.2949 0.5627 2.2689 0.4826\nAverage 9.12 0.0291 0.5353 1.2858 0.1658 0.4416 1.7401 0.3297 0.2537 1.2623 0.5932\nTable13:CompleteresulttableforTSPRankwithlocaltrainingonNASDAQ.\nKDDâ€™25,August3â€“7,2025,Toronto,Canada WeixianWaylonLi,YftahZiser,YifeiXie,ShayB.Cohen,andTiejunMa\nSector Stocks ğœ IRR@1 SR@1 MAP@1 IRR@3 SR@3 MAP@3 IRR@5 SR@5 MAP@5\nBiotechnology:LaboratoryAnalyticalInstruments 5 0.0403 0.5598 2.6040 0.2236 0.5557 3.3714 0.5270 0.4553 3.1498 1.0000\nDiversifiedCommercialServices 9 0.0411 2.4720 2.5039 0.2954 1.0517 3.0297 0.3104 0.8197 3.1495 0.4093\nOtherSpecialtyStores 11 0.0227 0.0245 0.2376 0.0717 0.6322 1.8056 0.2046 0.4220 1.6928 0.3128\nInvestmentManagers 18 0.0117 1.0477 3.4502 0.0886 0.6783 3.7383 0.1346 0.3774 2.6299 0.1689\nElectricalProducts 13 0.0218 0.4920 1.4221 0.1181 0.2664 1.3944 0.1587 0.3098 1.7686 0.2540\nMajorPharmaceuticals 18 0.0306 -0.1847 -0.0638 0.1814 0.3830 1.4800 0.1917 0.2538 1.4076 0.2024\nOtherPharmaceuticals 5 0.0092 0.4138 1.5458 0.2405 0.3732 1.9308 0.4695 0.1719 1.0601 1.0000\nAutomotiveAftermarket 10 0.0421 0.4458 1.4042 0.1350 0.2815 1.1375 0.2370 0.1293 0.6515 0.3820\nPreciousMetals 11 0.0319 0.0474 0.3216 0.0844 0.3152 1.3579 0.1988 0.2239 1.1337 0.3240\nPublishing 5 0.0277 -0.1257 -0.7956 0.1519 0.0233 0.2224 0.5159 -0.1218 -0.5510 1.0000\nMilitary/Government/Technical 11 0.0371 0.4694 1.4329 0.1266 0.4552 1.9754 0.2239 0.3242 1.8900 0.3363\nBusinessServices 22 0.0333 0.3364 1.1996 0.0464 0.5007 2.9498 0.1036 0.4044 2.9889 0.1477\nPackagedFoods 16 0.0406 0.1458 0.5813 0.0928 0.2060 1.0524 0.1685 0.1690 1.0981 0.2349\nLifeInsurance 17 0.0239 0.0882 0.6505 0.0211 0.2186 1.7630 0.0924 0.2678 1.9882 0.1652\nPowerGeneration 15 0.0353 0.3675 2.5478 0.0591 0.3169 2.3796 0.1531 0.2577 2.3831 0.2139\nClothing/Shoe/AccessoryStores 15 0.0379 2.3676 2.2979 0.1097 0.9053 1.9437 0.1742 0.4445 1.3033 0.2438\nMedicalSpecialities 11 0.0343 0.7813 2.8202 0.1224 0.5672 3.3380 0.2140 0.4546 3.0373 0.3194\nProperty-CasualtyInsurers 30 0.0075 0.0193 0.2590 0.1266 0.1917 0.9142 0.1240 0.1814 1.0815 0.1435\nAccident&HealthInsurance 5 0.0244 0.3087 1.8361 0.1519 0.3655 2.0095 0.5082 0.2645 1.7726 1.0000\nFarming/Seeds/Milling 7 0.0362 0.3846 1.5380 0.1857 0.1224 0.8832 0.3364 0.1262 1.0892 0.5915\nEngineering&Construction 5 0.0345 0.1577 0.7986 0.1561 0.2455 1.1889 0.5277 -0.0339 -0.0130 1.0000\nAerospace 9 0.0247 0.7391 1.9837 0.1308 0.5730 2.8210 0.2447 0.4335 2.6282 0.4132\nIndustrialSpecialties 9 0.0156 0.4662 1.8216 0.0928 0.5138 2.5086 0.2639 0.3418 2.0486 0.4138\nSpecialtyInsurers 6 0.0518 0.3274 1.8225 0.2068 0.3344 3.0660 0.3997 0.2600 2.6415 0.7428\nMajorChemicals 29 0.0202 0.7541 2.2509 0.0549 0.5005 2.7419 0.0898 0.5291 3.3371 0.1152\nIntegratedoilCompanies 19 0.0167 0.9524 2.2709 0.0886 0.7087 2.8509 0.1526 0.3655 2.0313 0.1893\nAirFreight/DeliveryServices 8 0.0177 0.4120 1.2900 0.1561 0.4939 2.1393 0.3075 0.2120 1.0822 0.4611\nAutoParts:O.E.M. 18 0.0392 0.2733 0.9433 0.1139 0.1944 0.9760 0.1296 0.3378 1.7314 0.1898\nMetalFabrications 23 0.0090 0.4761 3.1351 0.0169 0.3988 2.1217 0.0830 0.1986 1.1345 0.1143\nProfessionalServices 11 0.0415 0.4349 1.4948 0.1646 0.6978 3.2171 0.2356 0.6156 3.2783 0.3452\nConsumerElectronics/Appliances 6 0.0272 0.1768 0.8642 0.2194 0.3083 2.0561 0.4058 0.0786 0.7728 0.7263\nFluidControls 7 0.0474 0.8668 1.9553 0.2194 0.4234 1.9204 0.3397 0.3069 1.6782 0.6052\nOtherConsumerServices 17 0.0179 0.5385 1.3441 0.0717 0.2641 1.2278 0.1350 0.5152 2.2771 0.1867\nSteel/IronOre 9 0.0231 0.7430 1.3593 0.1435 0.5142 1.6196 0.2548 0.3780 1.4982 0.4237\nOil/GasTransmission 6 0.0322 0.2737 1.7428 0.1519 0.2241 2.0204 0.3973 0.1256 1.2338 0.7301\nPlasticProducts 6 0.0838 0.5736 2.0377 0.2068 0.5182 3.0642 0.4416 0.4475 3.2359 0.7683\nAgriculturalChemicals 7 0.0226 0.1401 1.3763 0.0844 0.0105 0.1532 0.3488 -0.0051 0.0369 0.6279\nContainers/Packaging 9 0.0385 0.6422 2.6688 0.2110 0.4324 2.8012 0.2700 0.3217 2.6081 0.4249\nWaterSupply 7 0.0570 0.3788 1.2039 0.1983 0.3926 2.0605 0.3439 0.4456 2.4154 0.6084\nFinance:ConsumerServices 20 0.0160 0.9140 2.1926 0.0970 0.4886 2.4532 0.1188 0.1702 1.2730 0.1705\nCommercialBanks 21 0.0188 0.0495 0.7665 0.0169 0.1185 1.1677 0.0546 0.1436 1.4201 0.0947\nMedical/DentalInstruments 12 0.0101 0.7262 3.7107 0.1013 0.5041 3.1897 0.1854 0.2896 1.9492 0.2843\nComputerSoftware:PrepackagedSoftware 11 0.0342 0.3481 1.5806 0.0928 0.6486 3.3962 0.1925 0.4644 2.7707 0.3269\nOilRefining/Marketing 9 0.0240 0.8635 2.6404 0.1603 0.1772 1.1876 0.2635 -0.0090 0.0016 0.4166\nHotels/Resorts 10 0.0279 0.8493 3.3624 0.1181 0.3664 2.1728 0.2276 0.3277 2.3952 0.3793\nRestaurants 7 0.0654 0.6800 2.9722 0.1435 0.2561 1.9646 0.3556 0.0743 0.6134 0.6355\nDepartment/SpecialtyRetailStores 8 0.0213 0.2109 0.7823 0.1561 0.1482 0.7635 0.2872 0.0783 0.5165 0.4944\nMarineTransportation 14 0.0413 0.3574 0.9199 0.1519 0.3326 1.4241 0.1847 0.3045 1.6041 0.2481\nEDPServices 11 0.0313 0.5444 1.1215 0.2447 0.4464 1.7959 0.2302 0.2479 1.2955 0.3362\nHospital/NursingManagement 10 0.0296 0.4994 1.5208 0.0928 0.4827 1.5102 0.2201 0.3523 1.2736 0.3718\nSavingsInstitutions 6 0.0238 0.0890 0.5546 0.1857 0.2552 1.7050 0.4058 0.1622 1.4018 0.7484\nInvestmentBankers/Brokers/Service 13 0.0301 0.1306 0.6194 0.1139 0.3248 1.6569 0.1985 0.2423 1.3841 0.2842\nMeat/Poultry/Fish 5 0.0244 0.3557 1.7454 0.1350 0.2320 1.7939 0.5115 0.0990 0.8471 1.0000\nBeverages(Production/Distribution) 12 0.0224 0.1657 0.7928 0.1055 0.2767 1.8955 0.2189 0.3159 2.6596 0.2953\nHomebuilding 16 0.0198 1.2634 2.6371 0.1139 1.1338 4.2467 0.1624 0.8278 3.7611 0.2217\nShoeManufacturing 5 0.0412 0.6360 1.1819 0.2110 0.5264 1.6604 0.5075 0.3139 1.3117 1.0000\nConstruction/AgEquipment/Trucks 6 0.0389 0.5224 1.4423 0.1730 0.5174 2.1491 0.3830 0.5055 2.1878 0.7595\nRealEstate 13 0.0156 0.5298 1.8985 0.1097 0.3496 2.1786 0.1953 0.3528 2.5679 0.2669\nPackageGoods/Cosmetics 10 0.0401 0.5845 1.4541 0.1730 0.4727 2.1772 0.2637 0.2672 1.7438 0.3694\nOilfieldServices/Equipment 8 0.0285 -0.1387 -0.4397 0.0928 -0.0712 -0.2511 0.2520 -0.1750 -0.7463 0.5034\nPaper 8 0.0297 0.8200 2.5088 0.2194 0.4023 1.8222 0.3010 0.2678 1.4775 0.4899\nMining&QuarryingofNonmetallicMinerals(NoFuels) 6 0.0490 0.4848 1.1827 0.3080 0.1191 0.6274 0.4039 0.0349 0.2884 0.7267\nRailroads 10 0.0199 0.4851 1.4619 0.1350 0.4577 2.4256 0.2414 0.3471 2.0814 0.3683\nHomeFurnishings 8 0.0198 0.3184 1.0925 0.1899 0.2273 1.0715 0.2979 0.1034 0.6607 0.4743\nApparel 10 0.0177 0.2459 0.9315 0.0970 0.1652 0.8444 0.2199 0.2379 1.2735 0.3689\nOfficeEquipment/Supplies/Services 9 0.0385 0.1088 0.5265 0.1392 0.1758 0.9885 0.2579 -0.0792 -0.3433 0.4275\nForestProducts 5 0.0521 0.8712 1.9437 0.2363 0.6435 2.6611 0.5234 0.3948 1.9793 1.0000\nAutoManufacturing 9 0.0460 0.5626 1.7120 0.2068 0.4137 2.4364 0.2571 0.3849 2.3002 0.4122\nServices-Misc.Amusement&Recreation 6 0.0585 0.5954 2.6355 0.1772 0.5220 3.4206 0.4334 0.3573 2.7303 0.7524\nSemiconductors 5 0.0429 0.6257 2.3595 0.1519 0.5468 2.3792 0.5202 0.3035 1.5702 1.0000\nAverage 10.97 0.0313 0.5012 1.5710 0.1424 0.3974 1.9735 0.2756 0.2788 1.6662 0.4680\nTable14:CompleteresulttableforTSPRankwithlocaltrainingonNYSE.\nTSPRank:BridgingPairwiseandListwiseMethodswithaBilinearTravellingSalesmanModel KDDâ€™25,August3â€“7,2025,Toronto,Canada\nSector Stocks ğœ IRR@1 SR@1 MAP@1 IRR@3 SR@3 MAP@3 IRR@5 SR@5 MAP@5\nComputerManufacturing 5 0.0462 0.7131 2.6391 0.1941 0.4412 2.6858 0.5063 0.2167 1.3724 1.0000\nTransportationServices 5 0.0790 0.8231 2.6376 0.1772 0.5290 2.1863 0.5211 0.1263 0.7757 1.0000\nMedical/DentalInstruments 17 0.0009 0.4891 1.3264 0.0675 0.9051 3.1209 0.1395 0.4674 2.3745 0.1898\nProperty-CasualtyInsurers 19 0.0262 0.5825 1.7370 0.1013 0.1596 0.8014 0.1324 0.1295 0.7147 0.1896\nMedicalSpecialities 5 0.0513 0.3184 1.1598 0.1814 0.0501 0.3507 0.5319 -0.0402 -0.1500 1.0000\nBiotechnology:BiologicalProducts(NoDiagnosticSubstances) 12 0.0339 2.7414 3.5486 0.1435 1.0576 3.2959 0.2161 0.7736 2.9855 0.3079\nTelecommunicationsEquipment 16 0.0361 0.7213 1.6043 0.0928 0.6366 2.5527 0.1320 0.2411 1.3507 0.1929\nMedical/NursingServices 6 0.0406 0.2231 0.8829 0.1857 0.5104 2.0530 0.4067 0.3734 1.6074 0.7533\nWaterSupply 9 0.0271 0.3681 1.5003 0.0886 0.3183 1.5523 0.2616 0.1904 1.0373 0.4305\nRealEstateInvestmentTrusts 8 0.0606 0.2353 1.3346 0.1266 0.2303 1.6356 0.2996 0.1188 1.0167 0.5047\nBusinessServices 17 0.0327 0.9827 2.0224 0.0886 0.4924 2.0209 0.1296 0.5139 2.5909 0.1958\nMajorPharmaceuticals 29 0.0150 1.3801 1.7649 0.0844 1.1300 2.4818 0.0928 0.6112 1.9240 0.1143\nFarming/Seeds/Milling 6 0.0557 0.3764 1.2830 0.2152 0.1955 1.0461 0.4126 0.1064 0.7187 0.7526\nIndustrialSpecialties 11 0.0219 0.8028 1.9248 0.1013 1.1003 3.2369 0.2295 0.6864 2.9025 0.3320\nAirFreight/DeliveryServices 6 0.0182 0.1825 0.6729 0.1646 0.3296 1.3477 0.4015 0.0836 0.4943 0.7340\nElectricalProducts 13 0.0237 1.3353 2.4725 0.0970 0.8455 2.7356 0.1866 0.5791 2.3875 0.2745\nTelevisionServices 8 0.0552 0.8375 2.4448 0.1941 0.3247 1.4238 0.3315 0.0965 0.5797 0.5135\nInvestmentBankers/Brokers/Service 18 0.0392 1.2698 3.2572 0.0802 0.9476 2.9791 0.1796 0.6891 3.1783 0.2325\nCatalog/SpecialtyDistribution 7 0.0486 2.0857 2.9492 0.1435 0.6505 1.9303 0.3586 0.3549 1.4601 0.6089\nSavingsInstitutions 20 0.0158 0.2971 1.1601 0.0928 0.2722 1.5362 0.1191 0.1138 0.7170 0.1627\nOtherConsumerServices 9 0.0395 0.7300 1.3770 0.1857 0.2894 1.0383 0.3052 0.2786 1.3046 0.4193\nAutoParts:O.E.M. 6 0.0557 -0.0184 0.0857 0.1857 0.1717 0.8682 0.4147 -0.0410 -0.1008 0.7706\nTruckingFreight/CourierServices 11 0.0390 1.0055 1.5900 0.1392 0.6701 1.9763 0.2293 0.5084 1.8487 0.3295\nRadioAndTVBroadcastingAndCommunicationsEquipment 10 0.0496 2.8446 2.7443 0.1603 0.9634 2.7246 0.2543 0.4660 2.0555 0.3792\nBiotechnology:Electromedical&ElectrotherapeuticApparatus 5 0.0588 1.7655 3.2478 0.2532 0.7827 2.8964 0.5183 0.3760 1.9405 1.0000\nHomeFurnishings 8 0.0336 -0.1574 -0.1671 0.1730 -0.0020 0.1388 0.2890 0.1674 0.8236 0.5008\nMajorChemicals 7 0.0598 0.7313 2.6136 0.1308 0.2680 1.5711 0.3462 0.2038 1.2628 0.6400\nOtherSpecialtyStores 8 0.0471 0.7342 1.5967 0.1013 0.3793 1.5717 0.2726 0.1491 0.8533 0.5228\nComputerSoftware:Programming,DataProcessing 7 0.0482 0.5432 1.8926 0.1814 0.5947 3.3514 0.3317 0.3921 2.4265 0.6468\nRestaurants 20 0.0296 0.2455 0.8613 0.0549 0.5447 2.1873 0.1308 0.2523 1.3900 0.1650\nAutomotiveAftermarket 6 0.0501 0.2125 0.9663 0.1519 0.4733 2.0485 0.4262 0.2650 1.4178 0.7566\nInvestmentManagers 5 0.0664 0.0982 0.5116 0.2152 0.2713 1.6159 0.5342 0.0976 0.7306 1.0000\nOilRefining/Marketing 6 0.0507 -0.1676 -0.5275 0.2869 0.2519 1.3796 0.3964 0.2054 1.2418 0.7240\nRealEstate 7 0.0426 0.0887 0.4459 0.1350 0.4726 2.2371 0.3537 0.2984 1.9897 0.5988\nApparel 8 0.0435 0.7246 2.2949 0.1013 0.5383 2.2606 0.2738 0.3009 1.5811 0.5303\nOil&GasProduction 6 0.0754 0.2320 0.6923 0.2321 0.0308 0.2634 0.4196 -0.1448 -0.4294 0.7624\nComputerCommunicationsEquipment 5 0.0538 0.6350 1.7178 0.1772 0.1738 0.8243 0.5108 0.0383 0.3025 1.0000\nClothing/Shoe/AccessoryStores 8 0.0516 0.9644 1.4510 0.1646 0.3530 1.0613 0.2832 0.3947 1.2682 0.5028\nCommercialBanks 5 0.0656 1.2792 3.0330 0.3080 0.5256 2.3832 0.5127 0.1656 0.9570 1.0000\nHospital/NursingManagement 5 0.0571 1.6740 3.2362 0.3249 0.5750 2.7682 0.5047 0.2216 1.3716 1.0000\nBanks 5 0.0681 0.5274 2.1182 0.2321 0.2835 1.5233 0.4913 0.0939 0.6403 1.0000\nProfessionalServices 6 0.0373 0.2523 1.1628 0.1477 0.3277 1.7772 0.4121 0.1111 0.7555 0.7574\nPackagedFoods 7 0.0354 0.3166 1.0405 0.1772 0.2745 1.4123 0.3378 0.0144 0.1752 0.5915\nMetalFabrications 12 0.0332 1.3147 2.2192 0.1308 0.5870 2.0254 0.2107 0.4915 2.0341 0.2896\nDiversifiedCommercialServices 6 0.0479 0.8004 1.7045 0.2152 0.6214 2.7428 0.4001 0.3688 2.1574 0.7675\nComputerperipheralequipment 6 0.0457 1.1838 2.2897 0.1688 0.9419 3.3506 0.4098 0.3438 1.7482 0.7476\nSteel/IronOre 7 0.0554 0.5307 1.4018 0.1688 0.4526 1.8570 0.3472 0.2197 1.1517 0.5988\nHotels/Resorts 5 0.0529 1.5454 3.2324 0.2658 1.0232 4.1963 0.5134 0.8753 3.8558 1.0000\nBiotechnology:InVitro&InVivoDiagnosticSubstances 5 0.0588 0.8881 2.3463 0.2152 1.0344 3.4675 0.4930 0.4424 2.1666 1.0000\nElectronicComponents 8 0.0555 0.9552 1.8544 0.1603 1.1190 3.3023 0.3099 0.6983 2.6961 0.5051\nAverage 9.12 0.0447 0.7849 1.7471 0.1633 0.5224 2.0359 0.3364 0.2937 1.4331 0.5999\nTable15:CompleteresulttableforTSPRankwithglobaltrainingonNASDAQ.\nKDDâ€™25,August3â€“7,2025,Toronto,Canada WeixianWaylonLi,YftahZiser,YifeiXie,ShayB.Cohen,andTiejunMa\nSector Stocks ğœ IRR@1 SR@1 MAP@1 IRR@3 SR@3 MAP@3 IRR@5 SR@5 MAP@5\nBiotechnology:LaboratoryAnalyticalInstruments 5 0.0454 0.5059 2.8110 0.1983 0.4805 3.2350 0.5251 0.4553 3.1498 1.0000\nDiversifiedCommercialServices 9 0.0287 0.6134 1.6824 0.1603 0.7515 2.5416 0.2771 0.5597 2.3811 0.4168\nOtherSpecialtyStores 11 0.0426 0.4883 1.1274 0.1266 0.7789 2.1611 0.2180 0.4915 1.7811 0.3265\nInvestmentManagers 18 0.0319 0.8985 3.0370 0.0844 0.5710 2.9765 0.1282 0.5072 3.0107 0.1797\nElectricalProducts 13 0.0364 0.5099 1.8447 0.1097 0.3411 1.9502 0.1793 0.3041 1.8406 0.2766\nMajorPharmaceuticals 18 0.0484 0.3468 0.8992 0.1392 0.5776 2.5628 0.1620 0.3553 2.0901 0.2052\nOtherPharmaceuticals 5 0.0462 0.4623 1.6864 0.2743 0.3309 1.6992 0.4883 0.1719 1.0601 1.0000\nAutomotiveAftermarket 10 0.0376 0.3244 1.1962 0.1266 0.1897 0.9214 0.2278 0.1262 0.7006 0.3639\nPreciousMetals 11 0.0423 0.8095 2.1805 0.1688 0.6709 2.6943 0.2344 0.4070 2.0062 0.3355\nPublishing 5 0.0504 -0.1658 -0.1896 0.2869 -0.0292 0.0094 0.4887 -0.1218 -0.5510 1.0000\nMilitary/Government/Technical 11 0.0340 0.0927 0.4890 0.1477 0.2599 1.5451 0.2105 0.2256 1.6561 0.3416\nBusinessServices 22 0.0314 0.7742 2.5470 0.0886 0.6654 3.7382 0.1331 0.5076 3.6890 0.1686\nPackagedFoods 16 0.0275 0.0566 0.3738 0.0970 0.2547 1.5930 0.1460 0.2264 1.7117 0.2216\nLifeInsurance 17 0.0325 0.9913 2.8119 0.0886 0.2141 1.4321 0.1486 0.2798 2.0832 0.1960\nPowerGeneration 15 0.0410 -0.0439 -0.0996 0.0675 0.1298 1.1274 0.1535 0.1802 1.5840 0.2119\nClothing/Shoe/AccessoryStores 15 0.0456 1.2433 1.6214 0.1055 0.6930 1.5866 0.1737 0.3455 1.1032 0.2485\nMedicalSpecialities 11 0.0271 0.4398 1.7652 0.0802 0.5340 3.1256 0.1995 0.4774 3.0575 0.3153\nProperty-CasualtyInsurers 30 0.0142 0.2757 0.8266 0.0886 0.2229 1.2077 0.0879 0.1546 1.0534 0.1065\nAccident&HealthInsurance 5 0.0286 0.1709 1.0124 0.1435 0.2999 1.9586 0.5124 0.2645 1.7726 1.0000\nFarming/Seeds/Milling 7 0.0310 0.1738 0.8761 0.1814 0.2130 1.4021 0.3345 0.0954 0.7925 0.5989\nEngineering&Construction 5 0.0437 0.2857 1.1477 0.1519 0.3424 1.2229 0.5270 -0.0339 -0.0130 1.0000\nAerospace 9 0.0411 0.6488 2.4841 0.1392 0.4342 2.5592 0.2632 0.3839 2.5218 0.4233\nIndustrialSpecialties 9 0.0348 0.1359 0.6053 0.1561 0.4000 2.5422 0.2689 0.2626 2.1123 0.4247\nSpecialtyInsurers 6 0.0742 0.5958 2.9815 0.2321 0.3912 3.5052 0.4156 0.2610 2.5276 0.7635\nMajorChemicals 29 0.0209 0.4391 1.3614 0.0591 0.5311 2.4851 0.0863 0.4246 2.4869 0.1054\nIntegratedoilCompanies 19 0.0298 0.5355 1.4804 0.0759 0.3828 1.8127 0.1322 0.2732 1.6078 0.1797\nAirFreight/DeliveryServices 8 0.0354 0.8190 2.0955 0.1857 0.4494 2.0238 0.2972 0.2071 1.1508 0.4734\nAutoParts:O.E.M. 18 0.0282 0.6774 2.4992 0.0844 0.2974 1.6579 0.1238 0.2797 1.5649 0.1822\nMetalFabrications 23 0.0315 1.1879 2.4235 0.1266 0.3417 1.4612 0.1414 0.2625 1.3513 0.1663\nProfessionalServices 11 0.0516 1.2433 2.7674 0.1350 0.3915 2.0929 0.2042 0.3667 2.1894 0.3435\nConsumerElectronics/Appliances 6 0.0434 0.0869 0.5293 0.1730 0.2392 1.6402 0.3926 0.1074 0.9977 0.7422\nFluidControls 7 0.0458 0.7086 3.1057 0.1857 0.3542 1.9654 0.3476 0.2994 1.8719 0.6313\nOtherConsumerServices 17 0.0284 0.2415 0.7103 0.1055 0.0138 0.1909 0.1676 0.3256 1.6478 0.2158\nSteel/IronOre 9 0.0238 0.9439 1.6691 0.1181 0.3774 1.2905 0.2536 0.3934 1.5161 0.4125\nOil/GasTransmission 6 0.0580 0.3785 1.7910 0.1772 0.2577 2.1271 0.4144 0.1777 1.6504 0.7406\nPlasticProducts 6 0.0726 0.3942 1.6841 0.1646 0.5777 3.5004 0.4369 0.3581 2.5870 0.7513\nAgriculturalChemicals 7 0.0618 0.0953 0.5161 0.1266 0.2795 1.5774 0.3643 0.0391 0.3648 0.6268\nContainers/Packaging 9 0.0362 0.0613 0.5496 0.0759 0.3036 2.4296 0.2196 0.3183 2.6423 0.4258\nWaterSupply 7 0.0570 0.4097 1.4196 0.2025 0.8891 3.7332 0.3591 0.4585 2.5417 0.6079\nFinance:ConsumerServices 20 0.0433 0.5376 2.0062 0.0886 0.2829 1.6800 0.1111 0.2882 2.0748 0.1659\nCommercialBanks 21 0.0217 0.5504 2.0888 0.0802 0.5011 2.9425 0.1217 0.3375 2.5244 0.1625\nMedical/DentalInstruments 12 0.0313 0.1891 1.0436 0.0759 0.4168 2.7722 0.1833 0.4027 2.8406 0.2830\nComputerSoftware:PrepackagedSoftware 11 0.0261 0.7705 2.1522 0.0844 0.6469 3.1697 0.2011 0.4349 2.3852 0.3323\nOilRefining/Marketing 9 0.0593 0.7053 2.2314 0.1224 0.3295 1.6251 0.2555 0.1965 1.2611 0.4422\nHotels/Resorts 10 0.0402 0.1859 0.9010 0.1181 0.5225 3.0131 0.2403 0.4942 3.4102 0.3747\nRestaurants 7 0.0682 0.1222 0.6333 0.1561 0.0546 0.4712 0.3378 0.1528 1.1004 0.6384\nDepartment/SpecialtyRetailStores 8 0.0555 0.3472 1.0299 0.1519 0.2370 0.9831 0.2977 0.2523 1.1683 0.5081\nMarineTransportation 14 0.0361 0.5846 1.4050 0.1392 0.2815 1.3936 0.1765 0.2895 1.6238 0.2451\nEDPServices 11 0.0468 0.6478 1.7467 0.1224 0.2712 1.2282 0.2332 0.2565 1.3250 0.3540\nHospital/NursingManagement 10 0.0399 0.0487 0.3412 0.0464 0.3271 1.2364 0.2157 0.2169 0.9386 0.3695\nSavingsInstitutions 6 0.0546 -0.0320 -0.0924 0.1561 0.2396 1.9658 0.4027 0.1941 1.7806 0.7720\nInvestmentBankers/Brokers/Service 13 0.0233 0.1814 0.7968 0.1139 0.2372 1.2043 0.1967 0.2408 1.3483 0.2689\nMeat/Poultry/Fish 5 0.0723 0.1941 1.0074 0.2068 0.2952 1.8236 0.5122 0.0990 0.8471 1.0000\nBeverages(Production/Distribution) 12 0.0435 0.2829 1.4588 0.1266 0.3857 2.8449 0.1906 0.3436 2.9831 0.2874\nHomebuilding 16 0.0411 1.2737 2.8299 0.0970 1.0350 3.6869 0.1629 1.0061 4.1459 0.2241\nShoeManufacturing 5 0.0630 2.4099 2.3840 0.2700 0.6841 1.9317 0.5136 0.3139 1.3117 1.0000\nConstruction/AgEquipment/Trucks 6 0.0445 1.1036 2.3375 0.1899 0.5665 2.0795 0.4158 0.3165 1.4641 0.7446\nRealEstate 13 0.0218 0.3852 1.8531 0.0464 0.3056 2.0952 0.1261 0.2149 1.7090 0.2573\nPackageGoods/Cosmetics 10 0.0684 0.5788 2.1845 0.1392 0.4712 2.9352 0.2482 0.3153 2.2773 0.3878\nOilfieldServices/Equipment 8 0.0453 0.1043 0.5019 0.1181 0.0309 0.2552 0.2832 -0.0842 -0.2748 0.5072\nPaper 8 0.0654 0.1922 0.8538 0.1392 0.3425 1.7754 0.3228 0.2166 1.2878 0.5110\nMining&QuarryingofNonmetallicMinerals(NoFuels) 6 0.0535 0.0412 0.2960 0.1561 0.2562 1.2813 0.4196 0.0165 0.1869 0.7555\nRailroads 10 0.0324 0.0023 0.1227 0.0928 0.3475 2.1375 0.2307 0.1976 1.4698 0.3561\nHomeFurnishings 8 0.0360 0.5031 1.2453 0.2110 0.3288 1.5796 0.3073 0.2074 1.2672 0.4880\nApparel 10 0.0296 0.0734 0.4790 0.0759 0.3282 1.8800 0.1871 0.3780 2.1074 0.3702\nOfficeEquipment/Supplies/Services 9 0.0479 -0.1323 -0.2453 0.1477 0.1893 0.9815 0.2722 -0.0432 -0.1300 0.4131\nForestProducts 5 0.0639 0.9512 2.0830 0.2616 0.6872 2.6944 0.5047 0.3948 1.9793 1.0000\nAutoManufacturing 9 0.0451 0.4649 1.6525 0.1392 0.3408 2.0907 0.2628 0.2689 1.7380 0.4230\nServices-Misc.Amusement&Recreation 6 0.0345 0.4000 1.4716 0.2236 0.4410 2.7912 0.4051 0.3083 2.4364 0.7499\nSemiconductors 5 0.0571 0.9888 2.7414 0.2068 0.4380 1.9950 0.5087 0.3035 1.5702 1.0000\nAverage 10.97 0.0422 0.4787 1.4552 0.1392 0.3889 1.9976 0.2756 0.2816 1.7350 0.4732\nTable16:CompleteresulttableforTSPRankwithglobaltrainingonNYSE.\nTSPRank:BridgingPairwiseandListwiseMethodswithaBilinearTravellingSalesmanModel KDDâ€™25,August3â€“7,2025,Toronto,Canada\nLambdaMART Rankformer TSPRank-Local TSPRank-Global\nNDCG@3 NDCG@5 NDCG@10 MRR Tau NDCG@3 NDCG@5 NDCG@10 MRR ğœ NDCG@3 NDCG@5 NDCG@10 MRR Tau NDCG@3 NDCG@5 NDCG@10 MRR ğœ\nFold Top10\nFold1 0.6867 0.7180 0.8702 0.4060 0.1330 0.7218 0.7504 0.8832 0.4280 0.2083 0.6837 0.7227 0.8699 0.3956 0.1346 0.7224 0.7606 0.8883 0.4895 0.2174\nFold2 0.6651 0.7052 0.8631 0.4379 0.1117 0.7057 0.7469 0.8809 0.4784 0.2045 0.6671 0.7031 0.8668 0.4655 0.1193 0.7162 0.7472 0.8838 0.4706 0.1940\nFold3 0.6904 0.7337 0.8755 0.4286 0.1782 0.7442 0.7743 0.8968 0.4984 0.2651 0.6936 0.7326 0.8735 0.4153 0.1813 0.7341 0.7678 0.8927 0.4883 0.2444\nFold4 0.6702 0.7180 0.8657 0.4248 0.1406 0.7082 0.7504 0.8814 0.4413 0.2345 0.6930 0.7247 0.8749 0.4662 0.1655 0.7227 0.7519 0.8847 0.4932 0.2192\nFold5 0.7043 0.7361 0.8791 0.4324 0.1734 0.7301 0.7605 0.8904 0.4844 0.2459 0.6915 0.7232 0.8742 0.3905 0.1714 0.7483 0.7651 0.8926 0.4887 0.2311\nAverage 0.6833 0.7222 0.8707 0.4259 0.1474 0.7220 0.7565 0.8865 0.4661 0.2317 0.6858 0.7213 0.8719 0.4266 0.1544 0.7287 0.7585 0.8884 0.4861 0.2212\nTop30\nFold1 0.7284 0.7244 0.7410 0.3563 0.2392 0.7214 0.7221 0.7411 0.3535 0.2497 0.7151 0.7230 0.7401 0.3096 0.2515 0.7587 0.7504 0.7604 0.3685 0.2616\nFold2 0.7097 0.7088 0.7225 0.3564 0.2061 0.7501 0.7466 0.7598 0.3896 0.2970 0.7189 0.7240 0.7362 0.3206 0.2054 0.7521 0.7534 0.7587 0.3945 0.2725\nFold3 0.7481 0.7397 0.7463 0.3750 0.2409 0.7641 0.7638 0.7665 0.3860 0.2932 0.7288 0.7304 0.7426 0.3061 0.2444 0.7703 0.7612 0.7637 0.4190 0.2686\nFold4 0.7386 0.7357 0.7421 0.3754 0.2443 0.7271 0.7292 0.7465 0.3526 0.2591 0.7223 0.7233 0.7368 0.3483 0.2294 0.7547 0.7558 0.7635 0.3833 0.2545\nFold5 0.7453 0.7406 0.7495 0.3456 0.2554 0.7803 0.7733 0.7841 0.3841 0.3178 0.7122 0.7235 0.7425 0.2997 0.2435 0.7550 0.7583 0.7693 0.3820 0.2675\nAverage 0.7340 0.7298 0.7403 0.3617 0.2372 0.7486 0.7470 0.7596 0.3732 0.2834 0.7195 0.7248 0.7396 0.3169 0.2348 0.7582 0.7558 0.7631 0.3895 0.2649\nTable17:CompleteresultsonMQ2008-listforinformationretrieval.\nLambdaMART Rankformer TSPRank-Local TSPRank-Global\nGroupSize10\nAllocation ğœâ†‘ EMâ†‘ MRRâ†‘ RMSEâ†“ ğœâ†‘ EMâ†‘ MRRâ†‘ RMSEâ†“ ğœâ†‘ EMâ†‘ MRRâ†‘ RMSEâ†“ ğœâ†‘ EMâ†‘ MRRâ†‘ RMSEâ†“\n1 0.6456 0.3043 0.7813 1.904 0.6269 0.2801 0.7542 1.962 0.5632 0.2909 0.7703 2.369 0.6285 0.3275 0.8038 2.060\n2 0.5834 0.2739 0.7504 2.144 0.6196 0.2924 0.7509 2.007 0.5664 0.2682 0.7918 2.226 0.6344 0.3400 0.7997 2.047\n3 0.6343 0.3018 0.7534 1.963 0.6144 0.2874 0.7162 2.017 0.5568 0.2917 0.7489 2.356 0.6304 0.3339 0.7751 2.063\n4 0.6252 0.3051 0.7431 1.992 0.6123 0.2935 0.7264 2.022 0.5533 0.2632 0.7363 2.274 0.6226 0.3310 0.7903 2.082\n5 0.6008 0.2862 0.7538 2.086 0.6217 0.2962 0.7328 1.984 0.5891 0.3138 0.7924 2.255 0.6347 0.3428 0.7993 2.035\nAverage 0.6297 0.3008 0.7554 1.993 0.6190 0.2899 0.7361 1.998 0.5658 0.2856 0.7679 2.296 0.6301 0.3350 0.7936 2.057\nGroupSize30\n1 0.5947 0.1066 0.6334 5.948 0.5872 0.0905 0.4825 5.945 0.5026 0.0886 0.5416 6.957 0.6334 0.1378 0.7356 5.729\n2 0.5882 0.1013 0.6102 6.047 0.5868 0.0880 0.4927 5.980 0.5256 0.0867 0.6039 6.714 0.6348 0.1351 0.7510 5.728\n3 0.5856 0.1135 0.6288 6.071 0.5834 0.0930 0.5059 5.984 0.5116 0.0860 0.5677 6.9300 0.6312 0.1419 0.6895 5.748\n4 0.6030 0.1013 0.6062 5.838 0.5863 0.0925 0.4826 5.970 0.5043 0.0873 0.6162 7.0420 0.6290 0.1349 0.7242 5.790\n5 0.5930 0.1091 0.5822 5.943 0.5858 0.0967 0.4917 5.986 0.5036 0.0879 0.5401 7.0070 0.6227 0.1423 0.7498 5.857\nAverage 0.5929 0.1064 0.6122 5.969 0.5859 0.0921 0.4911 5.973 0.5095 0.0873 0.5739 6.930 0.6302 0.1384 0.7300 5.770\nGroupSize50\n1 0.6074 0.0672 0.5694 9.476 0.5717 0.0543 0.3857 10.084 0.4700 0.0460 0.3961 12.149 0.6179 0.0821 0.6632 9.645\n2 0.6072 0.0658 0.5418 9.437 0.5747 0.0523 0.3211 10.012 0.4907 0.0463 0.3514 11.693 0.6189 0.0834 0.6604 9.601\n3 0.5973 0.0625 0.5435 9.681 0.5741 0.0523 0.3516 10.040 0.4573 0.0404 0.3529 12.406 0.6169 0.0901 0.6347 9.650\n4 0.5989 0.0611 0.5581 9.627 0.5710 0.0541 0.3706 10.086 0.4688 0.0481 0.3617 11.994 0.6231 0.0886 0.6731 9.575\n5 0.5891 0.0627 0.5852 9.870 0.5705 0.0505 0.3342 10.122 0.4697 0.0490 0.5122 12.179 0.6268 0.0915 0.6774 9.537\nAverage 0.6000 0.0639 0.5596 9.618 0.5724 0.0527 0.3526 10.069 0.4713 0.0460 0.3949 12.084 0.6207 0.0871 0.6618 9.602\nTable18:CompleteresultsonOTD2forhistoricaleventsordering.",
    "pdf_filename": "TSPRank_Bridging_Pairwise_and_Listwise_Methods_with_a_Bilinear_Travelling_Salesman_Model.pdf"
}