{
    "title": "Estimating Dark Matter Halo Masses in Simulated",
    "abstract": "Galaxiesgrowandevolveindarkmatterhalos. Becausedarkmatterisnotvisible, galaxies’ halo masses (M ) must be inferred indirectly. We present a graph halo neural network (GNN) model for predicting M from stellar mass (M ) in halo ∗ simulatedgalaxyclustersusingdatafromtheIllustrisTNGsimulationsuite. Unlike traditionalmachinelearningmodelslikerandomforests,ourGNNcapturesthe information-rich substructure of galaxy clusters by using spatial and kinematic relationshipsbetweengalaxyneighbour.AGNNmodeltrainedontheTNG-Cluster dataset and independently tested on the TNG300 simulation achieves superior predictiveperformancecomparedtootherbaselinemodelswetested. Futurework willextendthisapproachtodifferentsimulationsandrealobservationaldatasetsto furthervalidatetheGNNmodel’sabilitytogeneralise. 1 Introduction IntheLambdaColdDarkMattercosmologicalmodel[28,4],galaxiesformandevolveindarkmatter halos. Cosmologicalsimulationsdemonstratethatgalaxiesgrowintandemwiththeirdarkmatter halosaccordingtowell-measuredandtightscalingrelations[39]. Thisinterdependencebetween stellarmass(M )andsubhalomass(M )isknownasthestellar–halomassrelation(SHMR). ∗ halo WhileM isobservable,M mustoftenbeinferredindirectlyviatheSHMRduetoobservational ∗ halo constraints. Forexample,galaxyclusters—themostmassivegravitationallyboundobjectsinthe Universe—aredarkmatterdominated,buttheirtotalmassmustbemeasuredviagravitationallensing [8, 37], the Sunyaev-Zel’dovich effect [2, 22, 3], and/or visible wavelength proxies (e.g., galaxy richness,intraclusterlight,etc;[30,31]). However,thesemethodsareunabletofullyleveragegalaxy substructurewithinclusterstoestimatetheirdarkmatterhalomasses. Therefore,wepresentagraphneuralnetwork(GNN)algorithm[32]forpredictingM forgalaxies halo insimulatedclusterenvironments1. Comparedtoprimitivemachinelearning(ML)methodslike randomforests[1],aGNNcanlearnthesubstructureinneighbouringgalaxiesandtherebyimprove halomasspredictions. OurresultsusingtheGNNdemonstratesignificantperformancegainsonthe training,validation,andanindependenttestset. 1https://github.com/Nikhil0504/halo_masses MachineLearningandthePhysicalSciencesWorkshop,NeurIPS2024. 4202 voN 91 ]AG.hp-ortsa[ 1v92621.1142:viXra",
    "body": "Estimating Dark Matter Halo Masses in Simulated\nGalaxy Clusters with Graph Neural Networks\nNikhilGaruda JohnF.Wu\nStewardObservatory SpaceTelescopeScienceInstitute\nUniversityofArizona 3700SanMartinDr,Baltimore,MD21218\n933NCherryAve,Tucson,AZ,85721 jowu@stsci.edu\nnikhilgaruda@arizona.edu\nDylanNelson AnnalisaPillepich\nUniversitätHeidelberg Max-Planck-InstitutfürAstronomie\nZentrumfürAstronomie,ITA, Königstuhl17,69117Heidelberg,Germany\nAlbert-Ueberle-Str. 2 pillepich@mpia.de\n69120Heidelberg,Germany\ndnelson@uni-heidelberg.de\nAbstract\nGalaxiesgrowandevolveindarkmatterhalos. Becausedarkmatterisnotvisible,\ngalaxies’ halo masses (M ) must be inferred indirectly. We present a graph\nhalo\nneural network (GNN) model for predicting M from stellar mass (M ) in\nhalo ∗\nsimulatedgalaxyclustersusingdatafromtheIllustrisTNGsimulationsuite. Unlike\ntraditionalmachinelearningmodelslikerandomforests,ourGNNcapturesthe\ninformation-rich substructure of galaxy clusters by using spatial and kinematic\nrelationshipsbetweengalaxyneighbour.AGNNmodeltrainedontheTNG-Cluster\ndataset and independently tested on the TNG300 simulation achieves superior\npredictiveperformancecomparedtootherbaselinemodelswetested. Futurework\nwillextendthisapproachtodifferentsimulationsandrealobservationaldatasetsto\nfurthervalidatetheGNNmodel’sabilitytogeneralise.\n1 Introduction\nIntheLambdaColdDarkMattercosmologicalmodel[28,4],galaxiesformandevolveindarkmatter\nhalos. Cosmologicalsimulationsdemonstratethatgalaxiesgrowintandemwiththeirdarkmatter\nhalosaccordingtowell-measuredandtightscalingrelations[39]. Thisinterdependencebetween\nstellarmass(M )andsubhalomass(M )isknownasthestellar–halomassrelation(SHMR).\n∗ halo\nWhileM isobservable,M mustoftenbeinferredindirectlyviatheSHMRduetoobservational\n∗ halo\nconstraints. Forexample,galaxyclusters—themostmassivegravitationallyboundobjectsinthe\nUniverse—aredarkmatterdominated,buttheirtotalmassmustbemeasuredviagravitationallensing\n[8, 37], the Sunyaev-Zel’dovich effect [2, 22, 3], and/or visible wavelength proxies (e.g., galaxy\nrichness,intraclusterlight,etc;[30,31]). However,thesemethodsareunabletofullyleveragegalaxy\nsubstructurewithinclusterstoestimatetheirdarkmatterhalomasses.\nTherefore,wepresentagraphneuralnetwork(GNN)algorithm[32]forpredictingM forgalaxies\nhalo\ninsimulatedclusterenvironments1. Comparedtoprimitivemachinelearning(ML)methodslike\nrandomforests[1],aGNNcanlearnthesubstructureinneighbouringgalaxiesandtherebyimprove\nhalomasspredictions. OurresultsusingtheGNNdemonstratesignificantperformancegainsonthe\ntraining,validation,andanindependenttestset.\n1https://github.com/Nikhil0504/halo_masses\nMachineLearningandthePhysicalSciencesWorkshop,NeurIPS2024.\n4202\nvoN\n91\n]AG.hp-ortsa[\n1v92621.1142:viXra\nFigure1: FlowdiagramofGNNarchitectureusedforhalomassprediction. TheGNNprocesses\nnodefeatures(x ,x )andedgefeatures(ϵ )throughmultipleunsharedlayers,whereeachlayer\ni j ij\napplies learnable functions, ϕ, which are implemented as MLPs. These unshared layers operate\n(cid:76)\ninparallelacrossthegraphstructure. Apoolinglayerthenaggregates( )theinformationfrom\ntheseinteractionsbackintoeachnode. SubsequentrepetitionsoftheseGNNlayerscangiveitmore\nrepresentationalpower. Finally,theoutputMLP,ψ,combinesnodefeaturesandaggregatededge\nfeaturestopredicteachnode’shalomass.\n2 IllustrisTNGSimulationData\nThesimulationdataweusearelarge-volume,cosmological,gravo-magnetohydrodynamicalsim-\nulations from the IllustrisTNG simulation suite [25]. We specifically use the TNG-Cluster [24]\nsimulation,acollectionofzoom-insimulationscentered352ofthemostmassivehalos(i.e.,galaxy\nclusters),fortrainingandvalidation. OurdatasetisbasedontheSUBFIND[35]subhalocatalogsthat\nwereobtainedfromsnapshot99(z =0),focusingonthehigh-resolutioncomponentsofthezoom-in\nsimulation. Weadoptcosmologicalparametersfrom[29],usingH = 67.74kms−1 Mpc−1 for\n0\nconsistencywiththeIllustrisTNGsimulationsuite. AdditionaldetailsabouttheTNG-Clustertraining\ndataareprovidedinAppendixA.ThedistributionofsubhalosinTNG-ClusterisshowninFigure4,\nandtheselectioncriteriaandnumberofsamplesaredescribedinTable2.\nWetestourMLmodelsonanindependentdataset,theIllustrisTNG300-1hydrodynamicsimulation\n(hereafterTNG300; [25]). TheTNG-ClusterandTNG300simulationsusethesamephysicsand\nhavecomparableresolutions(intheformer’szoom-inregions),butthetwosimulationsareotherwise\nindependent. WhenreportingTNG-Clustercross-validationresultsTNG300testsetresults,weonly\nconsidergalaxieswithin10MpcofallclusterswithM >1014M .\nhalo ⊙\n3 Methods/Experiments\nTheprimaryobjectiveofourstudyistoestimateM fromM . Buildingontheworkof[18],we\nhalo ∗\ntrainMLmodelsongalaxiesanddarkmatterhalosfromTNG-Clustertoprobeclusterenvironments.\nLossFunctionsandEvaluationMetrics. Modelperformanceisassessedusingseveralmetrics\n(presentedinTable1). SimplemodelsaretrainedtominimisetheMeanSquaredError(MSE),while\ntheGNNisoptimisedusingGaussiannegativelog-likelihood(combiningMSEandlog-variance\nterms, per [15])2. Validation and test performance are evaluated with Root Mean Squared Error\n(RMSE),MeanAbsoluteError(MAE),coefficientofdeterminationR2,NormalisedMedianAbsolute\nDeviation(NMAD),averageoffset(Bias),andOutlierFraction(f ).\noutlier\nRandomForestBaselineModels. Toestablishabenchmarkforsubsequentcomparisonswithour\nGNNmodel,weuseRandomForest(RF)regression[14]asabaselinemodelduetoitscapabilityto\nhandlecomplexnon-linearrelationshipsbetweenfeatures. TofurtheraugmentthesimpleRFmodel,\nwecomputeanoverdensityparameter(∆ ),definedasthesumofstellarmasseswithinaspecified\nG\nradiusR . TheRFmodelsareconfiguredwith100estimatorsusingscikit-learn[27],oneof\nmax\nwhichutilisesM ,andonewhichusesbothM and∆ asfeatures.\n∗ ∗ G\nGraph Neural Networks. In our GNN model, each node represents a galaxy, with the M as\n∗\nthesolenodefeature. Weconstructedgesbetweengalaxypairsseparatedbylessthan3Mpc[41],\nconnectingneighbouringnodes. Theseconnectionsenabletheneuralnetworktolearninteractions\nbetweenthesubstructureandgalaxypropertieswithinthecluster. Weprovidetwoedgefeaturesto\nincorporateboththespatialandkinematicseparationsofgalaxies: thesquaredEuclideandistance\nbetweenpairsofgalaxypositions,andpairsofrelativeline-of-sightvelocities.\nGNNArchitecture. OurGNNfollowsthearchitecturedescribedin[41]with8unsharedlayers\nand3sequentiallayers, asshowninFigure1. Eachlayeriscomposedofatwo-layerMLPwith\n2Thenegativelog-likelihoodobjectiveaccountsfortheintrinsicallyvaryingscatterinM .\nhalo\n2\n(a) Predicted versus true M halo for the TNG-Cluster (b)PredictedversustrueM halo fortheTNG300test\nvalidationset,colouredbydistancefromclustercenter. set,colouredbydistancefromclustercenter.\nFigure2: Foreachsubfigure,weshowresultsfortheRFwithonlyM asafeature(left),theRFwith\n∗\nM andoverdensityparameter∆ (center),andtheGNNwithM andgraphconnectivity(right).\n∗ G ∗\nTable1: Validationandtestsetperformanceforallmodels. Thebestmetricsareunderlined.\nModel RMSE MAE R2 Bias foutlier NMAD\nTNG-Clustercross-validation\n(Alwayspredictmean) 0.542 0.396 0 0 0.019 0.479\nRF:M\n∗\n0.489\n±0.002\n0.382\n±0.003\n0.186\n±0.011\n−0.067\n±0.006\n0.008\n±0.001\n0.463\n±0.005\nRF:M ∗+∆\nG\n0.385\n±0.002\n0.301\n±0.002\n0.490\n±0.007\n−0.124\n±0.004\n0.008\n±0.000\n0.367\n±0.002\nGNN 0.273 ±0.010 0.209 ±0.009 0.745 ±0.019 −0.085 ±0.027 0.013 ±0.002 0.246 ±0.013\nTNG-300testset\n(Alwayspredictmean) 0.466 0.351 0 0 0.021 0.422\nRF 0.468 ±0.009 0.365 ±0.014 0.199 ±0.030 −0.200 ±0.017 0.009 ±0.003 0.456 ±0.033\nRF:M ∗+∆\nG\n0.344\n±0.003\n0.256\n±0.003\n0.567\n±0.007\n−0.048\n±0.001\n0.022\n±0.001\n0.293\n±0.006\nGNN 0.242 ±0.013 0.184 ±0.010 0.785 ±0.023 −0.039 ±0.034 0.014 ±0.002 0.217 ±0.014\nNote:TheintrinsicscatterinM rangesfrom0.42(atlog(M )=11M )to0.33(at\nhalo halo ⊙\nlog(M )=13M )dexinTNG-Clusterand0.48dexto0.19dexinTNG300respectively.\nhalo ⊙\n16hiddenchannels,SiLUactivations[12],and16outputs. Theseoperateoveredgesconnectedto\neachnode, usingmaxpoolingtoaggregateedgeinformationtoeachnode3. Thenodeoutputis\nconcatenatedwithitsinitialfeature(M )andpassedthrougha3-layerMLP.TheGNNpredictstwo\n∗\nquantities[15]: M andtheexpectedlogvarianceofM atagivenM .\nhalo halo ∗\nGNNOptimisation. WeemploytheMETISalgorithmtopartitionthetrainingsetinto48parts\n(seeClusterLoaderclassinPyTorchGeometric[6,11]),allowingustohandlelargegraphdatasets\nefficiently. ThemodelistrainedwiththeAdamWoptimiser[19]ataninitiallearningrateof10−2\nandweightdecayof10−4. Aschedulerreducesthelearningrateby0.2ifvalidationlossstagnatesby\n10−3for15epochs. Earlystoppingoccursafter35epochsofnoimprovement,withamaximumof\n300epochs. OnanNvidiaA6000GPU,trainingtakes20minutesandinferencetakesunder1second.\n4 Results\nTable 1 compares model performance for predicting M from galaxies residing in clusters for\nhalo\nthevalidationandtestdatasets. WeadditionallyshowthescatterofM inthefirstrow,which\nhalo\nrepresentsthemostnaive“prediction”ofthesamplemean. Below,wepresenttheresultsforthe\nbaselinemodelsandGNNmodel. Wedisplayscatterplotsofthetrueversuspredictedmassesforthe\nTNG-Clustercross-validationdatasetinFigure2aandTNG300testsetinFigure2b.\nThesimplestRFmodelexhibitshigherrorandverylowpredictivepower.4 Whenweaugmentthe\nRFmodelwith∆ ,theperformanceimproves,demonstratingthatgalaxyenvironmentscontainvital\nG\ninformationfortheSHMR.Nonetheless,theRFmodelssystematicallyunderpredictM forthe\nhalo\nhighest-massgalaxiesandyieldhigherror.\nGNNs greatly outperform RF models, as indicated by the right-most panels of Figures 2a and\n2b. RunningthesameexperimentsusingXGBoost(whichismorepronetooverfitting),wefinda\nsignificantimprovementoverRFbutnotenoughtosurpassGNNs.WefindthattheGNNperformance\nonthetrainingandvalidationsetstranslatestoaccuratepredictionsontheindependenttestset. For\nnearlyallmetricsinTable1,theGNNoutperformstheRFmodelsforcross-validationandtestsets.\n3ThishelpstheGNNtoeffectivecapturetheneighbouringfeatures.\n4Infact,fortheTNG300testset,thesimplestRFmodelproducesevenhighererrorthanthescatterinherent\ntothedata.WeascribethistotheRFmodel’ssignificantnegativebias(i.e.,systematicunderprediction).\n3\nFigure3: ValidationsetRMSEasafunctionofdistancefromclustercenter. Resultsshownforthe\nGNN(blue)andRFwithM and∆ (orange).\n∗ G\n5 Discussion\n5.1 Modelperformanceasafunctionoflocalenvironment\nInFigure3,weshowthecross-validationRMSEasafunctionofdistancefromtheclustercenter\nfortheGNNandRF(M and∆ )models; theGNNsignificantlyoutperformstheRFacrossall\n∗ G\ndistancebins. Notably,theRFmodelperformancesuffersforgalaxiesclosertothecenterofthe\ncluster. OnepotentialexplanationforthisdiscrepancyisthattheRFdoesnotaccountforthedense\nclusterenvironment,whereinteractionssuchastidalstrippingcanleadtosignificantlossofM .5\nhalo\nIncontrast,theGNNmodeloutperformstheRFduebyleveraginginformationfromgalaxypairwise\ndistancesandline-of-sightvelocities.\n5.2 Comparisonagainstpreviouswork\nPreviousstudieshaveusedMLtoestimategalaxypropertiesfromdarkmatterhalos[16,1],i.e. the\ninverseoftheproblemwetackle. Someworksemployfeatureimportancefromdecisiontree-based\nmethods [21, 41], while others use reinforcement learning to connect halo properties to galaxies\n[23]. Convolutionalneuralnetworks(CNNs)andGNNshavealsobeenusedtopredictgalaxystellar\nmassesfromsimulatedhalos[5,40,41].\nSeveralworkshaveusedMLmethodstopredictclusterhalomassesfromobservableparameters\nsuchasX-raybrightnessandSunyaev-Zel’dovichdecrements[26,13]. [42]comparehowdifferent\nclusterobservablesfarewhenpixelisedasinputstoaCNN.[18]useGNNstopredictM directly\nhalo\nfromgalaxypointclouds,buttheirtrainingdataset(themuchsmallerTNG50simulation)doesnot\ncontainmanyraregalaxyclusters. OurworkisthefirsttotrainandtestGNNsforpredictinghalo\nmassesintheextremelyoverdenseregimeofgalaxyclusters.\n6 Conclusions,LimitationsandFutureWork\nIn this work, we predict M for simulated galaxies using their stellar masses, 2D projected\nhalo\npositions,andline-of-sightvelocities(i.e.,x,y,v )withtheTNG-Clustersimulationfortrainingand\nz\nTNG300fortesting. WeevaluatedbothRandomForest(RF)modelsandGraphNeuralNetworks\n(GNNs). Thekeyfindingsare:\n1. TheGNNmodelsignificantlyoutperformsRFmodel,evenwhenthelatterisprovided∆\nG\nasaparameter. ThissuggeststhatGNNscapturetheunderlyingspatialrelationshipsand\nsubstructureswithinclusters,asshowninTable1andFigures2and3.\n2. TheGNNmaintainsitspredictivepowerwhentestedontheindependentTNG300dataset,\ndemonstratingthatthemodelgeneralisesacrosstheIllustrisTNGsimulationsuite.\nDespiteourpromisingresults,modelstrainedononesimulationmayfacechallengeswhenapplied\ntoothersimulationsorrealobservationaldata. Machinelearningmodelsareoftensusceptibleto\ndomain shift, where their performance degrades when applied to datasets that differ from their\ntrainingdata[36,17]. Inourcase, thecomparableperformancebetweentheTNG-Clustercross-\nvalidationandTNG300testdatasetssuggeststhattheGNNmodelmayberobusttodomainshift\n5Duetoline-of-sighteffects,notallgalaxiesatsmallprojecteddistancesexperiencesignificanttidalstripping.\n4\nwithin the IllustrisTNG suite. This robustness could be attributed to the GNN’s ability to learn\ngeneralizable symbolic relationships [10]. Further tests using other simulation physics or with\nobserved datasets (e.g., galaxies at other redshifts) are needed before we can conclude that this\nmethodisfullygeneralizable.\nInfuturework,wewillaccountforobservationaleffectslikecontaminatinggalaxiesinprojection,\nmissingdata,andphotometricredshiftuncertainties,aswellasbroaderconcernsaboutdomainshift\ninML(seee.g. [7]). Asidefromadditionalvalidationonothercosmologicalsimulations[33],we\nwilltestonobservationaldatausingpublishedM estimatesforwell-knowngalaxyclusters(e.g.,\nhalo\n[20,38]). WithupcomingtelescopesliketheRomanSpaceTelescope[34]andRubinObservatory\n[9], we will be able to study GNN applications to large galaxy cluster samples in the wide-field\ndomain.\nReferences\n[1] ShankarAgarwal,RomeelDavé,andBruceABassett. Paintinggalaxiesintodarkmatterhaloes\nusingmachinelearning. MonthlyNoticesoftheRoyalAstronomicalSociety,478(3):3410–3422,\nAugust2018.\n[2] MarkBirkinshaw. TheSunyaev–Zel’dovicheffect. PhysicsReports,310(2):97–195,March\n1999.\n[3] L.E.Bleem,B.Stalder,T.deHaan,K.A.Aird,S.W.Allen,D.E.Applegate,M.L.N.Ashby,\nM.Bautz,M.Bayliss,B.A.Benson,S.Bocquet,M.Brodwin,J.E.Carlstrom,C.L.Chang,\nI.Chiu,H.M.Cho,A.Clocchiatti,T.M.Crawford,A.T.Crites,S.Desai,J.P.Dietrich,M.A.\nDobbs, R. J. Foley, W. R. Forman, E. M. George, M. D. Gladders, A. H. Gonzalez, N. W.\nHalverson, C. Hennig, H. Hoekstra, G. P. Holder, W. L. Holzapfel, J. D. Hrubes, C. Jones,\nR. Keisler, L. Knox, A. T. Lee, E. M. Leitch, J. Liu, M. Lueker, D. Luong-Van, A. Mantz,\nD. P. Marrone, M. McDonald, J. J. McMahon, S. S. Meyer, L. Mocanu, J. J. Mohr, S. S.\nMurray,S.Padin,C.Pryke,C.L.Reichardt,A.Rest,J.Ruel,J.E.Ruhl,B.R.Saliwanchik,\nA.Saro,J.T.Sayre,K.K.Schaffer,T.Schrabback,E.Shirokoff,J.Song,H.G.Spieler,S.A.\nStanford,Z.Staniszewski,A.A.Stark,K.T.Story,C.W.Stubbs,K.Vanderlinde,J.D.Vieira,\nA.Vikhlinin,R.Williamson,O.Zahn,andA.Zenteno. GalaxyClustersDiscoveredviathe\nSunyaev-Zel’dovich Effect in the 2500-Square-Degree SPT-SZ Survey. The Astrophysical\nJournalSupplementSeries,216(2):27,February2015.\n[4] James S. Bullock and Michael Boylan-Kolchin. Small-Scale Challenges to the Λ CDM\nParadigm. AnnualReviewofAstronomyandAstrophysics,55(1):343–387,August2017.\n[5] UrmilaChadayammuri,MichelleNtampaka,JohnZuHone,ÁkosBogdán,andRalphP.Kraft.\nPaintingbaryonsontoN-bodysimulationsofgalaxyclusterswithimage-to-imagedeeplearning.\nMonthlyNoticesoftheRoyalAstronomicalSociety,526(2):2812–2829,December2023.\n[6] Wei-LinChiang, XuanqingLiu, SiSi, YangLi, SamyBengio, andCho-JuiHsieh. Cluster-\nGCN:AnEfficientAlgorithmforTrainingDeepandLargeGraphConvolutionalNetworks. In\nProceedingsofthe25thACMSIGKDDInternationalConferenceonKnowledgeDiscovery&\nDataMining,pages257–266,July2019.\n[7] A.C´iprijanovic´,D.Kafkes,K.Downey,S.Jenkins,G.N.Perdue,S.Madireddy,T.Johnston,\nG. F. Snyder, and B. Nord. DeepMerge - II. Building robust deep learning algorithms for\nmerging galaxy identification across domains. Monthly Notices of the Royal Astronomical\nSociety,506(1):677–691,September2021.\n[8] DouglasClowe,MarušaBradacˇ,AnthonyH.Gonzalez,MaximMarkevitch,ScottW.Randall,\nChristineJones,andDennisZaritsky. ADirectEmpiricalProofoftheExistenceofDarkMatter.\nTheAstrophysicalJournal,648(2):L109–L113,September2006.\n[9] LSSTDarkEnergyScienceCollaboration. LargeSynopticSurveyTelescope: DarkEnergy\nScienceCollaboration,November2012.\n[10] Miles Cranmer, Alvaro Sanchez-Gonzalez, Peter Battaglia, Rui Xu, Kyle Cranmer, David\nSpergel,andShirleyHo. DiscoveringSymbolicModelsfromDeepLearningwithInductive\nBiases,2020.\n[11] MatthiasFeyandJanEricLenssen. FastGraphRepresentationLearningwithPyTorchGeomet-\nric,2019.\n5\n[12] DanHendrycksandKevinGimpel. GaussianErrorLinearUnits(GELUs),2016.\n[13] MatthewHo,JohnSoltis,AryaFarahi,DaisukeNagai,AugustEvrard,andMichelleNtampaka.\nBenchmarks and explanations for deep learning estimates of X-ray galaxy cluster masses.\nMonthlyNoticesoftheRoyalAstronomicalSociety,524(3):3289–3302,September2023.\n[14] TinKamHo. Randomdecisionforests. InProceedingsof3rdInternationalConferenceon\nDocumentAnalysisandRecognition,volume1,pages278–282vol.1,August1995.\n[15] Niall Jeffrey and Benjamin D. Wandelt. Solving high-dimensional parameter inference:\nMarginalposteriordensities&amp;MomentNetworks,2020.\n[16] HarshilM.Kamdar,MatthewJ.Turk,andRobertJ.Brunner.Machinelearningandcosmological\nsimulations–I.Semi-analyticalmodels. MonthlyNoticesoftheRoyalAstronomicalSociety,\n455(1):642–658,January2016.\n[17] WouterM.KouwandMarcoLoog. Anintroductiontodomainadaptationandtransferlearning,\nJanuary2019.\n[18] Austin J. Larson, John F. Wu, and Craig Jones. Predicting dark matter halo masses from\nsimulatedgalaxyimagesandenvironments,July2024.\n[19] IlyaLoshchilovandFrankHutter. DecoupledWeightDecayRegularization,January2019.\n[20] J.M.Lotz,A.Koekemoer,D.Coe,N.Grogin,P.Capak,J.Mack,J.Anderson,R.Avila,E.A.\nBarker,D.Borncamp,G.Brammer,M.Durbin,H.Gunning,B.Hilbert,H.Jenkner,H.Khan-\ndrika, Z. Levay, R. A. Lucas, J. MacKenty, S. Ogaz, B. Porterfield, N. Reid, M. Robberto,\nP.Royle,L.J.Smith,L.J.Storrie-Lombardi,B.Sunnquist,J.Surace,D.C.Taylor,R.Williams,\nJ.Bullock,M.Dickinson,S.Finkelstein,P.Natarajan,J.Richard,B.Robertson,J.Tumlinson,\nA.Zitrin,K.Flanagan,K.Sembach,B.T.Soifer,andM.Mountain. TheFrontierFields: Survey\nDesignandInitialResults. TheAstrophysicalJournal,837(1):97,March2017.\n[21] ChristopherC.Lovell,StephenM.Wilkins,PeterA.Thomas,MatthieuSchaller,CarltonM.\nBaugh,GiulioFabbian,andYannickBahé. Amachinelearningapproachtomappingbaryons\nontodarkmatterhaloesusingtheEAGLEandC-EAGLEsimulations. MonnthlyNoticesofthe\nRoyalAstronomicalSociety,509(4):5046–5061,February2022.\n[22] Tobias A. Marriage, Viviana Acquaviva, Peter A. R. Ade, Paula Aguirre, Mandana Amiri,\nJohnWilliamAppel,L.FelipeBarrientos,EliaS.Battistelli,J.RichardBond,BenBrown,Bryce\nBurger,JayChervenak,SudeepDas,MarkJ.Devlin,SimonR.Dicker,W.BertrandDoriese,\nJoannaDunkley,RolandoDünner,ThomasEssinger-Hileman,RyanP.Fisher,JosephW.Fowler,\nAmirHajian,MarkHalpern,MatthewHasselfield,CarlosHernández-Monteagudo,GeneC.\nHilton,MattHilton,AdamD.Hincks,RenéeHlozek,KevinM.Huffenberger,DavidHandel\nHughes,JohnP.Hughes,LeopoldoInfante,KentD.Irwin,JeanBaptisteJuin,MadhuriKaul,\nJeffKlein,ArthurKosowsky,JudyM.Lau,MicheleLimon,Yen-TingLin,RobertH.Lupton,\nDanicaMarsden,KristaMartocci,PhilMauskopf,FelipeMenanteau,KavilanMoodley,Harvey\nMoseley,CalvinB.Netterfield,MichaelD.Niemack,MichaelR.Nolta,LymanA.Page,Lucas\nParker,BrucePartridge,HernanQuintana,ErikD.Reese,BethReid,NeelimaSehgal,BlakeD.\nSherwin,JonSievers,DavidN.Spergel,SuzanneT.Staggs,DanielS.Swetz,EricR.Switzer,\nRobertThornton,HyTrac,CaroleTucker,RyanWarne,GrantWilson,EdWollack,andYue\nZhao. TheAtacamaCosmologyTelescope: Sunyaev-Zel’dovich-SelectedGalaxyClustersat\n148GHzinthe2008Survey. TheAstrophysicalJournal,737(2):61,August2011.\n[23] BenjaminPMoster,ThorstenNaab,MagnusLindström,andJosephAO’Leary. GalaxyNet:\nConnecting galaxies and dark matter haloes with deep neural networks and reinforcement\nlearninginlargevolumes. MonthlyNoticesoftheRoyalAstronomicalSociety,507(2):2115–\n2136,October2021.\n[24] DylanNelson,AnnalisaPillepich,MohammadrezaAyromlou,WonkiLee,KatrinLehle,Eric\nRohr,andNhutTruong. IntroducingtheTNG-Clustersimulation: Overviewandthephysical\npropertiesofthegaseousintraclustermedium. Astronomy&Astrophysics, 686:A157, June\n2024.\n[25] DylanNelson,VolkerSpringel,AnnalisaPillepich,VicenteRodriguez-Gomez,PaulTorrey,Shy\nGenel,MarkVogelsberger,RuedigerPakmor,FedericoMarinacci,RainerWeinberger,Luke\nKelley, Mark Lovell, Benedikt Diemer, and Lars Hernquist. The IllustrisTNG simulations:\nPublicdatarelease. ComputationalAstrophysicsandCosmology,6(1):2,May2019.\n6\n[26] M.Ntampaka,J.ZuHone,D.Eisenstein,D.Nagai,A.Vikhlinin,L.Hernquist,F.Marinacci,\nD.Nelson,R.Pakmor,A.Pillepich,P.Torrey,andM.Vogelsberger.ADeepLearningApproach\ntoGalaxyClusterX-RayMasses. TheAstrophysicalJournal,876(1):82,May2019.\n[27] FabianPedregosa,GaëlVaroquaux,AlexandreGramfort,VincentMichel,BertrandThirion,\nOlivierGrisel,MathieuBlondel,PeterPrettenhofer,RonWeiss,VincentDubourg,JakeVander-\nplas,AlexandrePassos,DavidCournapeau,MatthieuBrucher,MatthieuPerrot,andÉdouard\nDuchesnay. Scikit-learn: MachineLearninginPython. JournalofMachineLearningResearch,\n12(85):2825–2830,2011.\n[28] P. J. E. Peebles. Tests of cosmological models constrained by inflation. The Astrophysical\nJournal,284:439,September1984.\n[29] PlanckCollaboration,P.A.R.Ade,N.Aghanim,M.Arnaud,M.Ashdown,J.Aumont,C.Bacci-\ngalupi,A.J.Banday,R.B.Barreiro,J.G.Bartlett,N.Bartolo,E.Battaner,R.Battye,K.Benabed,\nA.Benoît,A.Benoit-Lévy,J.-P.Bernard,M.Bersanelli,P.Bielewicz,J.J.Bock,A.Bonaldi,\nL.Bonavera,J.R.Bond,J.Borrill,F.R.Bouchet,F.Boulanger,M.Bucher,C.Burigana,R.C.\nButler,E.Calabrese,J.-F.Cardoso,A.Catalano,A.Challinor,A.Chamballu,R.-R.Chary,H.C.\nChiang,J.Chluba,P.R.Christensen,S.Church,D.L.Clements,S.Colombi,L.P.L.Colombo,\nC.Combet,A.Coulais,B.P.Crill,A.Curto,F.Cuttaia,L.Danese,R.D.Davies,R.J.Davis,\nP.DeBernardis,A.DeRosa,G.DeZotti,J.Delabrouille,F.-X.Désert,E.DiValentino,C.Dick-\ninson,J.M.Diego,K.Dolag,H.Dole,S.Donzelli,O.Doré,M.Douspis,A.Ducout,J.Dunkley,\nX. Dupac, G. Efstathiou, F. Elsner, T. A. Enßlin, H. K. Eriksen, M. Farhang, J. Fergusson,\nF.Finelli,O.Forni,M.Frailis,A.A.Fraisse,E.Franceschi,A.Frejsel,S.Galeotta,S.Galli,\nK. Ganga, C. Gauthier, M. Gerbino, T. Ghosh, M. Giard, Y. Giraud-Héraud, E. Giusarma,\nE. Gjerløw, J. González-Nuevo, K. M. Górski, S. Gratton, A. Gregorio, A. Gruppuso, J. E.\nGudmundsson, J. Hamann, F. K. Hansen, D. Hanson, D. L. Harrison, G. Helou, S. Henrot-\nVersillé, C. Hernández-Monteagudo, D. Herranz, S. R. Hildebrandt, E. Hivon, M. Hobson,\nW. A. Holmes, A. Hornstrup, W. Hovest, Z. Huang, K. M. Huffenberger, G. Hurier, A. H.\nJaffe,T.R.Jaffe,W.C.Jones,M.Juvela,E.Keihänen,R.Keskitalo,T.S.Kisner,R.Kneissl,\nJ.Knoche,L.Knox,M.Kunz,H.Kurki-Suonio,G.Lagache,A.Lähteenmäki,J.-M.Lamarre,\nA.Lasenby,M.Lattanzi,C.R.Lawrence,J.P.Leahy,R.Leonardi,J.Lesgourgues,F.Levrier,\nA. Lewis, M. Liguori, P. B. Lilje, M. Linden-Vørnle, M. López-Caniego, P. M. Lubin, J. F.\nMacías-Pérez,G.Maggio,D.Maino,N.Mandolesi,A.Mangilli,A.Marchini,M.Maris,P.G.\nMartin,M.Martinelli,E.Martínez-González,S.Masi,S.Matarrese,P.McGehee,P.R.Mein-\nhold,A.Melchiorri,J.-B.Melin,L.Mendes,A.Mennella,M.Migliaccio,M.Millea,S.Mitra,\nM.-A.Miville-Deschênes,A.Moneti,L.Montier,G.Morgante,D.Mortlock,A.Moss,D.Mun-\nshi,J.A.Murphy,P.Naselsky,F.Nati,P.Natoli,C.B.Netterfield,H.U.Nørgaard-Nielsen,\nF.Noviello,D.Novikov,I.Novikov,C.A.Oxborrow,F.Paci,L.Pagano,F.Pajot,R.Paladini,\nD. Paoletti, B. Partridge, F. Pasian, G. Patanchon, T. J. Pearson, O. Perdereau, L. Perotto,\nF. Perrotta, V. Pettorino, F. Piacentini, M. Piat, E. Pierpaoli, D. Pietrobon, S. Plaszczynski,\nE. Pointecouteau, G. Polenta, L. Popa, G. W. Pratt, G. Prézeau, S. Prunet, J.-L. Puget, J. P.\nRachen,W.T.Reach,R.Rebolo,M.Reinecke,M.Remazeilles,C.Renault,A.Renzi,I.Ristor-\ncelli,G.Rocha,C.Rosset,M.Rossetti,G.Roudier,B.Rouilléd’Orfeuil,M.Rowan-Robinson,\nJ. A. Rubiño-Martín, B. Rusholme, N. Said, V. Salvatelli, L. Salvati, M. Sandri, D. Santos,\nM.Savelainen,G.Savini,D.Scott,M.D.Seiffert,P.Serra,E.P.S.Shellard,L.D.Spencer,\nM.Spinelli,V.Stolyarov,R.Stompor,R.Sudiwala,R.Sunyaev,D.Sutton,A.-S.Suur-Uski,J.-F.\nSygnet,J.A.Tauber,L.Terenzi,L.Toffolatti,M.Tomasi,M.Tristram,T.Trombetti,M.Tucci,\nJ.Tuovinen,M.Türler,G.Umana,L.Valenziano,J.Valiviita,F.VanTent,P.Vielva,F.Villa,\nL.A.Wade,B.D.Wandelt,I.K.Wehus,M.White,S.D.M.White,A.Wilkinson,D.Yvon,\nA.Zacchei,andA.Zonca. Planck2015results: XIII.Cosmologicalparameters. Astronomy&\nAstrophysics,594:A13,October2016.\n[30] E. S. Rykoff, E. Rozo, M. T. Busha, C. E. Cunha, A. Finoguenov, A. Evrard, J. Hao, B. P.\nKoester, A. Leauthaud, B. Nord, M. Pierre, R. Reddick, T. Sadibekova, E. S. Sheldon, and\nR.H.Wechsler. redMaPPer.I.AlgorithmandSDSSDR8Catalog. TheAstrophysicalJournal,\n785(2):104,April2014.\n[31] H. Sampaio-Santos, Y. Zhang, R. L. C. Ogando, T. Shin, Jesse B. Golden-Marx, B. Yanny,\nK. Herner, M. Hilton, A. Choi, M. Gatti, D. Gruen, B. Hoyle, M. M. Rau, J. De Vicente,\nJ. Zuntz, T. M. C. Abbott, M. Aguena, S. Allam, J. Annis, S. Avila, E. Bertin, D. Brooks,\nD. L. Burke, M. Carrasco Kind, J. Carretero, C. Chang, M. Costanzi, L. N. da Costa, H. T.\n7\nDiehl,P.Doel,S.Everett,A.E.Evrard,B.Flaugher,P.Fosalba,J.Frieman,J.García-Bellido,\nE.Gaztanaga,D.W.Gerdes,R.A.Gruendl,J.Gschwend,G.Gutierrez,S.R.Hinton,D.L.\nHollowood, K. Honscheid, D. J. James, M. Jarvis, T. Jeltema, K. Kuehn, N. Kuropatkin,\nO.Lahav,M.A.G.Maia,M.March,J.L.Marshall,R.Miquel,A.Palmese,F.Paz-Chinchón,\nA. A. Plazas, E. Sanchez, B. Santiago, V. Scarpine, M. Schubnell, M. Smith, E. Suchyta,\nG.Tarle,D.L.Tucker,T.N.Varga,andR.H.Wechsler. Isdiffuseintraclusterlightagood\ntracerofthegalaxyclustermatterdistribution? MonthlyNoticesoftheRoyalAstronomical\nSociety,501(1):1300–1315,February2021.\n[32] F.Scarselli,M.Gori,AhChungTsoi,M.Hagenbuchner,andG.Monfardini. TheGraphNeural\nNetworkModel. IEEETransactionsonNeuralNetworks,20(1):61–80,January2009.\n[33] JoopSchaye,RoiKugel,MatthieuSchaller,JohnC.Helly,JoeyBraspenning,WillemElbers,\nIanG.McCarthy,MarcelP.vanDaalen,BertVandenbroucke,CarlosS.Frenk,JulianaKwan,\nJaimeSalcido, YannickM.Bahé, JoshBorrow,EvgeniiChaikin, OliverHahn,FilipHuško,\nAdrianJenkins,CedricG.Lacey,andFolkertS.J.Nobels.TheFLAMINGOproject:Cosmolog-\nicalhydrodynamicalsimulationsforlarge-scalestructureandgalaxyclustersurveys. Monthly\nNoticesoftheRoyalAstronomicalSociety,526(4):4978–5020,October2023.\n[34] D.Spergel,N.Gehrels,C.Baltay,D.Bennett,J.Breckinridge,M.Donahue,A.Dressler,B.S.\nGaudi, T. Greene, O. Guyon, C. Hirata, J. Kalirai, N. J. Kasdin, B. Macintosh, W. Moos,\nS. Perlmutter, M. Postman, B. Rauscher, J. Rhodes, Y. Wang, D. Weinberg, D. Benford,\nM.Hudson,W.S.Jeong,Y.Mellier,W.Traub,T.Yamada,P.Capak,J.Colbert,D.Masters,\nM. Penny, D. Savransky, D. Stern, N. Zimmerman, R. Barry, L. Bartusek, K. Carpenter,\nE.Cheng,D.Content,F.Dekens,R.Demers,K.Grady,C.Jackson,G.Kuan,J.Kruk,M.Melton,\nB.Nemati,B.Parvin,I.Poberezhskiy,C.Peddie,J.Ruffa,J.K.Wallace,A.Whipple,E.Wollack,\nandF.Zhao. Wide-fieldinfrarredsurveytelescope-astrophysicsfocusedtelescopeassetswfirst-\nafta2015report,2015.\n[35] VolkerSpringel,SimonD.M.White,GiuseppeTormen,andGuinevereKauffmann.Populatinga\nclusterofgalaxies-I.Resultsat\\fontshape{it}{z}=0.MonthlyNoticesoftheRoyalAstronomical\nSociety,328(3):726–750,December2001.\n[36] BaochenSun,JiashiFeng,andKateSaenko. Returnoffrustratinglyeasydomainadaptation.\nInProceedingsoftheThirtiethAAAIConferenceonArtificialIntelligence,AAAI’16,pages\n2058–2065,Phoenix,Arizona,February2016.AAAIPress.\n[37] S.Vegetti,S.Birrer,G.Despali,C.D.Fassnacht,D.Gilman,Y.Hezaveh,L.PerreaultLevasseur,\nJ.P.McKean,D.M.Powell,C.M.O’Riordan,andG.Vernardos. StrongGravitationalLensing\nasaProbeofDarkMatter. SpaceScienceReviews,220(5):58,July2024.\n[38] JohnR.Weaver,SamE.Cutler,RichardPan,KatherineE.Whitaker,IvoLabbé,SedonaH.Price,\nRachel Bezanson, Gabriel Brammer, Danilo Marchesini, Joel Leja, Bingjie Wang, Lukas J.\nFurtak, Adi Zitrin, Hakim Atek, Iryna Chemerynska, Dan Coe, Pratika Dayal, Pieter van\nDokkum, Robert Feldmann, Natascha M. Förster Schreiber, Marijn Franx, Seiji Fujimoto,\nYoshinobuFudamoto,KarlGlazebrook,AnnadeGraaff,JennyE.Greene,StéphanieJuneau,\nSusanKassin,MariskaKriek,GouravKhullar,MichaelV.Maseda,LamiyaA.Mowla,Adam\nMuzzin, Themiya Nanayakkara, Erica J. Nelson, Pascal A. Oesch, Camilla Pacifici, Casey\nPapovich,DavidJ.Setton,AliceE.Shapley,HeathV.Shipley,RenskeSmit,MauroStefanon,\nEdward N. Taylor, Andrea Weibel, and Christina C. Williams. The UNCOVER Survey: A\nFirst-lookHST+JWSTCatalogof60,000GalaxiesnearA2744andbeyond. TheAstrophysical\nJournalSupplementSeries,270:7,January2024.\n[39] RisaH.WechslerandJeremyL.Tinker. TheConnectionBetweenGalaxiesandTheirDark\nMatterHalos. AnnualReviewofAstronomyandAstrophysics,56(1):435–487,September2018.\n[40] JohnF.WuandChristianKraghJespersen. Learningthegalaxy-environmentconnectionwith\ngraphneuralnetworks,June2023.\n[41] JohnF.Wu,ChristianKraghJespersen,andRisaH.Wechsler.HowtheGalaxy-HaloConnection\nDependsonLarge-ScaleEnvironment,February2024.\n[42] Z Yan, A J Mead, L Van Waerbeke, G Hinshaw, and I G McCarthy. Galaxy cluster mass\nestimationwithdeeplearningandhydrodynamicalsimulations. MonthlyNoticesoftheRoyal\nAstronomicalSociety,499(3):3445–3458,November2020.\n8\nFigure4:SpatialdistributionofhaloswithintheTNG-Clustersimulation.Themiddlepanelshowsthe\nfullsimulation,andtheleftandrightpanelshighlighttwoexamplegalaxyclusters. Theboundaries\noftheseclustersaremarkedasblueandredboxesinthemiddlepanel.\nTable2: SummaryofcutsappliedtotheTNG-Clusterdata. Here, N referstonumberofstellar\n∗\nparticles,M referstosolarmass,R referstothevirialradiusofthehalo.\n⊙ 200\nSample NumberofSubhalos\nFullTNG-Clustercatalog 10,378,451\n—withinmasscuts-N >50;log(M /M )>9.5;log(M /M )>10.5 154,120\n∗ ∗ ⊙ halo ⊙\n—within<10×R oftheclusterhalo 127,165\n200\nSelectionCriteria-log(M /M )>11;within10Mpcoftheclusterhalo\nhalo ⊙\nTNG-Clustercross-validation 60,756\nTNG300TestSet 34,689\nA TNG-ClusterAdditionalDetails\nGalaxiesintheTNG-ClustertrainingdataareshowninFigure4. Tomimicastronomicalobservations\nofgalaxies,weprojectthegalaxyclustersalongthezaxis,whichischosentobethelineofsight.\nThis procedure bridges the gap between simulation data and spectroscopic observations, which\ntypicallycapturetwospatialdimensions(x,y)andline-of-sightvelocities(v ). Wealsoapplyquality\nz\ncutstothesimulationinTable2toensureacompletesampleofmassive,well-resolvedgalaxies.\nWe split the TNG-Cluster data into training and validation sets by implementing a k-fold cross-\nvalidationstrategybasedonclusterIDsratherthantraditionalrandomsplits. Thismethodisolates\nsubhalosaccordingtotheirclusterIDswhileensuringthatallsubhalosfromasingleclusterremain\nwithinthesamefold. Onepotentialcaveatofthismethodisthatwedonotincludethecontaminating\nstructurealongtheline-of-sightfromotherclusterswhichmightbeinadifferentk-fold.\n9",
    "pdf_filename": "Estimating_Dark_Matter_Halo_Masses_in_Simulated_Galaxy_Clusters_with_Graph_Neural_Networks.pdf"
}