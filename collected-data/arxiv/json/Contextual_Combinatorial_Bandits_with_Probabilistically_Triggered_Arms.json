{
    "title": "Contextual Combinatorial Bandits with Probabilistically Triggered Arms",
    "abstract": "armedbandits(CMAB)havedrawnattentionduetofruitful Westudycontextualcombinatorialbanditswith applications in online advertising, network optimization, probabilisticallytriggeredarms(C2MAB-T)un- and healthcare systems (Gai et al., 2012; Kveton et al., deravarietyofsmoothnessconditionsthatcap- 2015a; Chen et al., 2013; 2016a; Wang & Chen, 2017; tureawiderangeofapplications,suchascontex- Merlis&Mannor,2019). CMABisasequentialdecision- tual cascading bandits and contextual influence makinggamebetweenalearningagentandanenvironment. maximizationbandits. Underthetriggeringprob- Ineachround,theagentchoosesacombinatorialactionthat abilitymodulated(TPM)condition,wedevisethe triggersasetofbasearms(i.e.,asuper-arm)tobepulled C2-UCB-Talgorithmandproposeanovelanal- √ simultaneously,andtheoutcomesofthesepulledbasearms ysis that achieves an O˜(d KT) regret bound, areobservedasfeedback(typicallyknownassemi-bandit removingapotentiallyexponentiallylargefactor feedback). The goal of the agent is to minimize the ex- O(1/p ),wheredisthedimensionofcontexts, min pectedregret,whichisthedifferenceinexpectationforthe p istheminimumpositiveprobabilitythatany min overallrewardsbetweenalwaysplayingthebestaction(i.e., arm can be triggered, and batch-size K is the the action with the highest expected reward) and playing maximumnumberofarmsthatcanbetriggered accordingtotheagent’sownpolicy. perround. Underthevariancemodulated(VM) ortriggeringprobabilityandvariancemodulated Motivatedbylarge-scaleapplicationswithahugenumber (TPVM)conditions,weproposeanewvariance- ofitems(basearms),thereexistsaprominentlineofwork adaptive algorithm VAC2-UCB and derive a re- that advances the CMAB model: the combinatorial con- √ gretboundO˜(d T),whichisindependentofthe textualbandits(orC2MABforshort) (Qinetal.,2014;Li batch-sizeK. Asavaluableby-product,ouranal- etal.,2016;Takemuraetal.,2021).Specifically,C2MABin- ysis technique and variance-adaptive algorithm corporatescontextualinformationandaddsthesimpleyet canbeappliedtotheCMAB-TandC2MABset- effective linear structure assumption to allow scalability, ting,improvingexistingresultsthereaswell. We whichprovidesregretboundsthatareindependentofthe alsoincludeexperimentsthatdemonstratetheim- numberofbasearmsm. DespiteC2MAB’ssuccessinlever- provedperformanceofouralgorithmscompared agingcontextualinformationforbetterscalability,existing withbenchmarkalgorithmsonsyntheticandreal- worksfailtoformulatethegeneralarmtriggeringprocess, worlddatasets. whichisessentialtomodelawiderrangeofapplications, e.g., cascading bandits (CB) and influence maximization (IM),andmoreimportantly,theydonotprovidesatisfying 1.Introduction resultsforsettingswithprobabilisticallytriggeredarms. For example,Qinetal.(2014);Takemuraetal.(2021)onlycon- The stochastic multi-armed bandit (MAB) problem is a siderthedeterministicsemi-banditfeedbackforC2MAB. classicalsequentialdecision-makingproblemthathasbeen Lietal.(2016);Wenetal.(2017)implicitlyconsiderthe widelystudied(Robbins,1952;Aueretal.,2002;Bubeck armtriggeringprocessforspecificCBorIMapplications butonlygivessub-optimalresultswithunsatisfyingfactors 1The Chinese University of Hong Kong, Hong Kong SAR, China2UniversityofMassachusettsAmherst,MA,UnitedStates (e.g., 1/p min,K that could be as large as the number of 3CaliforniaInstituteofTechnology,CA,UnitedStates4Microsoft base arms), owing to loose analysis, weak conditions, or Research,Beijing,China. Correspondenceto: XutongLiu<li- inefficientalgorithmsthatexploretheunknownparameters uxt@cse.cuhk.edu.hk>,WeiChen<weic@microsoft.com>,John tooconservatively. C.S.Lui<cslui@cse.cuhk.edu.hk>. Tohandletheaboveissues,weenhancetheC2MABframe- Proceedings of the 40th International Conference on Machine workbyconsideringanarmtriggeringprocess. Specifically, Learning,Honolulu,Hawaii,USA.PMLR202,2023.Copyright we propose the general framework of contextual combi- 2023bytheauthor(s). 1 4202 voN 81 ]GL.sc[ 3v01171.3032:viXra",
    "body": "Contextual Combinatorial Bandits with Probabilistically Triggered Arms\nXutongLiu1 JinhangZuo23 SiweiWang4 JohnC.S.Lui1 MohammadHajiesmaili2 AdamWierman3\nWeiChen4\nAbstract etal.,2012). AsanextensionofMAB,combinatorialmulti-\narmedbandits(CMAB)havedrawnattentionduetofruitful\nWestudycontextualcombinatorialbanditswith\napplications in online advertising, network optimization,\nprobabilisticallytriggeredarms(C2MAB-T)un-\nand healthcare systems (Gai et al., 2012; Kveton et al.,\nderavarietyofsmoothnessconditionsthatcap-\n2015a; Chen et al., 2013; 2016a; Wang & Chen, 2017;\ntureawiderangeofapplications,suchascontex-\nMerlis&Mannor,2019). CMABisasequentialdecision-\ntual cascading bandits and contextual influence\nmakinggamebetweenalearningagentandanenvironment.\nmaximizationbandits. Underthetriggeringprob-\nIneachround,theagentchoosesacombinatorialactionthat\nabilitymodulated(TPM)condition,wedevisethe\ntriggersasetofbasearms(i.e.,asuper-arm)tobepulled\nC2-UCB-Talgorithmandproposeanovelanal-\n√ simultaneously,andtheoutcomesofthesepulledbasearms\nysis that achieves an O˜(d KT) regret bound,\nareobservedasfeedback(typicallyknownassemi-bandit\nremovingapotentiallyexponentiallylargefactor\nfeedback). The goal of the agent is to minimize the ex-\nO(1/p ),wheredisthedimensionofcontexts,\nmin pectedregret,whichisthedifferenceinexpectationforthe\np istheminimumpositiveprobabilitythatany\nmin overallrewardsbetweenalwaysplayingthebestaction(i.e.,\narm can be triggered, and batch-size K is the\nthe action with the highest expected reward) and playing\nmaximumnumberofarmsthatcanbetriggered\naccordingtotheagent’sownpolicy.\nperround. Underthevariancemodulated(VM)\nortriggeringprobabilityandvariancemodulated Motivatedbylarge-scaleapplicationswithahugenumber\n(TPVM)conditions,weproposeanewvariance- ofitems(basearms),thereexistsaprominentlineofwork\nadaptive algorithm VAC2-UCB and derive a re- that advances the CMAB model: the combinatorial con-\n√\ngretboundO˜(d T),whichisindependentofthe textualbandits(orC2MABforshort) (Qinetal.,2014;Li\nbatch-sizeK. Asavaluableby-product,ouranal- etal.,2016;Takemuraetal.,2021).Specifically,C2MABin-\nysis technique and variance-adaptive algorithm corporatescontextualinformationandaddsthesimpleyet\ncanbeappliedtotheCMAB-TandC2MABset- effective linear structure assumption to allow scalability,\nting,improvingexistingresultsthereaswell. We whichprovidesregretboundsthatareindependentofthe\nalsoincludeexperimentsthatdemonstratetheim- numberofbasearmsm. DespiteC2MAB’ssuccessinlever-\nprovedperformanceofouralgorithmscompared agingcontextualinformationforbetterscalability,existing\nwithbenchmarkalgorithmsonsyntheticandreal- worksfailtoformulatethegeneralarmtriggeringprocess,\nworlddatasets. whichisessentialtomodelawiderrangeofapplications,\ne.g., cascading bandits (CB) and influence maximization\n(IM),andmoreimportantly,theydonotprovidesatisfying\n1.Introduction resultsforsettingswithprobabilisticallytriggeredarms. For\nexample,Qinetal.(2014);Takemuraetal.(2021)onlycon-\nThe stochastic multi-armed bandit (MAB) problem is a siderthedeterministicsemi-banditfeedbackforC2MAB.\nclassicalsequentialdecision-makingproblemthathasbeen Lietal.(2016);Wenetal.(2017)implicitlyconsiderthe\nwidelystudied(Robbins,1952;Aueretal.,2002;Bubeck armtriggeringprocessforspecificCBorIMapplications\nbutonlygivessub-optimalresultswithunsatisfyingfactors\n1The Chinese University of Hong Kong, Hong Kong SAR,\nChina2UniversityofMassachusettsAmherst,MA,UnitedStates (e.g., 1/p min,K that could be as large as the number of\n3CaliforniaInstituteofTechnology,CA,UnitedStates4Microsoft base arms), owing to loose analysis, weak conditions, or\nResearch,Beijing,China. Correspondenceto: XutongLiu<li- inefficientalgorithmsthatexploretheunknownparameters\nuxt@cse.cuhk.edu.hk>,WeiChen<weic@microsoft.com>,John tooconservatively.\nC.S.Lui<cslui@cse.cuhk.edu.hk>.\nTohandletheaboveissues,weenhancetheC2MABframe-\nProceedings of the 40th International Conference on Machine workbyconsideringanarmtriggeringprocess. Specifically,\nLearning,Honolulu,Hawaii,USA.PMLR202,2023.Copyright\nwe propose the general framework of contextual combi-\n2023bytheauthor(s).\n1\n4202\nvoN\n81\n]GL.sc[\n3v01171.3032:viXra\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nTable1. SummaryofthemainresultsforC2MAB-T,andadditionalresultsforCMAB-TandC2MAB.\nC2MAB-T Algorithm Condition Coefficient RegretBound\n√\nC3-UCB(Lietal.,2016)∗ 1-norm B O(B d KT ·logT/p )\n1 1 √ min\n(MainResult1) C2-UCB-T(Algorithm1) 1-normTPM B O(B d KT ·logT)\n1 √1 √\n(MainResult2) VAC2-UCB(Algorithm2) VM B † O(B d T ·logT/ p )\nv v √ min\n(MainResult3) VAC2-UCB(Algorithm2) TPVM B ,λ≥1‡ O(B d T ·logT)\nv v\nCMAB-T Algorithm Condition Coefficient RegretBound\n(cid:112)\nBCUCB-T(Liuetal.,2022) TPVM B ,λ≥1 O(B m(logK)T ·logT)\nv v\n(AdditionalResult1) BCUCB-T(Ournewanalysis) TPVM B ,λ≥1 O(B (cid:112) m(logK)T ·(logT)1/2)∗∗\nv v\nC2MAB Algorithm Condition Coefficient RegretBound\n√\nC2UCB(Qinetal.,2014) 2-norm B § O(B d TlogT)\n2 2√\nC2UCB(Takemuraetal.,2021) 1-norm B O(B d KTlogT)\n1 1 √\n(AdditionalResult2) VAC2-UCB(Algorithm2) VM B O(B d TlogT)\nv v\n∗Thisworkisspecifiedforcontextualcombinatorialcascadingbandits,withoutformallydefiningthearmtriggeringprocess.\n√ √\n†Generally,coefficientBv =O(B1 K)andtheexistingregretboundisimprovedwhenBv =o(B1 K)\n‡λisacoefficientinTPVMcondition:whenλislarger,theconditionisstrongerwithsmallerregretbutcanincludelessapplications.\n√\n∗∗Wealsoshowimproveddistribution-dependentregretboundinAppendixC; §AlmostallapplicationssatisfyB2=Θ(B1 K).\nnatorial bandits with probabilistically triggered arms (or way,wenolongerneedtoboundtheregretcausedbypossi-\nC2MAB-T for short). At the base arm level, C2MAB-T blytriggeredarms,butonlyneedtoboundtheregretcaused\nuses a time-varying feature map ϕ to model the contex- byactuallytriggeredarms. Asaresult,wecanthendirectly\nt\ntualinformationateachroundt,andthemeanoutcomeof applythesimplenon-triggeringC2MABanalysistoobtain\neacharmi ∈ [m]isalinearproductofthefeaturevector theregretboundforC2MAB-T.Inaddition,ourTPEcan\nϕ (i)∈Rdandanunknownvectorθ∗ ∈Rd(whered≪m reproducetheresultsforCMAB-Tinasimilarway.\nt\ntohandlelarge-scaleapplications). Atthe(combinatorial)\nSecond,westudytheC2MAB-Tunderthevariancemod-\naction level, inspired by the non-contextual CMAB with\nulated (VM) smoothness condition (Liu et al., 2022), in\nprobabilisticallytriggeredarms(orCMAB-T)works(Chen\nlightoftherecentvariance-adaptivealgorithmstoremove\net al., 2016b; Wang & Chen, 2017; Liu et al., 2022), we √\nthe batch size dependence O( K) for CMAB-T (Merlis\nformally define an arm-triggering process to cover more\n& Mannor, 2019; Liu et al., 2022; Vial et al., 2022). We\ngeneral feedback models such as semi-bandit, cascading,\nproposeanewvariance-adaptivealgorithmVAC2-UCBand\nandprobabilisticfeedback. Wealsoinheritsmoothnesscon- proveabatch-sizeindependentregretO˜(d(cid:112)\nT/p )under\nditionsforthenon-linearrewardfunctiontocoverdifferent min\nVMcondition(MainResult2inTable1). Themaintechni-\napplicationscenarios,suchasCB,IM,andonlineprobabilis-\ncaldifficultyistodealwiththeunknownvariance. Inspired\nticmaximumcoverage(PMC)problems(Chenetal.,2016a;\nbyLattimoreetal.(2015),weusetheUCB/LCBvalueto\nWang&Chen,2017). Withthisformulation,C2MAB-Tre-\nconstructanoptimisticvarianceandontopofthat,weprove\ntainsC2MAB’sscalabilitywhilealsoenjoyingCMAB-T’s\nanewconcentrationboundtoincorporatethetriggeredarms\nrichrewardfunctionsandgeneralfeedbackmodels.\nandoptimisticvariancetogetthedesirableresults.\nContributions. OurmainresultsareshowninTable1.\nThird,weinvestigatethestrongertriggeringprobabilityand\nFirst,westudyC2MAB-Tunderthetriggeringprobability variancemodulated(TPVM)condition(Liuetal.,2022)in\n√\nmodulated(TPM)smoothnesscondition,aconditionintro- order to remove the additional 1/ p factor. The key\nmin\nducedbyWang&Chen(2017)toremoveafactorof1/p challenge is that we cannot directly use TPE to link the\nmin\ninthepioneerCMAB-Twork(Chenetal.,2016a). Thisre- truetriggeringprobabilitywiththerandomtriggereventas\nsultfollowsasimilarveinbydevisingC2-UCB-Talgorithm before,sincetheTPVMconditiononlyyieldsamismatched\n√\nandprovingaO˜(d KT)regret,whichremovesa1/p triggering probability associated with the optimistic vari-\nmin\nfactorforpriorcontextualCBapplications(Lietal.,2016) anceusedinthealgorithm. Oursolutionistoboundthis\n(Main Result 1 in Table 1). The key technical challenge additional mismatch by lower-order terms based on mild\nisthatthetriggeringgroup(TG)analysis(Wang&Chen, conditionsonthetriggeringprobability,whichachievesthe\n√\n2017)forCMAB-Tcannothandlethetriggeringprobability O˜(d T)regretbounds(MainResult3inTable1).\ndeterminedbytime-varyingcontexts. Totacklethisissue,\nAsavaluableby-product,ourTPEanalysisandVAC2-UCB\nwedeviseanewtechnique,calledthetriggeringprobability\nalgorithmcanbeappliedtonon-contextualCMAB-Tand\nequivalence(TPE),whichlinksthetriggeringprobabilities √\nC2MAB,improvingtheexistingresultsbyafactor logT\nwiththerandomtriggeringeventunderexpectation. Inthis √\n(AdditionalResult1inTable1)and K (AdditionalResult\n2\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\n2inTable1), respectively. Ourempiricalresultsonboth factors. Wedeferadetailedtheoreticalandempiricalcom-\nsynthetic and real data demonstrate that the VAC2-UCB parisontoSections3to5. Zuoetal.(2022)studytheonline\nalgorithmoutperformsthestate-of-artvariance-agnosticand competitive IM and also uses C2MAB-T to denote their\nvariance-aware bandit algorithms in the linear cascading contextualsetting. However,theirmeaningof“contexts”is\nbanditapplicationthatsatisfiestheTPVMcondition. theactionofthecompetitor,whichactsattheactionlevel\nandonlyaffectstherewardfunction(orregret)butnotthe\nRelatedWork. ThestochasticCMABmodelhasreceived\nbasearms’estimation. Thisisverydifferentfromourset-\nsignificant attention. The literature was initiated by (Gai\nting,wherecontextsactatthebasearmlevelandhenceone\netal.,2012). Since,itsregrethasbeenimprovedbyKveton\ncannotdirectlyapplytheirresults.\net al. (2015b), Combes et al. (2015), Chen et al. (2016a).\nThere exist two prominent lines of work in the literature\nrelated to our study: contextual CMAB and CMAB with 2.ProblemSetting\nprobabilisticallytriggeredarms(C2MABandCMAB-T).\nWestudycontextualcombinatorialbanditswithprobabilis-\nFor C2MAB works, Qin et al. (2014) is the first study, ticallytriggeredarms(C2MAB-T).Weuse[n]torepresent\nwhich proposes C2UCB algorithm that considers reward set{1,...,n}. Weuseboldfacelowercaselettersandbold-\nfunctions under 2-norm B smoothness condition. Then faceCAPITALIZEDlettersforcolumnvectorsandmatrices,\n2\nTakemuraetal.(2021)replacesthe2-normsmoothnesscon- respectively. ∥x∥ denotes the ℓ norm of vector x. For\np p\ndition with a new √1-norm B\n1\nsmoothness condition, and anysymmetricpositivesemi-d√efinite(PSD)matrixM (i.e.,\nproves a O(B d KT logT) regret bound. In this work, x⊤Mx≥0,∀x),∥x∥ = x⊤Mxdenotesthematrix\n1 M\nweextendtheC2MABwithtriggeringarmstocovermore normofxregardingmatrixM.\napplicationscenarios(e.g., contextualCBandcontextual\nWe specify a C2MAB-T problem instance using a tuple\nIM).Moreover,wefurtherconsiderthestrongerVMcon-\n([m],S,Φ,Θ,D ,R), where [m] = {1,2,...,m} is the\nditionandproposeanewvariance-adaptivealgorithmthat trig\n√ setofbasearms(orarms);S isthesetofeligibleactions\ncanachievea K factorimprovementintheregretupper\nwhereS ∈S isanaction;* Φisthesetofpossiblefeature\nboundforapplicationslikePMC.\nmapswhereanyfeaturemapϕ∈Φisafunction[m]→Rd\nForCMAB-Tworks,Chenetal.(2016a)isthefirstwork that maps an arm to a d-dimensional feature vector (and\nthatconsidersthearmtriggeringprocesstocoverCBandIM w.l.o.g. wenormalize∥ϕ(i)∥ ≤1);Θ⊆Rdistheparam-\n2\napplications. TheauthorsproposetheCUCBalgorithm,and eterspace; D istheprobabilistictriggeringfunctionto\n√ trig\ngive an O(B mKT logT/p ) regret bound under 1- characterizethearmtriggeringprocess(andfeedback),and\n1 min\nnormB smoothnesscondition. ThenWang&Chen(2017) Ristherewardfunction.\n1\nproposesthestronger1-normtriggeringprobabilitymodu-\nInC2MAB-T,alearninggameisplayedbetweenalearn-\nlated(TPM)B smoothnesscondition,andusethetrigger-\n1 ing agent (or player) and the unknown environment in a\ninggroup(TG)analysistoremovea1/p factorinthe\nmin sequential manner. Before the game starts, the environ-\npreviousregret. Recently,Liuetal.(2022)incorporatesthe\nment chooses a parameter θ∗ ∈ Θ unknown to the agent\nvarianceinformation, andproposesthevariance-adaptive\n(and w.l.o.g. we also assume ∥θ∗∥ ≤ 1). At the begin-\nalgorithmBCUCB-T,whichalsousestheTGanalysisand 2\nning of round t, the environment reveals feature vectors\nfurtherreducestheregret’sdependencyonbatch-sizefrom\n(ϕ (1),...,ϕ (m))foreacharm,whereϕ ∈ Φisthefea-\nO(K)toO(logK)underthenewvarianceandtriggering t t t\nturemapknowntotheagent. Givenϕ ,theagentselects\nprobabilitymodulated(TPVM)condition. Thesmoothness t\nan action S ∈ S, and the environment draws Bernoulli\nconditionsconsideredinthisworkaremostlyinspiredby t\noutcomesX =(X ,...X )∈{0,1}mforbasearms†,\ntheaboveworks,butdirectlyfollowingtheiralgorithmand t t,1 t,m\nwith mean E[X |H ] = ⟨θ∗,ϕ (i)⟩ for each base arm\nTG analysis fail to obtain any meaningful result for our t,i t t\ni. Here H denotes the history before the agent chooses\nC2MAB-Tsetting. Conversely,ournewTPEanalysiscan t\nS and will be specified shortly after. Note that the out-\nbeappliedtoCMAB-T,reproducingCMAB-T’sresultun- t\ncomeX isassumedtobeconditionalindependentacross\nderthe1-normTPMcondition,andimprovingafactorof t\n√ armsgivenhistoryH ,similartopreviousworks(Qinetal.,\n( logT)undertheTPVMcondition. t\n2014;Lietal.,2016;Vialetal.,2022). Forconvenience,\nThere are also many studies considering specific appli- weuseµ ≜(⟨θ∗,ϕ (i)⟩) todenotethemeanvector\nt t i∈[m]\ncations under the C2MAB-T framework (by unifying andM ≜ {⟨θ,ϕ(i)⟩ : ϕ ∈ Φ,θ ∈ Θ}todenoteall\ni∈[m]\nC2MABandCMAB-T),includingcontextualCB(Lietal.,\npossiblemeanvectorsgeneratedbyΦandΘ.\n2016;Vialetal.,2022),contextualIM(Wenetal.,2017),etc.\n*Sisageneralactionspace.WhenSisacollectionofsubsets\nOnecanseethattheseapplicationsfitintoourframework\nof[m],weoftenrefertoS ∈Sasasuperarm.\nbyverifyingthattheysatisfytheTPM,VM,orTPVMcon-\n†WeassumeX areBernoullifortheeaseofexposition,yet\nt,i\nditions;thusachievingimprovedresultsregardingK,p\nmin oursettingcanhandleanydistributionwithboundedX t,i ∈[0,1].\n3\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nAftertheactionS isplayedontheoutcomeX ,basearms 2.1.KeyQuantitiesandConditions\nt t\ninarandomsetτ ∼D (S ,X )aretriggered,meaning\nt trig t t In the C2MAB-T model, there are several quantities and\nthattheoutcomesofarmsinτ ,i.e. (X ) arerevealed\nt t,i i∈τt\nassumptions that are crucial to the subsequent study. We\nasthefeedbacktotheagent,andareinvolvedindetermin-\ndefinetriggeringprobabilitypµ,Dtrig,S\nastheprobabilitythat\ning the reward of action S t. At the end of round t, the i\nbasearmiistriggeredwhentheactionisS,themeanvec-\nagentwillreceiveanon-negativerewardR(S ,X ,τ ),de-\nt t t\ntor is µ, and the probabilistic triggering function is D .\nterminedbyS ,X andτ ,andsimilarto(Wang&Chen, trig\nt t t\n2017), theexpectedrewardisassumedtober(S ;µ ) ≜ Since D trig is always fixed in a given application context,\nt t\nE[R(S t,X t,τ t)], afunctionoftheunknownmeanvector we ignore it in the notation for simplicity, and use pµ i,S\nµ ,wheretheexpectationistakenovertherandomnessof henceforth. Triggeringprobabilitiespµ,S’sarecrucialfor\nt i\nX andτ ∼D (S ,X ). Toallowthealgorithmtoesti- thetriggeringprobabilitymodulatedboundedsmoothness\nt t trig t t\nmatetheunderlyingparameterθ∗directlyfromsamples,we conditionstobedefinedbelow. WedefineS˜tobetheset\nassumetheoutcomedoesnotdependonwhetherthearmiis ofarmsthatcanbetriggeredbyS,i.e.,{i ∈ [m] : pµ,S >\ni\ntriggered,i.e.,E [X |i∈τ]=E [X ]. 0, foranyµ∈M},thebatchsizeKasthemaximumnum-\nTothisend,wecX an∼D gi, vτ e∼ tD ht erig( fS o, rX m) aldi efinitionoftX he∼ hD istori y ber of arms that can be triggered, i.e., K = max S∈S|S˜|,\nH = (ϕ ,S ,τ ,(X ) ) (cid:83) ϕ ,whichcontainsall andp =min pµ,S.\nt s s s s,i i∈τs s<t t min i∈[m],µ∈M,S∈S,pµ,S>0 i\ninformationbeforeroundt,aswellasthecontextualinfor- i\nOwingtothenonlinearityandthecombinatorialstructure\nmationϕ atroundt.\nt\nofthereward,itisessentialtogivesomeconditionsforthe\nThegoalofCMAB-Tistoaccumulateasmuchrewardas rewardfunctioninordertoachieveanymeaningfulregret\npossibleoverT roundsbylearningtheunderlyingparam- bounds (Chen et al., 2013; 2016a; Wang & Chen, 2017;\neterθ∗. Theperformanceofanonlinelearningalgorithm Merlis&Mannor,2019;Liuetal.,2022). ForC2MAB-T,\nA is measured by its regret, defined as the difference of weconsiderthefollowingconditions.\nthe expected cumulative reward between always playing\nCondition1(Monotonicity). WesaythataC2MAB-Tprob-\nthebestactionS∗ ≜argmax r(S;µ )ineachroundt\nt S∈S t leminstancesatisfiesmonotonicitycondition,ifforanyac-\nandplayingactionschosenbyalgorithmA. Formanyre-\ntion S ∈ S, any mean vectors µ,µ′ ∈ [0,1]m such that\nwardfunctions,itisNP-hardtocomputetheexactS∗even\nt µ ≤µ′ foralli∈[m],wehaver(S;µ)≤r(S;µ′).\nwhenµ isknown,sosimilarto(Wang&Chen,2017),we i i\nt\nassumethatthealgorithmAhasaccesstoanoffline(α,β)- Condition2(1-normTPMBoundedSmoothness,(Wang\napproximationoracle,whichformeanvectorµoutputsan &Chen,2017)). WesaythataC2MAB-Tprobleminstance\naction S such that Pr[r(S;µ)≥α·r(S∗;µ)] ≥ β. The satisfies the triggering probability modulated (TPM) B 1-\nT-round(α,β)-approximateregretisdefinedas bounded smoothness condition, if for any action S ∈ S,\nany mean vectors µ,µ′ ∈ [0,1]m, we have |r(S;µ′) −\nr(S;µ)|≤B (cid:80) pµ,S|µ −µ′|.\n(cid:104) (cid:105) 1 i∈[m] i i i\nReg(T)=E (cid:80)T t=1(αβ·r(S t∗;µ t)−r(S t;µ t)) , (1) Condition3(VMBoundedSmoothness,(Liuetal.,2022)).\nWesaythataC2MAB-Tprobleminstancesatisfiesthevari-\nancemodulated(VM)(B ,B )-boundedsmoothnesscon-\nv 1\nwheretheexpectationistakenovertherandomnessofout- dition, if for any action S ∈ S, mean vector µ,µ′ ∈\ncomesX 1,...,X T,thetriggeredsetsτ 1,...,τ T,aswellas (0,1)m, for any ζ,η ∈ [−1,1]m s.t. µ′ = µ + ζ + η,\ntherandomnessofalgorithmAitself. we (cid:80)have |r(S;µ′) − r(S;µ)| ≤ B v(cid:113) (cid:80)\ni∈S˜\n(1−ζ µi2\ni)µi\n+\nRemark1(DifferencewithCMAB-T). C2MAB-Tstrictly B 1 i∈S˜|η i|.\ngeneralizesCMAB-Tbyallowingaprobablytime-varying\nCondition 4 (TPVM Bounded Smoothness, (Liu et al.,\nfeaturemapϕ t. Specifically,letθ∗ =(µ 1,...,µ m)andfix 2022)). We say that a C2MAB-T problem instance sat-\nϕ t(i)=e\ni\nwheree\ni\n∈Rm istheone-hotvectorwith1at\nisfies the triggering probability and variance modulated\nthei-thentryand0elsewhere,onecaneasilyreproducethe\n(TPVM)(B ,B ,λ)-boundedsmoothnesscondition,iffor\nv 1\nCMAB-Tsettingin(Wang&Chen,2017). any action S ∈ S, mean vector µ,µ′ ∈ (0,1)m, for\nany ζ,η ∈ [−1,1]m s.t. µ′ = µ + ζ + η, we have\nRemark 2 (Difference with C2MAB). C2MAB-T en- (cid:113)\nhances the modeling power of prior C2MAB (Qin et al., |r(S;µ′) − r(S;µ)| ≤ B v (cid:80) i∈[m](pµ i,S)λ (1−ζ µi2 i)µi +\n2014;Takemuraetal.,2021)bycapturingtheprobabilistic B (cid:80) pµ,S|η |.\n1 i∈[m] i i\nnatureofthefeedback(v.s. thedeterministicsemi-bandit\nfeedback). Thisenablesawiderrangeofapplicationssuch Condition1indicatestherewardismonotonicallyincreasing\nas combinatorial CB, multi-layered network exploration, whentheparameterµincreases. Condition2,3and4all\nandonlineIM(Wang&Chen,2017;Liuetal.,2022). boundtherewardsmoothness/sensitivity.\n4\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nForCondition2,thekeyfeatureisthattheparameterchange Algorithm1C2-UCB-T:ContextualCombinatorialUpper\nineachbasearmiismodulatedbythetriggeringprobabil- ConfidenceBoundAlgorithmforC2MAB-T\nity pµ i,S. Intuitively, for base arm i that is unlikely to be 1: Input:Basearms[m],dimensiond,regularizerγ,fail-\ntriggered/observed(smallpµ,S),Condition2ensuresthat\nureprobabilityδ=1/T,offlineoracleORACLE.\ni\nalargechangeinµ i (duetoinsufficientobservation)only 2: Initialize:GrammatrixG 1 =γI,vectorb 1 =0.\ncausesasmallchange(multipliedbypµ,S)inreward,which 3: fort=1,...,T do\ni\nhelpstosaveap minfactorfornon-contextualCMAB-T. 4: θˆ t =G− t 1b t.\n5: fori∈[m]do\n(F 1o −rC µo i)n µd √iit oio fn th3 e, lein at du ii nt giv Bel vy ti ef rmwe ,ti hg en ro er we at rh de cd he an no gm ewin oa uto ldr 6 7:\n:\nendµ¯ t f, oi r=⟨ϕ t(i),θˆ t⟩+ρ(δ)∥ϕ t(i)∥ G− t1.\nbe O(B K∆) when the amount of parameter change\n|µ′−µ |v =∆foreacharmi.ThisintroducesaO(√ K)fac- 8: S t =ORACLE(µ¯ t,1,...,µ¯ t,m).\ni i 9: PlayS tandobservetriggeringarmsetτ tandobser-\ntorreductionintherewardchangeandtranslatestoaO(K)\nvationset(X ) .\nwi Cm oap r ndr do icv th ie oam nne g 2n et (w ii .n eh .e ,th n pe\nµ\niapr ,Se pg l =r ye it n, 1gc ito fhm iep ∈na or n Se ˜-d t arw nig di gth per\nµ\niO i ,n S( gB =v1 eK r 0s∆ i oo √t) n hr eoe rf -- 1 1 10 1 2: :\n:\nendG b t f+t o+ 1 r1 == bG t+t+t (cid:80),i (cid:80) ii ∈∈ i ττ ∈ tt τ ϕt tϕ (t i( )i X)ϕ t,it .(i)⊤.\nwise). However, for real applications, B = Θ(B K)\n√ 1 1\nwhich cancels the O( K) improvement. To reduce B\nv\ncoefficient,theleadingB termismodulatedbytheinverse\nOurproposedalgorithmC2-UCB-T(Algorithm1)isagen-\nv\nofthevarianceV =(1−µ )µ ,andthusallowapplications\neralizationoftheC3-UCBalgorithmoriginallydesignedfor\ni i i\nto achieve a B coefficient independent of K (or at least contextualcombinatorialcascadingbandits(Lietal.,2016).\n√ v\nB = o(B K)),leadingtosignificantsavingsinthere- Ourmaincontributionistoshowanimprovedregretbound\nv 1\ngretboundforapplicationslikePMC(Liuetal.,2022). The byafactorof1/p minunderthe1-normTPMcondition.\nrelationbetweenCondition2and3isgenerallynotcom-\nRecall that we define the data about the history as H =\nt\nparable, but compared with Condition 2’s non-triggering (cid:83)\n(ϕ ,S ,τ ,(X ) ) ϕ . DifferentfromtheCUCB\ncounterpart(i.e.,1-normcondition),Condition3isstronger.\ns s s s,i i∈τs s<t t\nalgorithm(Wang&Chen,2017)thatdirectlyestimatesthe\nFinally, for Condition 4, it combines both the triggering- meanµ t,i foreacharm,Algorithm1estimatestheunder-\nprobabilitymodulationfromCondition2andthevariance\nlyingparameterθ∗viaaridgeregressionproblemoverthe\nmodulationfromCondition3.Theexponentλofpµ,S gives historydataH t. Morespecifically,weestimateθ∗bysolv-\ni\nadditionalflexibilitytotrade-offbetweenthestrengthofthe ingthefollowingℓ 2-regularizedleast-squareproblemwith\nconditionandtheregret,i.e.,withalargerλ,onecanobtain regularizationparameterγ >0:\nasmallerregretbound,whilewithasmallerλ,thecondition\niseasiertosatisfytoincludemoreapplications. Ingeneral, θˆ t =argmin(cid:88)(cid:88) (⟨θ,ϕ s(i)⟩−X s,i)2+γ∥θ∥2 2. (2)\nCondition4isstrongerthanCondition2andCondition3, θ∈Θ s<ti∈τs\nas the former degenerates to the other two conditions by\nsetting ζ = 0 and the fact that pµ,S ≤ 1fori ∈ S˜ and The closed form solution is precisely the θˆ t\ni\npµ,S =0otherwise,respectively. Conversely,byapplying calculated in line 4, where the Gram matrix\ni G = (cid:80) (cid:80) ϕ (i)ϕ (i)⊤ and the b-vector\ntheCauchy-Schwartzinequality,onecanverifythatifare- t\n(cid:80)\n(cid:80)s<t i∈τs s s\nb = ϕ (i)X arecomputedinline10and\nward √functionisTPMB 1-boundedsmooth,thenitisTPVM t s<t i∈τs s s,i\n(B\n1\nK/2,B 1√,λ)-boundedsmoothforanyλ≤2orsimi- 11. Weclaimthatθˆ tisagoodestimatorofθ∗bybounding\nlarlyVM(B K/2,B )-boundedsmooth,respectively. theirdifferenceviathefollowinglemma,whichisalsoused\n1 1\nin(Qinetal.,2014;Lietal.,2016).\nInlightoftheaboveconditionsthatsignificantlyadvancethe\nnon-contextualCMAB-T,thegoalofsubsequentsections Proposition1(Theorem2,(Abbasi-Yadkorietal.,2011)).\n(cid:114)\nistodesignalgorithmsandconductanalysistoderivethe\nLetρ(δ)=\nlog(cid:16) (γ+KT/d)d(cid:17) +√\nγ,thenwithprobability\n(improved)resultsforthecontextualsetting. Andlaterin γd·δ2\n(cid:13) (cid:13)\nSection5,wedemonstratehowtheseconditionsareapplied atleast1−δ,forallt∈[T],(cid:13)θˆ −θ∗(cid:13) ≤ρ(δ).\n(cid:13) t (cid:13)\ntoapplications,suchasCBandonlineIM,toachieveboth Gt\ntheoreticalandempiricalimprovements. Duetothespace\nBuildingonthis,weconstructanoptimisticestimationof\nlimit,thedetailedproofsareincludedintheAppendix.\neach arm’s mean µ¯ in line 6, where ρ(δ) is in Proposi-\nt,i\ntion 1, ⟨ϕ (i),θˆ ⟩ and ρ(δ)∥ϕ (i)∥ are the empirical\nt t t G−1\n3.AlgorithmandRegretAnalysisfor t\nmeanandconfidenceintervaltowardsthedirectionϕ (i),\nt\nC2MAB-TundertheTPMCondition respectively. As a convention, we clip µ¯ into [0,1] if\nt,i\nµ¯ >1orµ¯ <0.\nt,i t,i\n5\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nThankstoProposition1,wehavethefollowinglemmafor ( =b)E(cid:2)(cid:80) B E [I{i∈τ }](µ¯ −µ )|F (cid:3)\nthedesiredamountofthebasearmleveloptimism,\ni∈S˜\nt\n1 τt t t,i t,i t−1\n( =c)E (cid:2)(cid:80) I{i∈τ }B (µ¯ −µ )(cid:3)\nLemma1. Withprobabilityatleast1−δ,wehaveµ t,i ≤ t i∈S˜ t t 1 t,i t,i\nµ¯\nt,i\n≤µ t,i+2ρ(δ)∥ϕ t(i)∥\nG− t1\nforalli∈[m],t∈[T]. ( =d)E t(cid:2)(cid:80)\ni∈τtB 1(µ¯ t,i−µ\nt,i)(cid:3)\n, (3)\nProof. SeeAppendixA.2. ■ where (a) is by Condition 2, (b) is because µ¯ ,µ ,S\nt,i t,i t\nareF measurablesothattheonlyrandomnessisfrom\nt−1\ntriggering set τ and we can substitute pµt,St with event\nAftercomputingtheUCBvaluesµ¯ ,theagentselectsaction t i\nt I{i ∈ τ } under expectation, (c) is by absorbing the ex-\nS viatheofflineoraclewithµ¯ asinput. Thenbasearms t\nt t pectation over τ to E , and (d) is a change of notation.\ninτ aretriggered,andtheagentreceivesobservationset t t\nt\nAfterapplyingtheTPE,weonlyneedtoboundtheregret\n(X ) asfeedbacktoimprovefuturedecisions.\nt,i i∈τt producedbyi∈τ . Hence\nt\nTheorem 1. For a C2MAB-T instance that satis-\nfies monotonicity (Condition 1) and TPM smooth- Reg(T)≤E(cid:104) (cid:80) E (cid:2)(cid:80) B (µ¯ −µ )(cid:3)(cid:105)\nness (Condition 2) with coefficient B , C2-UCB-\nt∈[T] t i∈τt 1 t,i t,i\n1\n(a) (cid:104) (cid:104) (cid:105)(cid:105)\nT (Algorithm 1) with an (α,β)-approximation ora- ≤ E (cid:80) E (cid:80) 2B ρ(δ)∥ϕ (i)∥\ncle achieves an (α,β)-approximate regret bounded by t∈[T] t i∈τt 1 t G− t1\n(cid:16) (cid:112) √ (cid:112) (cid:17) (b) (cid:104)(cid:113) (cid:105)\nO B 1( dlog(KT/γ)+ γ) KTdlog(KT/γ) . ≤ 2B 1ρ(δ)E KT (cid:80) t∈[T](cid:80) i∈τt∥ϕ t(i)∥2\nG t−1\n(c) √\nDiscussion. Looking at Theorem 1, we achieve an\n√ ≤ O(B d KT logT). (4)\n1\nO(B d KT logT)regretboundwhend≪K ≤m≪T,\n1\nwhich is independent of the number of arms m and the where(a)followsfromLemma1,(b)isbyCauchySchwarz\nminimumtriggeringprobabilityp . Considerthecombi- inequality over both i and t, and (c) is by the ellipsoidal\nmin\nnatorialcascadingbandits(Lietal.,2016)satisfyingB =1 potentiallemma(Lemma5)intheAppendix.\n1\n(seeSection5),ourresultimprovestheLietal.(2016)bya Remark 3. In addition to the general C2MAB-T setting,\nfactorof1/p . Considerthelinearrewardfunction(Take-\nmin theTPEtechniquecanalsoreplacethemoreinvolvedTG\nmuraetal.,2021)withouttriggeringarms(i.e.,pµ i,S =1for technique(Wang&Chen,2017)forCMAB-T.Suchreplace-\ni∈S,and0otherwise),onecaneasilyv √erifyB 1 =1and mentcansaveanunnecessaryunionboundoverthegroup\nourregretmatchesthelowerboundΩ(d KT)Takemura index,whichinturnreproduceTheorem1ofWang&Chen\netal.(2021)uptologarithmicfactors. (2017)underCondition2,andimproveTheorem1ofLiu\n√\netal.(2022)underCondition4byafactorofO( logT),\nAnalysis. Hereweexplainhowtoprovearegretboundthat\nseeAppendixCfordetails.\nremovesthe1/p factorunderthe1-normTPMcondition.\nmin\nThemainchallengeisthatthemeanvectorµ andthetrig-\nt\ngeringprobabilitypµt,S aredependentontime-varyingcon- 4.Variance-AdaptiveAlgorithmandAnalysis\ni\ntextsϕ t(i),soitisimpossibletoderiveanymeaningfulcon- forC2MAB-TunderVM/TPVMCondition\ncentrationinequalityorregretboundbasedonT ,which\nt,i\nisthenumberoftimesthatarmiistriggered,andhasbeen In this section, we propose a new variance-adaptive al-\nusedbythetriggeringgroup(TG)technique(Wang&Chen, gor √ithm VAC2-UCB(Algorithm 2) √to furtherremove the\n2017)toremove1/p min. Todealwiththisproblem,weby- O( K) factor and achieve O˜(B vd T) regret bound for\npass the quantity T and use the triggering-probability applicationssatisfyingstrongerVM/TPVMconditions.\nt,i\nequivalence (TPE) technique that equalizes p iµt,S with Different from Algorithm 1, VAC2-UCB leverages the\nE [I{i ∈ τ }], which in turn replaces the expected regret\nt t second-orderstatistics(i.e.,variance)tospeedupthelearn-\nproducedbyallpossiblearmswiththeexpectedregretpro-\ning process. To get some intuition, we first assume the\nducedbyi∈τ toavoidp . Tosketchourproofidea,we\nt min variance V = Var[X ] for each base arm i at round s\ns,i s,i\nassumetheoracleisdeterministicwithβ =1(therandom- isknowninadvance. Inthiscase,VAC2-UCBadoptsthe\nnessoftheoracleandβ < 1arehandledinAppendixA), weightedridge-regressiontolearntheparameterθ∗:\nand let filtration F be the history data H (defined in\nt−1 t\nSection2). DenoteE [·] = E[· | F ],thet-roundregret θˆ =argmin(cid:88)(cid:88) (⟨θ,ϕ (i)⟩−X )2/V +γ∥θ∥2, (5)\nt t−1 t s s,i s,i 2\nE t[α · r(S t∗;µ t) − r(S t;µ t)]≤E t[r(S t;µ¯ t) − r(S t;µ t)], θ∈Θ s<ti∈τs\nbasedonCondition1,Lemma1anddefinitionofS . Then\nt where the first term is “weighted” by the true variance\nV . The closed-form solution of the above estima-\n(a) (cid:104) (cid:105) s,i\nE t[r(S t;µ¯ t)−r(S t;µ t)] ≤ E t (cid:80) i∈S˜ tB 1pµ it,St(µ¯ t,i−µ t,i)tor is θˆ t = G− t 1b t where the Gram matrix G t =\n6\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nAlgorithm2VAC2-UCB:Variance-AdaptiveContextual (similar to Proposition 1) to guarantee the concentration\nCombinatorialUpperConfidenceBoundAlgorithm boundofθ tbutinfaceoftheunknownvariance. Notethat\n1: Input:Basearms[m],dimensiond,regularizerγ,fail- thesentinelworkLattimoreetal.(2015)provesasimilar\nureprobabilityδ=1/T,offlineoracleORACLE. concentrationbound,thedifferenceisthatwehavemultiple\n2: Initialize:GrammatrixG 1 =γI,regressandb 1 =0. arms triggered in each round instead of a single arm. To\n3: fort=1,...,T do addressthis,wereplacedtheoriginalconcentrationbound\n4: θˆ t =G− t 1b t. withthenewonebelowthathasanextraK4 factorinN,\n5: fori∈[m]do whichfinallyresultsinlogKfactorintheconfidenceradius\n6: µ¯ t,i =⟨ϕ t(i),θˆ t⟩+2ρ(δ)∥ϕ t(i)∥ G−1 ρ(δ).\nt\n7: µ t,i =⟨ϕ t(i),θˆ t⟩−2ρ(δ)∥ϕ t(i)∥ G−1 Lemma2. Letγ > 0,N = (4d2K4T4)d sothatρ(δ) =\n8: S¯ ettheoptimisticvarianceV¯ t,iasEqt uation(6). (cid:16) 1+√ γ+4(cid:113) log(cid:0)6TN log(cid:0)3TN(cid:1)(cid:1)(cid:17) . We have for all\n9: endfor δ δ\n(cid:13) (cid:13)2\n10: S t =ORACLE(µ¯ t,1,...,µ¯ t,m). t≤T,withprobabilityatleast1−δ,(cid:13) (cid:13)θˆ t−θ∗(cid:13) (cid:13) ≤ρ(δ).\n11: PlayS tandobservetriggeringarmsetτ tandobser- Gt\nvationset(X ) .\n1\n11\n3\n42\n:\n:: endbG\nt\nf+t o+\n1\nr1 == bG t+t+t (cid:80),i (cid:80) ii ∈∈ i ττ ∈ tt τ V¯t tV −¯ ,it 1− ,i ϕ1 tϕ (t i( )i X)ϕ t,it .(i)⊤. P Br uo ilo df i. ngS oee nA thp isp le en md mix aB ,w.1 e.\nconstructµ¯\nt,iasanupperboun■\nd\nofµ inline6,andµ asalowerboundofµ inline7,\nt,i t,i t,i\n¯\n(cid:80) (cid:80) V−1ϕ (i)ϕ (i)⊤ and the b-vector b = basedonourvariance-adaptiveθˆ t,G t. Notethatthedou-\n(cid:80)s<t (cid:80)i∈τs Vs −,i 1ϕs (i)Xs ,whichenjoysthesimilart\nform\nblingoftheradius2ρ(δ)insteadofusingρ(δ)inLemma2\n(bus t< ut sesi d∈ iτ fs feres, ni tws eightss, V¯i\ns,i)ofline12andline13.\ni cs op nu vr ee nl ty iof no ,r wth ee cc lo iprre µ¯ctn ,e µssof ino tu or [0te ,c 1h ]n ii fc ta hl ea yna al ry es ais b. oA vesa\n1\nt,i t,i\n¯\nTheintuitionofusingtheinverseofV tore-weighttheob- orbelow0.\ns,i\nservationisthat: thesmallerthevariance,themoreaccurate Lemma3. Withprobabilityatleast1−δ,wehaveµ ≤\nt,i\ntheobservation(ϕ t(i),X t,i)is,andthusmoreimportantfor µ¯\nt,i\n≤ µ t,i+3ρ(δ)∥ϕ t(i)∥ G−1,andµ\nt,i\n≥ µ\nt,i\n≥ µ t,i−\ntheagenttolearnunknownθ∗. Infact,theaboveestimator 3ρ(δ)∥ϕ (i)∥ foralli∈[t m]. ¯\nθˆ is closely related to the best linear unbiased estimator t G− t1\nt\n(BLUE) (Henderson, 1975). Concretely, in the literature\nProof. Thislemmafollowsfromthesimilarderivationof\noflinearregression,Equation(5)isthelowestvariancees-\nLemma1,wherewehavedifferentdefinitionsofµ¯ ,µ\ntimatorofθ∗ amongallunbiasedlinearestimators,when\nandtheconcentrationnowreliesonLemma2.\nt,i ¯t ■,i\nthe regularization term γ = 0, V are the true variance\ns,i\nproxyofoutcomes(X ) andthecontextsequence\ns,i s<t,i∈τs\nAftertheagentplaysS ,thebasearmsinτ aretriggered,\n(ϕ (i)) followsthefixeddesigninEquation(5). t t\ns s<t,i∈τs\nand the agent receives observation set (X ) as feed-\nt,i i∈τt\nForourC2MAB-Tsetting,onenewchallengearisessince back.Theseobservations(reweightedbyoptimisticvariance\nthe variance V s,i = µ s,i(1 − µ s,i) is not known a pri- V¯ t,i)arethenusedtoupdateG tandb tforfuturerounds.\nori. Inspired by (Lattimore et al., 2015; Zhou et al.,\n2021), we construct an optimistic estimation V¯ s,i to re- 4.1.ResultsandAnalysisunderVMcondition\nplace the true variance V in Equation (5). Indeed, we\ns,i\nconstruct V¯ by solving the optimal value for the prob- WefirstshowaregretboundforVAC2-UCBthatisinde-\nt,i\nlemmax µ(1−µ),whoseclosedformsolution pendentofbatchsizeK whentheVMconditionholds.\nµ∈[µt,i,µ¯t,i]\nimmediately¯followsfromtheequationbelow, Theorem 2. For a C2MAB-T instance that satis-\n fies monotonicity (Condition 1) and VM smooth-\n(1−µ¯ t,i)µ¯ t,i, ifµ¯ t,i ≤ 1 2 ness (Condition 3) with coefficient (B v,B 1), VAC2-\nV¯ t,i = ( 11 ,−µ ¯t,i)µ ¯t,i, oif thµ ¯ et r,i w≥ ise1 2 (6) U clC eB ac( hA ielg vo er sit ah nm (2 α) ,βw )i -t ah ppa rn ox( iα m, aβ te)-a rp egp rr eo txi bm oa ut nio dn edor ba y-\n4 O(cid:16) √Bv ((cid:112) dlog(KT/γ)+√ γ)(cid:112) Tdlog(KT/γ)(cid:17) .\nwhere µ¯\nt,i\nand µ\nt,i\nare UCB and LCB values to be intro- pmin\n¯\nducedlater. Noticethatwithhighprobabilitythetrueµ\nt,i\nDiscussion. Looking at Theorem 2, we achieve an\nlies within LCB and UCB values and as they are getting √ √\nO(B d T logT/ p ) regret bound when d ≪ K ≤\nmoreaccurate,theoptimisticvarianceV isalsoapproach- v min\nt,i\nm ≪ T. For combinatorial cascading bandits (Li et al.,\ningthetruevarianceV .\nt,i\n2016)withB =1,ourregretisindependentofm,K and\nv\nToguaranteeθˆ isagoodestimator,weproveanewlemma improvesLietal.(2016)byafactorO((cid:112) K/p ).\nt min\n7\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nTable2. Summaryofthecoefficients,regretboundsandimprovementsforvariousapplications.\nApplication Condition (B ,B ,λ) Regret Improvement\nv 1\nOnlineInfluenceMaximization(Wenetal.,2017) TPM (−,|V|,−)\nO(d|V|(cid:112)\n|E|TlogT)\nO˜((cid:112)\n|E|)\n√ √\nDisjunctiveCombinatorialCascadingBandits(Lietal.,2016) TPVM (1,1,1) O(d √TlogT) O˜( √K/p min)\nConjunctiveCombinatorialCascadingBandits(Lietal.,2016) TPVM (1,1,1) O(d √TlogT) O˜( K/r max)\nLinearCascadingBandits(Vialetal.,2022)∗ TPVM (1,1,1) O(d TlogT) O˜((cid:112) K/d)\nMulti-layeredNetworkExploration(Liuetal.,2021b) TPVM\n((cid:112)\n1.25|V|,1,2)\nO(d(cid:112)\n|V|TlogT)\nO˜(√\nn √/p min)\nProbabilisticMaximumCoverage(Chenetal.,2013)∗∗ VM (3(cid:112) 2|V|,1,−) O(d(cid:112) |V|TlogT) O˜( k)\n|V|,|E|,n,k,Ldenotesthenumberoftargetnodes,thenumberofedgesthatcanbetriggeredbythesetofseednodes,thenumberoflayers,thenumberof\nseednodesandthelengthofthelongestdirectedpath,respectively; Kisthelengthoftheorderedlist,rmax=α·max t∈[T],S∈Sr(S;µt);\n∗Aspecialcaseofdisjunctivecombinatorialcascadingbandits. ∗∗ThisrowisforC2MABapplicationandtherestofrowsareforC2MAB-Tapplications.\nInadditiontothegeneralC2MAB-Tsetting,onecanverify Lemma3,(e)followsfromLemma6.\nthatfornon-triggeringC2MAB,p = 1,andweobtain\nmin √\nthebatch-sizeindep √endentregretboundO(B vd T logT). 4.2.ResultsandAnalysisunderTPVMCondition\nRecallB = O(B K)foranyC2MAB-Tinstances,so\nv 1 √ Next,weshowthatVAC2-UCBcanachieveregretbounds\nourregretboundreproducesO(B 1d KT logT),andthus √ √\nthatremovetheO( K)andO(1/ p )factorforappli-\nmatchesthesimilarlowerbound(Takemuraetal.,2021)for min\ncationssatisfyingthestrongerTPVMconditions.\nthelinearrewardfunctions. Forthemoreinterestingnon-\n√\nlinear reward function with B v = o(B 1 K), our regret Wefirstintroduceamildconditionoverthetriggeringprob-\nimprovesnon-va √riance-adaptivealgorithmC2UCB,whose ability(whichissimilartoCondition2)togiveourregret\nregretisO(B 1d KT logT)(Qinetal.,2014;Takemura boundsandanalysis.\netal.,2021).\nCondition 5 (1-norm TPM Bounded Smoothness for\n√\nAnalysis. At a high level, the improvement of K Triggering Probability). We say that a C2MAB-T prob-\ncomes from the VM condition and the optimistic vari- lem instance satisfies the triggering probability modu-\nance, which together save the use of Cauchy-Schwarz latedB -boundedsmoothnessconditionoverthetrigger-\n√ p\ninequality that generates a O( K) factor in the step ing probability, if for any action S ∈ S, any mean vec-\n(b) of Equation (4). In order to leverage the variance tors µ,µ′ ∈ [0,1]m, and any arm i ∈ [m], we have\ninformation,wedecomposetheregretintoterm(I)and(II), |pµ′,S −pµ,S|≤B (cid:80) pµ,S|µ −µ′|.\ni i p j∈[m] j j j\n(cid:104) (cid:105)\nReg(T)≤E (cid:80)T r(S ;µ¯ )−r(S ;µ ) Nowwestateourmaintheoremasfollows.\nt=1 t t t t\n≤E[(cid:80)T |r(S ;µ¯ )−r(S ;µ˜ )|+|r(S ;µ )−r(S ;µ˜ )|], Theorem 3. For a C2MAB-T instance, when its reward\nt=1 t t t t t t t t\n(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125) function satisfies monotonicity (Condition 1) and TPVM\n(I) (II)\nsmoothness(Condition4)withcoefficient(B ,B ,λ),and\n(7) v 1\nwhere µ˜ is the vector whose i-th entry is the\nitstriggeringprobabilitypµ,Ssatisfies1-normTPMsmooth-\nt i\nmaximizer that achieves optimistic variance V¯ t,i, nesswithcoefficientB p(Condition5),ifλ≥2,thenVAC2-\ni.e., µ˜ = argmax µ(1 − µ). Now UCB (Algorithm 2) with an (α,β)-approximation oracle\nt,i µ∈[µt,i,µ¯t,i]\nwe show a sketched pr¯oof to bound the term achievesan(α,β)-approximateregretboundedby\n(I) and one can bound the term (II) similarly. (cid:16) √ √ √ (cid:17)\nO B d T logT +B B K(dlogT)2/ p , (9)\nv v p min\n(cid:104) (cid:105)(a) (cid:104) (cid:113) (cid:105)\nE (cid:80) (I) ≤ B E (cid:80)T (cid:80) (µ¯ −µ˜ )2/V¯\nt∈[T] v t=1 i∈S˜ t t,i t,i t,i andifλ ≥ 1,thenVAC2-UCB(Algorithm2)achievesan\n(b) (cid:20) (cid:113) (cid:21) (α,β)-approximateregretboundedby\n(≤\n≤c)\n√ √B Bp pm mv vi in\nn\n· ·E\n(cid:114)\nT(cid:80) ET t (cid:104)= (cid:80)1\nT\nt=(cid:80) 1(cid:80)i∈ iS˜ ∈t S˜p tµ i pt\nµ\ni,S t,t S( tµ¯ (t µ¯,i t,− i−µ˜ t µ˜,i t) ,i2 )/ 2V¯ /t V¯,i\nt,i(cid:105)\nO(cid:16)\nB\nvd√\nT logT +B\nv(cid:112)\nB\np(KT)1/4(dlogT)3/2/√\np (1m 0in\n)(cid:17)\n.\n(cid:114)\n(d) (cid:104) (cid:105)\n≤ √B pmv\nin\n· TE (cid:80)T t=1(cid:80) i∈τt(6ρ(δ)∥ϕ t(i)∥ G− t1)2/V¯ t,i\nDiscuss √ion. The leading term of Theorem 3 is\n( ≤e)\nO(B\nd√ TlogT/√\np ), (8)\nO(B vd T lo √gT) when d ≪ K ≤ m ≪ T, which re-\nv min movesthe1/ p factorcomparedwithTheorem2. Also,\nwhere (a) is by Condition 3, (b) is by the definition of min\nnoticethatTheorem3reliesonanadditionalB -smoothness\npµt,St ≥p fori∈S˜,(c)isbyCauchy–Schwarzovert p\ni min t conditionoverthetriggeringprobability.However,weclaim\nandtheJensen’sinequality,(d)followsfromtheTPEand\nthatthisconditionismildandalmostalwayssatisfieswith\n8\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nB = B for applications considered in this paper (see\np 1\nAppendixD).\nAnalysis. WeusetheregretdecompositionofEquation(7)\ntothesameterm(I)and(II),andleverageonTPVMcondi-\ntion(Condition4)toobtain:\n(a)Allgenres (b)Particulargenre\n   \nE (cid:88) (I)( ≤a) B vE (cid:88)T (cid:115)(cid:88) (pµ i˜t,St)λ(µ¯ t,i−µ˜ t,i)2/V¯ t,i. Figure1. RegretresultsforMovieLensdata.\nt∈[T] t=1 i∈S˜\nt\n(11) detailsexperimentsontheMovieLens-1Mdataset‡. Experi-\nHowever, we cannot use TPE as Equation (8) because mentsonotherdataareincludedintheAppendix. Figure1\npµ˜t,St ̸= pµt,St ingeneral. Tohandlethismismatch, we illustratesthatourVAC2-UCBalgorithmoutperformsC3-\ni i\nuse the fact that triggering probability usually satisfies a UCB(Lietal.,2016),thevariance-agnosticcascadingban-\nsmoothness condition in Condition 5, and prove that the ditalgorithm,andCascadeWOFUL(Vialetal.,2022),the\nmismatchonlyaffectthelower-ordertermasfollows: state-of-the-artvariance-awarecascadingbanditalgorithm,\neventuallyincurring45%and25%lessregret. Fordetailed\nByCondition5, (pµ˜t,St)λ isupperboundedby(pµt,St +\ni i settings,comparisons,anddiscussions,seeAppendixE.\nmin{1,(cid:80) B pµ,St|µ −µ˜ |})2 when λ ≥ 2,\nj∈S˜ t p j t,j t,j\nand the regret is bounded by the terms as shown below:\n6.Conclusion\n(cid:20) (cid:113) (cid:21)\nEq.(11)≤E (cid:80)T B (cid:80) 3pµt,St(µ¯ −µ˜ )2/V¯ This paper studies contextual combinatorial bandits with\nt=1 v i∈S˜ t i t,i t,i t,i probabilisticallytriggeredarms(C2MAB-T)underavariety\n(cid:124) (cid:123)(cid:122) (cid:125)\nleadingterm ofsmoothnessconditions. Underthetriggeringprobability\n√ (cid:104) (cid:105)\n+ (cid:124)B √vB pp minKE (cid:80)T t=1(cid:80)\ni∈S˜\nt\n(cid:123)(cid:122)pµ it,St(µ¯ t,i−µ ¯t,i)2/V¯\nt,i\n(cid:125), m rito hd mul aa nte dd p( rT opP oM se)c ao nn od vi eti lo an n, aw lye sd ise ts oig an chth iee vC e2 a- nU OC ˜(B d- √T Kalg To )-\nlower-orderterm √ regret bound, removing a potentially exponentially large\nwheretheleadingtermisoforderO(B T logT)byusing\nv factor O(1/p ). Under the variance modulated condi-\nthesamederivationofstep(c)-(e)inEquation(8),andthe min\nlowerordertermisboundedbyO(B B\n(cid:112)\nK/p logT)\ntions(VMorTPVM),weproposeanewvariance-ada √ptive\nv p min algorithmVAC2-UCBandderivearegretboundO˜(d T),\nby TPE and the weighted ellipsoidal potential lemma\nwhich removes the batch-size K dependence. As valu-\n(Lemma 6). For λ ≥ 1, the lower-order term becomes\n√ (cid:34) (cid:18) (cid:19)3/4(cid:35) ableby-product, wefindourTPEanalysistechniqueand\nBv√B pmp iK n1/4 E (cid:80)T\nt=1\n(cid:80)\ni∈S˜ t\npµ it,St(µ V¯ ¯t t, ,i i− ¯µt,i)2 , Tva ari na dnc Ce 2- Mad Aap Btiv se eta til ng go ,ri it mhm proc va in nb ge ea xp isp tl ii ne gd rt eo suth lte sC asM wA eB ll-\n.\nwhich results in a larger lower-order regret term. See Experimentsshowthatouralgorithmcanachieveatleast\nAppendixB.3fordetails. 13%and25%improvementcomparedwithbenchmarkal-\ngorithmsonsyntheticandreal-worlddatasets,respectively.\n5.ApplicationsandExperiments Forthefuturestudy,itwouldbeinterestingtoextendour\napplication scenarios. One could also relax the perfectly\nWe now move to applications and experimental results. linearassumptionbyintroducingmodelmis-specifications\nWefirstshowhowourtheoreticalresultsimprovevarious orcorruptions.\nC2MABandC2MAB-Tapplicationsunder1-normTPM,\nTPVM and VM smoothness conditions with their corre-\nAcknowledgement\nspondingB ,B ,λcoefficients. Then,weprovideanem-\n1 v\npiricalcomparisoninthecontextofthecontextualcascading TheworkofJohnC.S.LuiwassupportedinpartbyRGC’s\nbanditapplication. GRF 14215722. The work of Mohammad Hajiesmaili is\nsupportedbyNSFCAREER-2045641,CPS-2136199,CNS-\nTheinstantiationofourtheoreticalresultsinthecontextof\navarietyofspecificC2MAB andC2MAB-Tapplications 2106299,andCNS-2102963.WiermanissupportedbyNSF\ngrants CNS-2146814, CPS-2136197, CNS-2106403, and\nisshowninTable2. Thefinalcolumnofthetabledetails\nNGSDI-2105648.\nthe improvement in regret that our results yield in each\ncase. Fordetailedsettings,proofs,andthediscussionofthe\napplicationresults,seeAppendixD.\nOurexperimentalresultsaresummarizedinFigure1,which ‡grouplens.org/datasets/movielens/1m/\n9\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nReferences Kveton,B.,Wen,Z.,Ashkan,A.,andSzepesvari,C. Tight\nregretboundsforstochasticcombinatorialsemi-bandits.\nAbbasi-Yadkori,Y.,Pa´l,D.,andSzepesva´ri,C. Improved\nInAISTATS,2015b.\nalgorithms for linear stochastic bandits. Advances in\nneuralinformationprocessingsystems,24,2011.\nLattimore,T.andSzepesva´ri,C. Banditalgorithms. Cam-\nAuer, P., Cesa-Bianchi, N., and Fischer, P. Finite-time bridgeUniversityPress,2020.\nanalysis of the multiarmed bandit problem. Machine\nLattimore,T.,Crammer,K.,andSzepesva´ri,C.Linearmulti-\nlearning,47(2-3):235–256,2002.\nresourceallocationwithsemi-banditfeedback. Advances\nBernstein, S. The Theory of Probabilities (Russian). inNeuralInformationProcessingSystems,28,2015.\nMoscow,1946.\nLi,S.,Wang,B.,Zhang,S.,andChen,W. Contextualcom-\nBubeck, S., Cesa-Bianchi, N., et al. Regret analysis of\nbinatorialcascadingbandits. InInternationalconference\nstochastic and nonstochastic multi-armed bandit prob-\nonmachinelearning,pp.1245–1253.PMLR,2016.\nlems. FoundationsandTrends®inMachineLearning,5\n(1):1–122,2012. Li, S., Kong, F., Tang, K., Li, Q., and Chen, W. Online\ninfluencemaximizationunderlinearthresholdmodel. Ad-\nChen, W., Wang, Y., and Yuan, Y. Combinatorial multi-\nvances in Neural Information Processing Systems, 33:\narmedbandit: Generalframeworkandapplications. In\n1192–1204,2020.\nInternationalConferenceonMachineLearning,pp.151–\n159.PMLR,2013.\nLiu,L.T.,Ruan,F.,Mania,H.,andJordan,M.I. Bandit\nChen,W.,Wang,Y.,Yuan,Y.,andWang,Q. Combinatorial learningindecentralizedmatchingmarkets. Journalof\nmulti-armedbanditanditsextensiontoprobabilistically MachineLearningResearch,22(211):1–34,2021a.\ntriggered arms. The Journal of Machine Learning Re-\nsearch,17(1):1746–1778,2016a. Liu, X., Zuo, J., Chen, X., Chen, W., and Lui, J. C.\nMulti-layered network exploration via random walks:\nChen, X., Li, Y., Wang, P., and Lui, J. A general frame- Fromofflineoptimizationtoonlinelearning. InInterna-\nworkforestimatinggraphletstatisticsviarandomwalk. tionalConferenceonMachineLearning,pp.7057–7066.\nProceedings of the VLDB Endowment, 10(3):253–264, PMLR,2021b.\n2016b.\nLiu,X.,Zuo,J.,Wang,S.,Joe-Wong,C.,Lui,J.,andChen,\nCombes, R., Talebi Mazraeh Shahi, M. S., Proutiere, A.,\nW. Batch-sizeindependentregretboundsforcombina-\netal.Combinatorialbanditsrevisited.Advancesinneural\ntorialsemi-banditswithprobabilisticallytriggeredarms\ninformationprocessingsystems,28,2015.\norindependentarms. InAdvancesinNeuralInformation\nFreedman,D.A. Ontailprobabilitiesformartingales. the ProcessingSystems,2022.\nAnnalsofProbability,pp.100–118,1975.\nMerlis,N.andMannor,S. Batch-sizeindependentregret\nGai,Y.,Krishnamachari,B.,andJain,R. Combinatorialnet- boundsforthecombinatorialmulti-armedbanditprob-\nworkoptimizationwithunknownvariables: Multi-armed lem. InConferenceonLearningTheory,pp.2465–2489.\nbanditswithlinearrewardsandindividualobservations. PMLR,2019.\nIEEE/ACM Transactions on Networking (TON), 20(5):\n1466–1478,2012. Qin, L., Chen, S., andZhu, X. Contextualcombinatorial\nbanditanditsapplicationondiversifiedonlinerecommen-\nHenderson,C.R. Bestlinearunbiasedestimationandpre-\ndation. InProceedingsofthe2014SIAMInternational\ndictionunderaselectionmodel. Biometrics,pp.423–447,\nConferenceonDataMining,pp.461–469.SIAM,2014.\n1975.\nKempe,D.,Kleinberg,J.,andTardos,E´. Maximizingthe Robbins,H. Someaspectsofthesequentialdesignofexper-\niments. BulletinoftheAmericanMathematicalSociety,\nspreadofinfluencethroughasocialnetwork. InProceed-\n58(5):527–535,1952.\ningsoftheninthACMSIGKDDinternationalconference\nonKnowledgediscoveryanddatamining,pp.137–146,\nTakemura,K.,Ito,S.,Hatano,D.,Sumita,H.,Fukunaga,T.,\n2003.\nKakimura,N.,andKawarabayashi,K.-i. Near-optimal\nKveton,B.,Wen,Z.,Ashkan,A.,andSzepesva´ri,C. Com- regretboundsforcontextualcombinatorialsemi-bandits\nbinatorialcascadingbandits. InProceedingsofthe28th withlinearpayofffunctions. InProceedingsoftheAAAI\nInternationalConferenceonNeuralInformationProcess- Conference on Artificial Intelligence, pp. 9791–9798,\ningSystems-Volume1,pp.1450–1458,2015a. 2021.\n10\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nVial,D.,Shakkottai,S.,andSrikant,R. Minimaxregretfor\ncascadingbandits. InAdvancesinNeuralInformation\nProcessingSystems,2022.\nWang,Q.andChen,W. Improvingregretboundsforcom-\nbinatorial semi-bandits with probabilistically triggered\narmsanditsapplications. InAdvancesinNeuralInfor-\nmationProcessingSystems,pp.1161–1171,2017.\nWen,Z.,Kveton,B.,Valko,M.,andVaswani,S. Onlinein-\nfluencemaximizationunderindependentcascademodel\nwithsemi-banditfeedback. Advancesinneuralinforma-\ntionprocessingsystems,30,2017.\nZhou, D., Gu, Q., and Szepesvari, C. Nearly minimax\noptimalreinforcementlearningforlinearmixturemarkov\ndecisionprocesses. InConferenceonLearningTheory,\npp.4532–4576.PMLR,2021.\nZong,S.,Ni,H.,Sung,K.,Ke,N.R.,Wen,Z.,andKveton,\nB. Cascading bandits for large-scale recommendation\nproblems. arXivpreprintarXiv:1603.05359,2016.\nZuo,J.,Liu,X.,Joe-Wong,C.,Lui,J.C.,andChen,W. On-\nlinecompetitiveinfluencemaximization. InInternational\nConference on Artificial Intelligence and Statistics, pp.\n11472–11502.PMLR,2022.\n11\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nAppendix\nThe Appendix is organized as follows. Appendix A gives the detailed proofs for theorems and lemmas in Section 3.\nAppendixBprovidesthedetailedproofsfortheoremsandlemmasinSection4. AppendixCshowshowthetriggering\nprobabilityequivalencetechniquecanbeappliedtonon-contextualCMAB-Ttoobtainimprovedresults. AppendixDgives\nthedetailedsettings,resultsandcomparisonsincludedinTable2. AppendixEprovidesdetailedexperimentalsetupsand\nadditionalresults. AppendixFsummarizestheconcentrationbounds,facts,andtechnicallemmasusedinthispaper.\nA.ProofsforC2MAB-TundertheTPMCondition(Section3)\nA.1.ProofofTheorem1\nWefirstgive/recallsomedefinitionsandevents. RecallthatinAlgorithm1,thegrammatrix,theb-vectorandtheestimator\nare\n(cid:88)(cid:88)\nG =γI+ ϕ (i)ϕ (i)⊤ (12)\nt s s\ns<ti∈τs\n(cid:88)(cid:88)\nb = ϕ (i)X (13)\nt s s,i\ns<ti∈τs\nθˆ =G−1b . (14)\nt t t\nLet us use W to denote the nice event when the oracle can output solution S with r(S;µ) ≥ α · r(S∗;µ) where\nt\n(cid:13) (cid:13)\nS∗ =argmax r(S;µ)foranyµatroundt. WeuseN todenotetheniceeventwhenthe(cid:13)θˆ −θ∗(cid:13) ≤ρ(δ)holds\nS∈S t (cid:13) t (cid:13)\nGt\nfor any t ∈ [T]. Define the filtration to be F = (S ,ϕ ,τ ,(X ) ,...,S ,ϕ ,τ ,(X ) ,S ,ϕ )\nt−1 1 1 1 1,i t∈τ1 t−1 t−1 t−1 t−1,i t∈τt−1 t t\nthattakesbothhistorydataH andactionS tohandletherandomnessoftheoracle,andletE [·]=E[·|F ]. Nowwe\nt t t t−1\nboundtheregretunderniceeventW andN ,\nt t\n \nReg(T)( =a)E (cid:88) E t[α·r(S t∗;µ t)−r(S t;µ t)]\nt∈[T]\n   \n(b) (cid:88) (c) (cid:88)\n≤ E  E t[α·r(S t∗;µ¯ t)−r(S t;µ t)] ≤ E  E t[r(S t;µ¯ t)−r(S t;µ t)]\nt∈[T] t∈[T]\n  \n(d) (cid:88) (cid:88)\n≤ E  E t B 1pµ it,St(µ¯ t,i−µ t,i)\nt∈[T] i∈S˜\nt\n (cid:34) (cid:35)\n( =e)E (cid:88) E t (cid:88) B 1(µ¯ t,i−µ t,i) \nt∈[T] i∈τt\n (cid:34) (cid:35)  \n( ≤f) E (cid:88) E t (cid:88) 2B 1ρ(δ)∥ϕ t(i)∥ G−1 ( =g) 2B 1ρ(δ)E (cid:88) (cid:88) ∥ϕ t(i)∥ G−1\nt t\nt∈[T] i∈τt t∈[T]i∈τt\n \n( ≤h) 2B 1ρ(δ)E (cid:115) KT (cid:88) (cid:88) ∥ϕ t(i)∥2 G−1\nt\nt∈[T]i∈τt\n(i) (cid:16) (cid:112) √ (cid:112) (cid:17) √\n≤ O B ( 2dlogT + γ) 2KT logT ≤O(B d KT logT). (15)\n1 1\nwhere(a)followsfromtheregretdefinitionandthetowerrule,(b)isbyCondition1andLemma1sayingthatµ ≤µ¯ ,\nt,i t,i\n(c)isbyniceeventW andthedefinitionofS , (d)isbyCondition2, (e)followsfrombytheTPEtrickLemma4, (f)\nt t\nis by Lemma 1, (g) is by tower rule, (h) by Cauchy Schwarz inequality, and (i) is by the ellipsoidal potential lemma\n(Lemma5). Similarto(Wang&Chen,2017)Thetheoremisconcludedbythedefinitionofthe(α,β)-approximateregret,\nandconsideringevent¬W or¬N ,whichcontributestoatmost(1−β)T∆ +δT∆ regret.\nt t max max\n12\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nA.2.ImportantLemmasusedforprovingTheorem1\nLemma1. Withprobabilityatleast1−δ,wehaveµ ≤µ¯ ≤µ +2ρ(δ)∥ϕ (i)∥ foralli∈[m],t∈[T].\nt,i t,i t,i t G−1\nt\nProof. Foranyi∈[m],t∈[T],wehave\n(cid:12) (cid:12)\n(cid:12)⟨θˆ ,ϕ (i)⟩−⟨θ∗,ϕ (i)⟩(cid:12)\n(cid:12) t t t (cid:12)\n(cid:12) (cid:12)\n=(cid:12)⟨θˆ −θ∗,ϕ (i)⟩(cid:12)\n(cid:12) t t (cid:12)\n(a)(cid:13) (cid:13)\n≤ (cid:13)θˆ −θ∗(cid:13) ·∥ϕ (i)∥\n(cid:13) t (cid:13) t G−1\nGt t\n(b)\n≤ ρ(δ)∥ϕ (i)∥ ,\nt G−1\nt\nwhere(a)byCauchy-Schwartz,(b)byProposition1. Nowusethedefinitionofµ =⟨θ∗,ϕ (i)⟩andµ¯ =⟨θˆ ,ϕ (i)⟩+\nt,i t t,i t t\nρ(δ)∥ϕ (i)∥ finishestheproof. ■\nt G−1\nt\nLemma4(TriggeringProbabilityEquivalence(TPE)). E (cid:104) (cid:80) B pµt,St(µ¯ −µ )(cid:105) =E (cid:2)(cid:80) B (µ¯ −µ )(cid:3) .\nt i∈S˜ t 1 i t,i t,i t i∈τt 1 t,i t,i\nProof. Wehave\n \n(cid:88)\nE t B 1pµ it,St(µ¯ t,i−µ t,i)\ni∈S˜\nt\n \n( =a)E (cid:88) B 1E τt[I{i∈τ t}](µ¯ t,i−µ t,i)|F t−1\ni∈S˜\nt\n \n( =b)E t(cid:88) I{i∈τ t}B 1(µ¯ t,i−µ t,i)\ni∈S˜\nt\n(cid:34) (cid:35)\n( =c)E (cid:88)\nB (µ¯ −µ ) , (16)\nt 1 t,i t,i\ni∈τt\n(a)isbecauseµ¯ ,µ ,S areF -measurablesothattheonlyrandomnessisfromtriggeringsetτ andwecansubstitute\nt,i t,i t t−1 t\npµt,St witheventI{i∈τ }underexpectation,(b)isbyabsorbingtheexpectationoverτ toE ,and(c)isasimplechange\ni t t t\nofnotation. Actually,TPEcanbeappliedwheneverthequantities(otherthanpD,S)areF -measurable,whichwouldbe\ni t−1\nhelpfulforlatersections. ■\nLemma5(EllipsoidalPotentialLemma). (cid:80)T (cid:80) ∥ϕ (i)∥2 ≤2dlog(1+KT/(γd))≤2dlogT whenγ ≥K.\nt=1 i∈τt t G− t1\nProof.\n(cid:32) (cid:33)\ndet(G )( =a) det G +(cid:88) ϕ (i)ϕ (i)⊤\nt+1 t t t\ni∈τt\n(cid:32) (cid:33)\n( =b) det(G )·det I+(cid:88) G−1/2ϕ (i)(G−1/2ϕ (i))⊤\nt t t t t\ni∈τt\n(cid:32) (cid:33)\n( ≥c) det(G )· 1+(cid:88) ∥ϕ (i)∥2\nt t G−1\nt\ni∈τt\nt (cid:32) (cid:33)\n( ≥d) det(γI)(cid:89) 1+(cid:88) ∥ϕ (i)∥2 , (17)\ns G− s1\ns=1 i∈τs\n13\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nwhere (a) follows from the definition, (b) follows from det(AB) = det(A)det(B) and A + B = A1/2(I +\nA−1/2BA−1/2)A1/2,(c)followsfromLemma14,(d)followsfromrepeatedlyapplying(c).\nSince∥ϕ (i)∥2 ≤ ∥ϕs(i)∥2 ≤1/γ ≤1/K,wehave(cid:80) ∥ϕ (i)∥2 ≤1. Usingthefactthat2log(1+x)≥xfor\ns G− s1 λmin(Gs) i∈τs s G− s1\nany[0,1],wehave\n(cid:88)(cid:88) ∥ϕ (i)∥2\ns G− s1\ns∈ti∈τs\nt (cid:32) (cid:33)\n≤2(cid:88) log 1+(cid:88) ∥ϕ (i)∥2\ns G− s1\ns=1 i∈τs\nt (cid:32) (cid:33)\n=2log(cid:89) 1+(cid:88) ∥ϕ (i)∥2\ns G− s1\ns=1 i∈τs\n(cid:18) (cid:19)\n(a) det(G )\n≤ 2log t+1\ndet(γI)\n(b)\n(cid:18) (γ+KT/d)d(cid:19)\n≤ 2log =2dlog(1+KT/(γd))≤2dlog(T),\nγd\nwherethe(a)followsfromEquation(17),(b)followsfromLemma15. ■\nB.ProofsforC2MAB-TundertheVMorTPVMCondition(Section4)\nB.1.ProofofLemma2\nOuranalysisis inspiredbythederivationof Theorem3by(Lattimore etal.,2015)tobound thekey ellipsoidalradius\n(cid:13) (cid:13)\n(cid:13)θ∗−θˆ (cid:13) ≤ρfortheC2MAB-Tsetting,wheremultiplearmscanbetriggeredineachround. Beforewegoingintothe\n(cid:13) t(cid:13)\nGt\nmainproof,wefirstintroducesomenotationsandeventsasfollows.\nRecallthatfort≥1,X isaBernoullirandomvariablewithmeanµ =⟨θ∗,ϕ (i)⟩,suppose∥θ∗∥ ≤1,∥ϕ (i)∥≤1,\nt,i t,i t 2 t\nwe can represent X by X = µ +η , where noise η ∈ [−1,1], its mean E[η | F ] = 0, and its variance\nt,i t,i t,i t,i t,i t,i t−1\nVar[η | F ] = µ (1−µ ). Also note that in Algorithm 2, the gram matrices, the b-vector and the weighted\nt,i t−1 t,i t,i\nleast-squareestimatorarethefollowing.\nt−1\nG =γ·I+(cid:88)(cid:88) V¯−1ϕ (i)ϕ (i)⊤, (18)\nt s,i s s\ns=1i∈τs\nt−1\nb =(cid:88)(cid:88) V¯−1ϕ (i)X , (19)\nt s,i s s,i\ns=1i∈τs\nθˆ =G−1b , (20)\nt t t\nwherewesetG =γI,andoptimisticvariancesV¯ aredefinedasinEquation(6)ofAlgorithm2.\n0 s,i\nLetusdefineZ =(cid:80) (cid:80) η ϕ (i)/V¯ ,andthekeyofthisproofistoboundZ (thisquantityisoftendenotedas\nt s<t i∈τs s,i t s,i t\nS intheself-normalizedbound(Abbasi-Yadkorietal.,2011),butS isoccupiedtodenoteactionsatroundtinthiswork).\nt t\nWefinallydefinefailureeventsF ⊆F ⊆...⊆F beasequenceofeventsdefinedby\n0 1 T\n√\nF ={∃s≤tsuchthat ∥Z ∥ + γ ≥ρ}. (21)\nt s Gs\n(cid:13) (cid:13)\nThesefailureeventsarecrucialinthesensethatθ∗liesintheconfidenceellipsoid(cid:13)θ∗−θˆ (cid:13) ≤ρ(seeLemma8forits\n(cid:13) t(cid:13)\nGt\nproof).\n√\nNext,wecanprovebyinductionthattheprobabilityof∥Z ∥ + γ ≥ρgiven¬F isverysmall,fort=1,...,T (seeits\nproofinLemma7).Basedonthis,wecanhavePr[¬F\n]=t 1G −t\nPr[F\n]−(cid:80)T Pr(cid:2) ∥t− Z1\n∥\n+√\nγ ≥ρand¬F\n(cid:3)\n≥1−δ\nT 0 t=1 t Gt t−1\n(as¬F alwaysholds),andthusbyEquation(147),Lemma2isprovedasdesired.\n0\n14\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nB.2.ProofofTheorem2underVMcondition\nSimilartoAppendixA,wefirstgive/recallsomedefinitionsandevents. RecallthatinAlgorithm2,thegrammatrices,\nthe b-vector, and the weighted least-square estimator are defined in Equation (18) The optimistic variances V¯ are\ns,i\ndefinedasinEquation(6)ofAlgorithm2. LetususeW todenotetheniceeventwhentheoraclecanoutputsolution\nt\nS with r(S;µ) ≥ α·r(S∗;µ) where S∗ = argmax r(S;µ) for any µ at round t. We use N to denote the nice\nS∈S t\n(cid:13) (cid:13)\neventwhenthe(cid:13)θˆ −θ∗(cid:13) ≤ ρ(δ)holdsforanyt ∈ [T](whichcanbeimpliedby¬F ). Definethefiltrationtobe\n(cid:13) t (cid:13) T\nGt\nF =(S ,ϕ ,τ ,(X ) ,...,S ,ϕ ,τ ,(X ) ,S ,ϕ )thattakesbothhistorydataH andactionS\nt−1 1 1 1 1,i t∈τ1 t−1 t−1 t−1 t−1,i t∈τt−1 t t t t\ntohandletherandomnessoftheoracle,andletE [·]=E[·|F ].\nt t−1\nLetµ˜ bethevectorwhosei-thentryisthemaximizerthatachievesV¯ ,i.e.,µ˜ =argmax µ(1−µ). Nowwe\nt t,i t,i µ∈[µt,i,µ¯t,i]\nboundtheregretunderniceeventW andN (whereN canbeimpliedfrom¬F byderivation¯inLemma8),\nt t T\n(cid:34) T (cid:35)\nReg(T)( =a)E (cid:88) αr(S∗;µ )−r(S ;µ ) (22)\nt t t t\nt=1\n(cid:34) T (cid:35)\n(b) (cid:88)\n≤ E αr(S∗;µ¯ )−r(S ;µ ) (23)\nt t t t\nt=1\n(cid:34) T (cid:35)\n(c) (cid:88)\n≤ E r(S ;µ¯ )−r(S ;µ ) (24)\nt t t t\nt=1\n \nT\n(d) (cid:88)\n≤ E |r(S ;µ¯ )−r(S ;µ˜ )|+|r(S ;µ )−r(S ;µ˜ )|, (25)\n t t t t t t t t \n(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)\nt=1\n(I) (II)\nwhere(a)isbydefinition,(b)followsfromCondition1andLemma3,(c)fromeventW andthedefinitionofS ,(d)from\nt\ntriangleinequality.\nNowweshowhowtoboundterm(I),\n   (cid:118) \nE (cid:88) (I)( ≤a) B vE (cid:88)T (cid:117) (cid:117) (cid:116)(cid:88) (µ¯ t,i V−\n¯\nµ˜ t,i)2 \n\nt,i\nt∈[T] t=1 i∈S˜\nt\n \n(cid:118)\n( ≤b) √B v ·E(cid:88)T (cid:117) (cid:117)(cid:88) pµt,St(µ¯ t,i−µ˜ t,i)2 \np  (cid:116) i V¯ \nmin t,i\nt=1 i∈S˜\nt\n(cid:118) \n( ≤c) √B pv ·E (cid:117) (cid:117) (cid:116)T (cid:88)T (cid:88) p iµt,St(µ¯ t,i V− ¯ µ˜ t,i)2 \nmin t,i\nt=1i∈S˜\nt\n(cid:118)\n(cid:117)  \n( ≤d) √B pv ·(cid:117) (cid:117) (cid:116)TE (cid:88)T (cid:88) p iµt,St(µ¯ t,i V− ¯ µ˜ t,i)2 \nmin t,i\nt=1i∈S˜\nt\n(cid:118)\n( =e) √B v\n·(cid:117)\n(cid:117)\n(cid:116)TE(cid:34) (cid:88)T\n(cid:88) (µ¯ t,i−µ˜\nt,i)2(cid:35)\np V¯\nmin t,i\nt=1i∈τt\n(cid:118)\n( ≤f) √B v ·(cid:117) (cid:117) (cid:116)TE(cid:34) (cid:88)T (cid:88) (6ρ(δ)∥ϕ t(i)∥ G− t1)2(cid:35)\np V¯\nmin t,i\nt=1i∈τt\n(g) √ √\n≤ O(B d T log(KT)/ p ), (26)\nv min\nwhere(a)followsfromCondition3,(b)followsfromthedefinitionofp s.t. pµt,St ≥p fori∈S˜,(c)followsfrom\nmin i min t\n15\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nCauchy–Schwarz, (d)followsfromJensen’sinequality, (e)followsfromtheTPEtrick, (f)followsfromLemma3, (g)\nfollowsfromLemma6.\n√ √\nNowfortheterm(II)≤ O(B d T log(KT)/ p )followsfromthesimilarderivationofEquation(26)byreplacing\nv min\n(µ¯ −µ˜ )2with(µ −µ˜ )2. Andthetheoremisconcludedbyconsidering¬W and¬N ,similartoAppendixA.\nt,i t,i t,i t,i t t\nLemma6(WeightedEllipsoidalPotentialLemma). (cid:80)T (cid:80) ∥ϕ (i)∥2 /V¯ ≤2dlog(1+KT/(γd))≤2dlogT\nt=1 i∈τt t G− t1 t,i\nwhen¬F andγ ≥4K.\nT\nProof.\n(cid:32) (cid:33)\ndet(G )( =a) det G +(cid:88) ϕ (i)ϕ (i)⊤/V¯\nt+1 t t t t,i\ni∈τt\n(cid:32) (cid:33)\n( =b) det(G )·det I+(cid:88) G−1/2ϕ (i)(G−1/2ϕ (i))⊤/V¯\nt t t t t t,i\ni∈τt\n(cid:32) (cid:33)\n( ≥c) det(G )· 1+(cid:88) ∥ϕ (i)∥2 /V¯\nt t G−1 t,i\nt\ni∈τt\nt (cid:32) (cid:33)\n( ≥d) det(γI)(cid:89) 1+(cid:88) ∥ϕ (i)∥2 /V¯ , (27)\ns G− s1 t,i\ns=1 i∈τs\nwhere (a) follows from the definition, (b) follows from det(AB) = det(A)det(B) and A + B = A1/2(I +\nA−1/2BA−1/2)A1/2,(c)followsfromLemma14,(d)followsfromrepeatedlyapplying(c).\nIf V¯ = 1, ∥ϕ (i)∥2 /V¯ ≤ 4∥ϕs(i)∥2 ≤ 4/γ ≤ 1/K, else if V¯ < 1, and since ¬F , by Lemma 9,\ns,i 4 s G− s1 s,i λmin(Gs) s,i 4 T\n∥ϕ s(i)∥2\nG−\ns1/V¯\ns,i\n≤ ρ(1 δ)√1\nγ\n≤ γ1 ≤ 1/(4K). Therefore, we have (cid:80) i∈τs∥ϕ s(i)∥2\nG− s1\n≤ 1. Using the fact that\n2log(1+x)≥xforany[0,1],wehave\n(cid:88)(cid:88) ∥ϕ (i)∥2 /V¯\ns G− s1 s,i\ns∈ti∈τs\nt (cid:32) (cid:33)\n≤2(cid:88) log 1+(cid:88) ∥ϕ (i)∥2 /V¯\ns G− s1 s,i\ns=1 i∈τs\nt (cid:32) (cid:33)\n=2log(cid:89) 1+(cid:88) ∥ϕ (i)∥2 /V¯\ns G− s1 s,i\ns=1 i∈τs\n(cid:18) (cid:19)\n(a) det(G )\n≤ 2log t+1\ndet(γI)\n(b)\n(cid:18) (γ+KT/d)d(cid:19)\n≤ 2log =2dlog(1+4dK2T2/(γd))≤4dlog(KT),\nγd\nwhere the (a) follows from Equation (17), (b) follows from Lemma 15 by setting L = ∥ϕ (i)∥2/V¯ ≤ 4dKs (from\ns s,i\nLemma11). ■\nB.3.ProofofTheorem3UnderTPVMCondition\nInthissection,weconsidertwocaseswhenλ≥2andλ≥1. RecallthattousetheTPVMcondition(Condition4),we\nneedoneadditionalconditionoverthetriggeringprobability(Condition5).\n16\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nB.3.1.WHENλ≥2:\nWeinheritthesamenotationandeventsasinAppendixA.1,andstarttoboundterm(I)inEquation(26)differently,\n   (cid:118) \nE (cid:88) (I)( ≤a) E (cid:88)T B v(cid:117) (cid:117) (cid:116)(cid:88) (pµ i˜t,St)2(µ¯ t,i V−\n¯\nµ˜ t,i)2 \n\n(28)\nt,i\nt∈[T] t=1 i∈S˜\nt\n (cid:118) (cid:117)   2 \n( ≤b) E (cid:88)T B v(cid:117) (cid:117) (cid:116)(cid:88) pµ it,St +min 1, (cid:88) B pp jµ,St|µ t,j −µ˜ t,j|  · (µ¯ t,i V− ¯ µ˜ t,i)2   (29)\n  t,i\nt=1 i∈S˜\nt\nj∈S˜\nt\n \n(cid:118)\n( ≤c) E(cid:88)T\nB\n(cid:117) (cid:117)(cid:88)\n3pµt,St ·\n(µ¯ t,i−µ˜ t,i)2\n\n v(cid:116) i V¯ \nt,i\nt=1 i∈S˜\nt\n (cid:118) (cid:117)  2 \n+E (cid:88)T B v(cid:117) (cid:117) (cid:116)(cid:88) (cid:88) B ppµ jt,St|µ\nt,j\n−µ˜ t,j| · (µ¯ t,i V−\n¯\nµ˜ t,i)2 \n\n(30)\nt,i\nt=1 i∈S˜\nt\nj∈S˜\nt\n \n(cid:118)\n( =d) O(B d√ T log(KT))+B E(cid:88)T (cid:117) (cid:117)(cid:88) (µ¯ t,i−µ˜ t,i)2 · (cid:88) B pµt,St|µ −µ˜ | (31)\nv v  (cid:116) V¯ p j t,j t,j \nt,i\nt=1 i∈S˜\nt\nj∈S˜\nt\n (cid:118) \n( ≤e) O(B vd√ T log(KT))+B v√ p1 E (cid:88)T (cid:117) (cid:117) (cid:116)(cid:88) p iµt,St(µ¯ V¯t,i−µ˜ t,i)2 · (cid:88) B pp jµt,St|µ\nt,j\n−µ˜ t,j| (32)\nmin t,i\nt=1 i∈S˜\nt\nj∈S˜\nt\n (cid:118) \n( ≤f) O(B vd√ T log(KT))+B v√ p1 E (cid:88)T (cid:117) (cid:117) (cid:116)(cid:88) pµ it,St(µ¯ V¯t,i−µ˜ t,i)2 ·(cid:115) K (cid:88) B p2pµ jt,St|µ t,j −µ˜ t,j|2  (33)\nmin t,i\nt=1 i∈S˜\nt\nj∈S˜\nt\n√  (cid:118) \n( ≤g) O(B vd√ T log(KT))+B vB p√ pK E (cid:88)T (cid:117) (cid:117) (cid:116)(cid:88) pµ it,St(µ¯ V¯t,i−µ˜ t,i)2 ·(cid:115) (cid:88) p jµt,St|µ t,j −µ˜ t,j|2/V¯ t,j (34)\nmin t,i\nt=1 i∈S˜\nt\nj∈S˜\nt\n√  \n( ≤h)\nO(B\nvd√\nT log(KT))+B vB p√\npK\nE\n(cid:88)T (cid:88) p iµt,St(µ¯ V¯t,i−µ ¯t,i)2\n (35)\nmin t,i\n√\nt=1i∈S˜\nt\n(i) √ K √\n≤ O(B d T log(KT)+B B √ (dlog(KT))2)=O(B d T log(KT)), (36)\nv v p p v\nmin\nwhere(a)followsfromCondition4,(b)isbyapplyingCondition5fortriggeringprobabilitypµ¯t,S˜\nt\nandpµ¯t,S˜ t,pµt,S˜\nt ≤1,\n√ √ √ i i i\n(c)followsfrom a+b≤ a+ b,(d)followsfromsamederivationfromEquation(26),(e)followsfrompµ˜t,St ≥pi ,\ni min\n(f)followsfromCauchy-Schwarz,(g)followsfromV¯ ≤ 1/4,(h)followsfromµ˜ ,µ ∈ [µ¯ ,µ ]byeventN ,(i)\nt,j t,i t,i t,i t,i t\n¯\nfollows from the similar analysis of (d)-(g) in Equation (26) inside the square-root without considering the additional\n√ √\nB T/ p .\nv min\nFortheterm(II),onecaneasilyverifyitfollowsfromthesimilardeviationoftheterm(I)withthedifferenceinconstant\nterms. AndTheorem3isconcludedbyconsideringsmallprobability¬W andN events.\nt t\nB.3.2.WHENλ≥1:\nWeinheritthesamenotationandeventsasinAppendixA.1,andstarttoboundterm(I)inEquation(28)asfollows,\n   (cid:118) \nE (cid:88) (I)( ≤a) E (cid:88)T B v(cid:117) (cid:117) (cid:116)(cid:88) (pµ i˜t,St)(µ¯ t,i V−\n¯\nµ˜ t,i)2 \n\n(37)\nt,i\nt∈[T] t=1 i∈S˜\nt\n17\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\n (cid:118) (cid:117)    \n( ≤b) E (cid:88)T B v(cid:117) (cid:117) (cid:116)(cid:88) pµ it,St +min 1, (cid:88) B pp jµ,St|µ\nt,j\n−µ˜ t,j| · (µ¯ t,i V−\n¯\nµ˜ t,i)2 \n\n(38)\n  t,i\nt=1 i∈S˜\nt\nj∈S˜\nt\n \n(cid:118)\n( ≤c) E(cid:88)T\nB\n(cid:117) (cid:117)(cid:88)\npµt,St ·\n(µ¯ t,i−µ˜ t,i)2\n\n v(cid:116) i V¯ \nt,i\nt=1 i∈S˜\nt\n (cid:118) (cid:117)   \n+E (cid:88)T B v(cid:117) (cid:117) (cid:116)(cid:88) (cid:88) B ppµ jt,St|µ\nt,j\n−µ˜ t,j|· (µ¯ t,i V−\n¯\nµ˜ t,i)2 \n\n(39)\nt,i\nt=1 i∈S˜\nt\nj∈S˜\nt\n \n(cid:118)\n( =d) O(B d√ T log(KT))+B E(cid:88)T (cid:117) (cid:117)(cid:88) (µ¯ t,i−µ˜ t,i)2 ·(cid:115) (cid:88) B pµt,St|µ −µ˜ | (40)\nv v  (cid:116) V¯ p j t,j t,j \nt,i\nt=1 i∈S˜\nt\nj∈S˜\nt\n (cid:118) \n( ≤e) O(B vd√ T log(KT))+B v√ p1 E (cid:88)T (cid:117) (cid:117) (cid:116)(cid:88) p iµt,St(µ¯ V¯t,i−µ˜ t,i)2 ·(cid:115) (cid:88) B pp jµt,St|µ\nt,j\n−µ˜ t,j| (41)\nmin t,i\nt=1 i∈S˜\nt\nj∈S˜\nt\n (cid:118)  1/4\n( ≤f) O(B vd√ T log(KT))+B v√ p1 E (cid:88)T (cid:117) (cid:117) (cid:116)(cid:88) p iµt,St(µ¯ V¯t,i−µ˜ t,i)2 ·K (cid:88) B p2p jµt,St|µ t,j −µ˜ t,j|2   \nmin t,i\nt=1 i∈S˜\nt\nj∈S˜\nt\n(42)\n (cid:118)  1/4\n( ≤g) O(B vd√ T log(KT))+B v(cid:112) B p√K p1/4 E (cid:88)T (cid:117) (cid:117) (cid:116)(cid:88) pµ it,St(µ¯ V¯t,i−µ˜ t,i)2 ·(cid:88) p jµt,St|µ t,j −µ˜ t,j|2/V¯ t,j  \nmin t,i\nt=1 i∈S˜\nt\nj∈S˜\nt\n(43)\n  3/4\n( ≤h) O(B vd√ T log(KT))+B v(cid:112) B p√K p1/4 E (cid:88)T (cid:88) p iµt,St(µ¯ V¯t,i−µ ¯t,i)2    (44)\nmin t,i\nt=1 i∈S˜\nt\n 3/4\n( ≤i) O(B vd√ T log(KT))+B v(cid:112) B p(K √T p)1/4 E (cid:88)T (cid:88) p iµt,St(µ¯ V¯t,i−µ ¯t,i)2    (45)\nmin t,i\nt=1i∈S˜\nt\n( ≤j) O(cid:18)\nB\nd√\nT log(KT)+B\n(cid:112)\nB\n(K √T)1/4 (dlog(KT))3/2(cid:19)\n=O(B\nd√\nT log(KT)), (46)\nv v p p v\nmin\nwhere(a)followsfromCondition4,(b)isbyapplyingCondition5fortriggeringprobabilitypµ¯t,S˜\nt\nandpµ¯t,S˜ t,pµt,S˜\nt ≤1,\n√ √ √ i i i\n(c)followsfrom a+b≤ a+ b,(d)followsfromsamederivationfromEquation(26),(e)followsfrompµ˜t,St ≥pi ,\ni min\n(f)followsfromCauchy-Schwarz,(g)followsfromV¯ ≤ 1/4,(h)followsfromµ˜ ,µ ∈ [µ¯ ,µ ]byeventN ,(i)\nt,j t,i t,i t,i t,i t\n¯\nfollowsfromHolder’sinequalitywithp=4,q =4/3,(j)followsfromthesimilaranalysisof(d)-(g)inEquation(26)inside\n√ √\nthesquare-rootwithoutconsideringtheadditionalB T/ p .\nv min\nFortheterm(II),onecaneasilyverifyitfollowsfromthesimilardeviationoftheterm(I)withthedifferenceinconstant\nterms. AndTheorem3isconcludedbyconsideringsmallprobability¬W andN events.\nt t\nC.ProofsforTPETricktoImproveNon-ContextualCMAB-T\nWefirstintroducesomedefinitionsthatareusedin(Wang&Chen,2017)and(Liuetal.,2022). Recallthatnon-contextual\nCMAB-Tisadegeneratecasewhenϕ (i)=e andθ∗ =µ,whereµ≜E [X |H ]isthemeanofthetrueoutcome\nt i Xt∼D t t\ndistributionD.\nDefinition1((Approximation)Gap). FixadistributionD ∈Danditsmeanvectorµ,foreachactionS ∈S,wedefinethe\n18\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\n(approximation)gapas∆ =max{0,αr(S∗;µ)−r(S;µ)}. Foreacharmi,wedefine∆min =inf ∆ ,\nS i S∈S:pD\ni\n,S>0,∆S>0 S\n∆max = sup ∆ . Asaconvention,ifthereisnoactionS ∈ S suchthatpD,S > 0and∆ > 0,then\ni S∈S:pD\ni\n,S>0,∆S>0 S i S\n∆min =+∞,∆max =0. Wedefine∆ =min ∆minand∆ =max ∆max.\ni i min i∈[m] i max i∈[m] i\nDefinition 2 (Event-Filtered Regret). For any series of events (E ) indexed by round number t, we define the\nt t∈[T]\nRegA (T,(E ) )astheregretfilteredbyevents(E ) ,ortheregretisonlycountedintifE happensint. Formally,\nα,µ t t∈[T] t t∈[T]\n \n(cid:88)\nReg αA ,µ(T,(E t) t∈[T])=E  I(E t)(α·r(S∗;µ)−r(S t;µ)). (47)\nt∈[T]\nForsimplicity,wewillomitA,α,µ,t∈[T]andrewriteRegA (T,(E ) )asReg(T,E )whencontextsareclear.\nα,µ t t∈[T] t\nC.1.ReproducingTheorem1of(Wang&Chen,2017)under1-normTPMCondition\nTheorem4. ForaCMAB-Tprobleminstance([m],S,D,D ,R)thatsatisfiesmonotonicity(Condition1), andTPM\ntrig\nboundedsmoothness(Condition2)withcoefficientB ,ifλ≥1, CUCB(Wang&Chen,2017)withan(α,β)-approximation\n1\noracleachievesan(α,β)-approximatedistribution-dependentregretboundedby\n(cid:88) 48B2KlogT π2\nReg(T)≤ 1 +2B m+ ·∆ . (48)\n∆min 1 3 max\ni∈[m] i\nAndthedistribution-independentregret,\n(cid:112) π2\nReg(T)≤14B mKT logT +2B m+ ·∆ . (49)\n1 1 3 max\nThemainideaistouseTPEtricktoreplaceS˜ (armsthatcouldbeprobabilisticallytriggeredbyactionS )withτ (arms\nt t t\nthatareactuallytriggeredbyactionS )underconditionalexpectation,sothatwecanusethesimplerAppendixB.2ofWang\nt\n&Chen(2017)toavoidthemuchmoreinvolvedAppendixB.3ofWang&Chen(2017). Suchreplacementbypassesthe\ntriggeringgroupanalysis(anditscounterN )inAppendixB.3,whichusesN toassociateT withthecountersfor\nt,i,j t,i,j t,i\nS˜. Foroursimplifiedanalysis,wecandirectlyassociatetheT withthearmtriggeringforthearmsτ thatareactually\nt t,i t\ntriggered/observedandeventuallyreproducetheregretboundsof(Wang&Chen,2017).\nWe follow exactly the same CUCB algorithm (Algorithm 1 (Wang & Chen, 2017)), conditions (Condition 1, 2 (Wang\n& Chen, 2017)). We also inherit the event definitions of Ns (Definition 4 (Wang & Chen, 2017)) that for every\nt\n(cid:113)\narm i ∈ [m], |µˆ −µ | < ρ = 3logt , and the event F being {r(S ;µ¯ ) < α · opt(µ¯ )}. Let us fur-\nt−1,i i t,i 2Tt−1,i t t t t\nther denote ∆ = αr(S∗;µ) − r(S ;µ), τ be the arms actually triggered by S at time t. Let filtration F be\nSt t t t t−1\n(ϕ ,S ,τ ,(X ) ,...,ϕ ,S ,τ ,(X ) ,ϕ ,S ), and let E [·] = E[· | F ] We also have that F ,\n1 1 1 1,i i∈τ1 t−1 t−1 t−1 t−1,i i∈τt−1 t t t t−1 t−1\nT ,µˆ aremeasurable. AlsonotethatweusepD,S todenotethetriggeringprobabilitypµ,S foranyi∈[m],S ∈S in\nt−1,i t,i i i\nordertomatchthenotationofWang&Chen(2017).\nProof. UndereventNsand¬F ,andgivenfiltrationF ,wehave\nt t t−1\n(a) (cid:88)\n∆ ≤ B pD,St(µ¯ −µ ) (50)\nSt 1 i t,i i\ni∈[m]\n(b) (cid:88)\n≤ −∆ +2B pD,St(µ¯ −µ ) (51)\nSt 1 i t,i i\ni∈[m]\n=−(cid:80) i∈[m]pD\ni\n,St∆\nSt +2B (cid:88) pD,St(µ¯ −µ ) (52)\n(cid:80) pD,St 1 i t,i i\ni∈[m] i i∈[m]\n(c) (cid:88) (cid:18) ∆min (cid:19)\n≤ 2B pD,St − i +(µ¯ −µ ) (53)\n1 i 2B K t,i i\n1\ni∈[m]\n19\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\n(cid:32) (cid:40) (cid:115) (cid:41)(cid:33)\n(d) (cid:88) ∆min 6logT\n≤ 2B pD,St − i +min 1, , (54)\n1 i 2B K T\n1 t−1,i\ni∈[m]\nwhere(a)followsfromexactlytheEquation(10)ofAppendixB.3inWang&Chen(2017),(b)isbythereverseamortization\ntrickthatmultipliestwotobothsidesof(a)andrearrangestheterms,(c)isbypD,St ≤1and∆min ≤∆ ,(d)byeventNs\n(cid:110) (cid:113) (cid:111)\ni i St t\nsothat(µ¯ −µ )≤min{1,2ρ }= 1, 6logT .\nt,i i t,i Tt−1,i\nLet\n\n2B 1,\n(cid:113)\nifℓ=0,\nκ i,T(ℓ)= 2B\n1\n6lo ℓgT, if1≤ℓ≤L i,T, (55)\n0,\nifℓ>L ,\ni,T\nwhereL\ni,T\n= 24B (∆12K mi2 nl )o 2gT.\ni\nItfollowsthat\n (cid:32) (cid:40) (cid:115) (cid:41)(cid:33)\n(a) (cid:88) ∆min 6logT\n∆ St =E t[∆ St] ≤ E t2B 1 pD i ,St − 2Bi K +min 1, T  (56)\n1 t−1,i\ni∈[m]\n (cid:32) (cid:40) (cid:115) (cid:41)(cid:33)\n( =b)E t2B 1 (cid:88) I{i∈τ t} − 2∆ Bm i i Kn +min 1, 6 TlogT  (57)\n1 t−1,i\ni∈[m]\n(cid:34) (cid:32) (cid:40) (cid:115) (cid:41)(cid:33)(cid:35)\n(cid:88) ∆min 6logT\n=E 2B − i +min 1, (58)\nt 1 2B K T\n1 t−1,i\ni∈τt\n(cid:34) (cid:35)\n(c) (cid:88)\n≤ E κ (T ) , (59)\nt i,T t−1,i\ni∈τt\nwhere(a)followsfromEquation(54),(b)followsfromtheTPEtricktoreplacepD,St =E [I{i∈τ }],(c)followsfromthatif\ni t t\nT t−1,i ≤L i,T,wehavemin{(cid:113) 6 Ttlo −g 1,T i,1}≤ 2B1 1κ i,T(T t−1,i),andifT t−1,i ≥L i,T +1,thenmin(cid:110) 1,(cid:113) 6 Ttlo −g 1,T i(cid:111) ≤ 2∆ Bm i 1i Kn ,\nso− 2∆ Bm i 1i Kn +min(cid:110) 1,(cid:113) 6 Ttlo −g 1,T i(cid:111) ≤0=κ i,T(T t−1,i).\nNowweapplythedefinitionoftheevent-filteredregret,\n(cid:34) T (cid:35)\n(cid:88)\nReg(Ns,¬F )=E ∆ (60)\nt t St\nt=1\n(cid:34) T (cid:34) (cid:35)(cid:35)\n(a) (cid:88) (cid:88)\n≤ E E κ (T ) (61)\nt i,T t−1,i\nt=1 i∈τt\n(cid:34) T (cid:35)\n( =b)E (cid:88)(cid:88)\nκ (T ) (62)\ni,T t−1,i\nt=1i∈τt\n \nTT−1,i\n( =c)E (cid:88) (cid:88)\nκ i,T(s) (63)\ni∈[m] s=0\nLi,T\n(cid:88) (cid:88)\n≤ κ (s) (64)\ni,T\ni∈[m]s=0\n(cid:88) L (cid:88)i,T (cid:114) 6logT\n=2B m+ 2B (65)\n1 1 s\ni∈[m]s=1\n20\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\n(d) (cid:88) (cid:90) Li,T (cid:114) 6logT\n≤ 2B m+ 2B ·ds (66)\n1 1 s\ns=0\ni∈[m]\n(cid:88) 48B2KlogT\n≤2B m+ 1 , (67)\n1 ∆min\ni∈[m] i\nwhere(a)followsfromEquation(59),(b)followsfromthetowerrule,(c)followsfromthatT isincreasedby1if\nt−1,i\nandonlyifi∈τ\n,(d)isbythesum&integralinequality(cid:82)U f(x)dx≥(cid:80)U f(i)≥(cid:82)U+1\nf(x)dxfornon-increasing\nt L−1 i=L L\nfunctionf.\nFollowingWang&Chen(2017)tohandlesmallprobabilityevents¬NsandF ,wehave\nt t\n(cid:88) 48B2KlogT π2\nReg(T)≤ 1 +2B m+ ·∆ , (68)\n∆min 1 3 max\ni∈[m] i\nandthedistribution-independentregretis\n(cid:112) π2\nReg(T)≤14B mKT logT +2B m+ ·∆ . (69)\n1 1 3 max\n■\nC.2.ImprovingTheorem1of(Liuetal.,2022)underTPVMCondition\nWefirstshowtheregretboundofusingourTPEtechniqueinTheorem5anditspriorresultinProposition2.\nTheorem5. ForaCMAB-Tprobleminstance([m],S,D,D ,R)thatsatisfiesmonotonicity(Condition1),andTPVM\ntrig\nbounded smoothness (Condition 4) with coefficient (B ,B ,λ), if λ ≥ 1, BCUCB-T (Liu et al., 2022) with an (α,β)-\nv 1\napproximationoracleachievesan(α,β)-approximatedistribution-dependentregretboundedby\n \nO(cid:88) B v2lo ∆˜g mK inlogT + (cid:88) B 1log(cid:18) ∆B 1 mK in(cid:19) logT, (70)\ni∈[m] i,λ i∈[m] i\nwhere∆˜min =min ∆ /(pD,St)λ−1. Andthedistribution-independentregret,\ni,λ S:pD\ni\n,S>0,∆S>0 St i\n(cid:16) (cid:112) (cid:17)\nReg(T)≤O B m(logK)T logT +B mlog(KT)logT . (71)\nv 1\nProposition2(Theorem1,Liuetal.(2022)). ForaCMAB-Tprobleminstance([m],S,D,D ,R)thatsatisfiesmono-\ntrig\ntonicity(Condition1),andTPVMboundedsmoothness(Condition4)withcoefficient(B ,B ,λ),ifλ≥1, BCUCB-Twith\nv 1\nan(α,β)-approximationoracleachievesan(α,β)-approximateregretboundedby\n \nO(cid:88) log(cid:18) ∆B v mK in(cid:19) B v2lo ∆g mK inlogT + (cid:88) B 1log2(cid:18) ∆B 1 mK in(cid:19) logT. (72)\ni∈[m] i i i∈[m] i\nAndthedistribution-independentregret,\nReg(T)≤O(cid:16)\nB\n(cid:112)\nm(logK)T log(KT)+B\nmlog2(KT)logT(cid:17)\n. (73)\nv 1\nLookingatourregretbound(Theorem5),therearetwoimprovementscomparedwithProposition2: (1)themingapis\n√\nimproved to ∆˜min ≥ ∆min, (2) we remove a O(log(BvK)) for the leading term. For (2), it translates to a O( logT)\ni,λ i ∆min\ni\nimprovementforthedistribution-independentbound.\nProof. Similar to Appendix C.1, the main idea is to use TPE trick to replace S˜ (arms that could be probabilistically\nt\ntriggeredbyactionS )withτ (armsthatareactuallytriggeredbyactionS )underconditionalexpectationtoavoidthe\nt t t\n21\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nusageofmuchmoreinvolvedtriggeringgroupanalysis(Wang&Chen,2017). Suchreplacementbypassesthetriggering\ngroupanalysis(anditscounterN )(Liuetal.,2022),whichusesN toassociateT withthecountersforS˜. By\nt,i,j t,i,j t,i t\ndoingso,wedonotneedaunionboundoverthegroupindexj,whichsavesalog(B K/∆min(orlog(B K/∆min)factor.\nv i 1 i\nWefollowexactlythesameBCUCB-Talgorithm(Algorithm1(Liuetal.,2022)),conditions(Condition1,2,3(Liuetal.,\n2022)). WealsoinherittheeventdefinitionsofNs (Definition6(Liuetal.,2022))that(1)foreverybasearmi ∈ [m],\nt\n(cid:114)\n|µˆ −µ |≤ρ ,whereρ = 6Vˆ t−1,ilogt + 9logt;(2)foreverybasearmi∈[m],Vˆ ≤2µ (1−µ )+ 3.5logt.\nt−1,i i t,i t,i Tt−1,i Tt−1,i t−1,i i i Tt−1,i\nWeusetheeventF being{r(S ;µ¯ )<α·opt(µ¯ )}. Letusfurtherdenote∆ =αr(S∗;µ)−r(S ;µ),τ bethearms\nt t t t St t t\nactuallytriggeredbyS attimet.LetfiltrationF be(ϕ ,S ,τ ,(X ) ,...,ϕ ,S ,τ ,(X ) ,ϕ ,S ),\nt t−1 1 1 1 1,i i∈τ1 t−1 t−1 t−1 t−1,i i∈τt−1 t t\nandletE [·]=E[·|F ]WealsohavethatF ,T ,µˆ aremeasurable. AlsonotethatweusepD,S todenotethe\nt t−1 t−1 t−1,i t,i i\ntriggeringprobabilitypµ,S foranyi∈[m],S ∈S inordertomatchthenotationofWang&Chen(2017);Liuetal.(2022).\ni\nWe follow the same regret decomposition as in Lemma 9 of Liu et al. (2022), to decompose the event-filtered regret\nReg(T,Ns,¬F )intotwoevent-filteredregretReg(T,E )andReg(T,E )undereventsNs,¬F .\nt t t,1 t,2 t t\nReg(T)≤Reg(T,E )+Reg(T,E ), (74)\nt,1 t,2\nwhere event E = {∆ ≤ 2e (S )}, event E = {∆ ≤ 2e (S )}, e (S ) =\n√ (cid:113)\nt,1 St t,1 t t,2 St t,2 t t,1 t\n4 3B (cid:80) ( logt ∧ 1 )(pD,St)λ,e (S )=28B (cid:80) ( logt ∧ 1 )(pD,St).\nv i∈S˜ t Tt−1,i 28 i t,2 t 1 i∈S˜ t Tt−1,i 28 i\nC.2.1.BOUNDINGTHEReg(T,E t,1)TERM\nWeboundtheleadingReg(T,E )termundertwocaseswhenλ∈[1,2)andλ∈[2,∞).\nt,1\n(a)Whenλ∈[1,2),\n√\nLetc =4 3,∆˜ =∆ /(pD,S)λ−1. GivenfiltrationF andeventE ,wehave\n1 St St i t−1 t,1\n∆\n( ≤a) (cid:88) 4c2 1B v2(pD i ,St)λ Tl to −g 1t\n,i (75)\nSt ∆\ni∈[m]\nSt\n4c2B2(pD,St)λ logt\n( =b)\n−∆ +2\n(cid:88) 1 v i Tt−1,i\n(76)\nSt ∆\ni∈[m]\nSt\n=−(cid:80)\ni∈S˜\ntpD\ni\n,St∆ St/(pD\ni\n,St)λ−1\n+2 (cid:88)\n4c2 1B v2(pD\ni\n,St)λ Tl to −g 1t\n,i (77)\n(cid:80) i∈[m](pD\ni\n,St)2−λ\ni∈[m]\n∆\nSt\n( ≤c) (cid:88) pD,St(cid:32) 8c2 1B v2 Tl to −g 1t\n,i −\n∆ St/(pD\ni\n,St)λ−1(cid:33)\n(78)\ni ∆ /(pD,St)λ−1 K\ni∈[m] St i\n( =d) (cid:88)\npD,St(cid:32) 8c2 1B v2 Tl to −g 1t\n,i −\n∆˜ St(cid:33)\n, (79)\ni ∆˜ K\ni∈[m] St\nwhere (a) follows from event E , (b) is by the reverse amortization trick that multiplies two to both sides of (a) and\nt,1\nrearrangestheterms,(c),(d)arebydefinitionofK,∆˜ .\nSt\nItfollowsthat\n∆ St =E t[∆\nSt]( ≤a)\nE\nt (cid:88)\npD i\n,St(cid:32) 8c2 1B ∆˜v2 Tl to −g 1t\n,i −\n∆˜ KSt(cid:33)\n (80)\ni∈[m] St\n( =b)E\n(cid:34) (cid:88)(cid:32) 8c2 1B v2 Tl to −g 1t\n,i −\n∆˜ St(cid:33)(cid:35)\n(81)\nt ∆˜ K\ni∈τt St\n22\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\n(cid:34) (cid:35)\n(c) (cid:88)\n≤ E κ (T ) (82)\nt i,T t−1,i\ni∈τt\nwhere(a)followsfromEquation(79),(b)followsfromTPEtricktoreplacepD,St =E [I{i∈τ }],(c)isbecausewedefine\ni t t\naregretallocationfunction\nκ\n(ℓ)= 2∆c\n˜\n(cid:113)2 1\nm\niB iv n2 4c,\n2 1B v2 ℓlogT,\ni if fℓ 1= ≤0 ℓ,\n≤L i,T,1,\n(83)\ni,T 08 ,c2 1 ∆B ˜v m i2l inogT 1 ℓ, ii ff ℓL i >,T, L1 <ℓ ,≤L i,T,2,\ni,T,2\nwhere L i,T,1 = 4c (2 1 ∆˜B m iv2 il no )g 2T, L i,T,2 = 8c2 1 (B ∆˜v2 m iK inl )o 2gT, ∆˜m i in = min S:pD\ni\n,S>0,∆S>0∆ St/(pD i ,St)λ−1, and (c) holds due to\nLemma16.\n(cid:34) T (cid:35)\n(cid:88)\nReg(T,E )=E ∆ (84)\nt,1 St\nt=1\n (cid:34) (cid:35)\n(a) (cid:88) (cid:88)\n≤ E  E t κ i,T(T t−1,i)  (85)\nt∈[T] i∈τt\n \n( =b)E (cid:88) (cid:88)\nκ i,T(T t−1,i) (86)\nt∈[T]i∈τt\n \nTT−1,i\n( =c)E (cid:88) (cid:88)\nκ i,T(s) (87)\ni∈[m] s=0\n(cid:88) c2B2 (cid:88) L (cid:88)i,T,1 (cid:114) 4c2B2logT (cid:88) L (cid:88)i,T,2 8c2B2logT 1\n≤ 1 v + 2 1 v + 1 v (88)\n∆˜min s ∆˜min s\ni∈[m] i i∈[m] s=1 i∈[m]s=Li,T,1+1 i\n(cid:88) c2B2 (cid:88) (cid:90) Li,T,1 (cid:114) 4c2B2logT (cid:88) (cid:90) Li,T,2 8c2B2logT 1\n≤ 1 v + 2 1 v ·ds+ 1 v ·ds (89)\n∆˜min s ∆˜min s\ni∈[m] i i∈[m] s=0 i∈[m] s=Li,T,1 i\n(cid:88) c2B2 (cid:88) 8c2B2logT\n≤ 1 v + 1 v (3+logK), (90)\n∆˜min ∆˜min\ni∈[m] i i∈[m] i\nwhere(a)followsfromEquation(82),(b)followsfromthetowerrule,(c)followsfromthatT isincreasedby1ifand\nt−1,i\nonlyifi∈τ .\nt\n(b)Whenλ∈[2,∞),\nLet∆˜ = ∆ /(pD,St)λ−1, ∆˜ = ∆ /pD,St. Notethat∆˜ = ∆˜ whenλ = 2, ∆˜ ≥ ∆˜ whenλ ≥ 2, and\nSt,λ St i St St i S,λ S S,λ S\n∆˜ ≤∆˜ ,whenλ≤2,foranyi,S. GivenfiltrationF andundereventE ,wehave\nS,λ S t−1 t,1\n4c2B2(pD,St)λ logt\n∆ ≤\n(cid:88) 1 v i Tt−1,i\n(91)\nSt ∆\ni∈[m]\nSt\n4c2B2(pD,St)λ logt\n=−∆ +2\n(cid:88) 1 v i Tt−1,i\n(92)\nSt ∆\ni∈[m]\nSt\n=−(cid:80)\ni∈S˜\ntpD\ni\n,St∆ St/pD\ni\n,St\n+2 (cid:88)\n4c2 1B v2(pD\ni\n,St)λ Tl to −g 1t\n,i (93)\nK ∆\ni∈[m]\nSt\n23\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\n≤\n(cid:88) pD,St(cid:32) 8c2 1B v2 Tl to −g 1t\n,i −\n∆ St/pD\ni\n,St(cid:33)\n(94)\ni ∆ /(pD,St)λ−1 K\ni∈[m] St i\n=\n(cid:88)\npD,St(cid:32) 8c2 1B v2 Tl to −g 1t\n,i −\n∆˜ St(cid:33)\n. (95)\ni ∆˜ K\ni∈[m] St,λ\n∆ St =E t[∆ St]≤E\nt\n(cid:88) pD i\n,St(cid:32) 8c2\n1\n∆B ˜v2 Tl to −g 1t\n,i −\n∆˜ KSt(cid:33)\n (96)\ni∈[m] St,λ\n=E\n(cid:34) (cid:88)(cid:32) 8c2 1B v2 Tl to −g 1t\n,i −\n∆˜ St(cid:33)(cid:35)\n(97)\nt ∆˜ K\ni∈τt St,λ\n(cid:34) (cid:35)\n(cid:88)\n≤E κ (T ) (98)\nt i,T t−1,i\ni∈τt\nwherethelastinequalityisbyLemma17andwedefinearegretallocationfunction\n\nκ\n(ℓ)=2∆c\n˜\n(cid:113)2 1\nm\niB ,λiv n2 4c,\n2 1B v2 ℓlogT,\ni if fℓ 1= ≤0 ℓ,\n≤L i,T,1,\n(99)\ni,T 08 ,c2 1 ∆B ˜v m i2 ,λl inogT 1 ℓ, ii ff ℓL i >,T, L1 <ℓ ,≤L i,T,2,\ni,T,2\nwhere L i,T,1 = 4 ∆˜c m i2 1B inv2 ·∆˜lo m ig ,λiT n, L i,T,2 = 8c ∆˜2 1 m iB iv2 nK ·∆˜l m io ,g λinT, ∆˜m i in = min S:pD\ni\n,S>0,∆S>0∆ St/pD i ,St, ∆˜m i,λin =\nmin ∆ /(pD,St)λ−1.\nS:pD\ni\n,S>0,∆S>0 St i\n(cid:34) T (cid:35)\n(cid:88)\nReg(T,E )=E ∆ (100)\nt,1 St\nt=1\n (cid:34) (cid:35)\n(a) (cid:88) (cid:88)\n≤ E  E t κ i,T(T t−1,i)  (101)\nt∈[T] i∈τt\n \n( =b)E (cid:88) (cid:88)\nκ i,T(T t−1,i) (102)\nt∈[T]i∈τt\n \nTT−1,i\n( =c)E (cid:88) (cid:88)\nκ i,T(s) (103)\ni∈[m] s=0\n(cid:88) c2B2 (cid:88) L (cid:88)i,T,1 (cid:114) 4c2B2logT (cid:88) L (cid:88)i,T,2 8c2B2logT 1\n≤ 1 v + 2 1 v + 1 v (104)\n∆˜min s ∆˜min s\ni∈[m] i i∈[m] s=1 i∈[m]s=Li,T,1+1 i\n(cid:88) c2B2 (cid:88) (cid:90) Li,T,1 (cid:114) 4c2B2logT (cid:88) (cid:90) Li,T,2 8c2B2logT 1\n≤ 1 v + 2 1 v ·ds+ 1 v ·ds (105)\n∆˜min s ∆˜min s\ni∈[m] i i∈[m] s=0 i∈[m] s=Li,T,1 i,λ\n(cid:88) c2B2 (cid:88) 8c2B2logT (cid:88) 16c2B2logT\n≤ 1 v + 1 v (1+logK)+ 1 v , (106)\ni∈[m]∆˜m i,λin\ni∈[m]\n∆˜m i,λin i∈[m](cid:113) ∆˜m i,λin·∆˜m\ni\nin\nwhere(a)followsfromEquation(98),(b)followsfromthetowerrule,(c)followsfromthatT isincreasedby1ifand\nt−1,i\nonlyifi∈τ .\nt\n24\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nC.2.2.BOUNDINGTHEReg(T,E t,2)TERM\nLetc =28. GivenfiltrationF andeventE ,wehave\n2 t−1 t,2\n(cid:26) (cid:27)\n(a) (cid:88) logT\n∆ ≤ 2c B pD,Stmin 1/28,\nSt 2 1 i T\nt−1,i\ni∈S˜\nt\n(cid:26) (cid:27)\n(b) (cid:88) logT\n≤ −∆ +2 2c B pD,Stmin 1/28,\nSt 2 1 i T\nt−1,i\ni∈S˜\nt\n=−(cid:80) i∈[m]pD\ni\n,St∆\nSt\n+2\n(cid:88)\n2c B\npD,Stmin(cid:26)\n1/28,\nlogT\n(cid:27)\n(107)\n(cid:80) i∈[m]pD\ni\n,St\ni∈[m]\n2 1 i T\nt−1,i\n(cid:18) (cid:26) (cid:27)(cid:19)\n( ≤c) (cid:88) pD,St −∆ St +4c B min 1/28, logT , (108)\ni K 2 1 T\nt−1,i\ni∈[m]\nwhere (a) follows from event E , (b) is by the reverse amortization trick that multiplies two to both sides of (a) and\nt,2\nrearrangestheterms,(c)followsfrompD,St ≤1.\ni\nItfollowsthat\n \n(cid:18) (cid:26) (cid:27)(cid:19)\n∆ St =E t[∆ St]( ≤a) E t(cid:88) pD i ,St −∆ KSt +4c 2B 1min 1/28, TlogT \nt−1,i\ni∈[m]\n(cid:34) (cid:18) (cid:26) (cid:27)(cid:19)(cid:35)\n( =b)E (cid:88) −∆ St +4c B min 1/28, logT\nt K 2 1 T\nt−1,i\ni∈τt\n(cid:34) (cid:35)\n(c) (cid:88)\n≤ E κ (T ) (109)\nt i,T t−1,i\ni∈τt\nregretallocationfunction\n\n∆max, if0≤ℓ≤L\n i i,T,1\nκ i,T(ℓ)= 4c2B1 ℓlogT, ifL\ni,1\n<ℓ≤L\ni,2\n(110)\n0,\nifℓ>L +1,\ni,T,2\nwhereL = 4c2B1logT,L = 4c2B1KlogT. And(a)followsfromEquation(108),(b)fromtheTPE,(c)follows\ni,T,1 ∆max i,T,2 ∆min\ni i\nfromLemma18.\n(cid:34) T (cid:35)\n(cid:88)\nReg(T,E )=E ∆ (111)\nt,2 St\nt=1\n (cid:34) (cid:35)\n(a) (cid:88) (cid:88)\n≤ E  E t κ i,T(T t−1,i)  (112)\nt∈[T] i∈τt\n \n( =b)E (cid:88) (cid:88)\nκ i,T(T t−1,i) (113)\nt∈[T]i∈τt\n \nTT−1,i\n( =c)E (cid:88) (cid:88)\nκ i,T(s) (114)\ni∈[m] s=0\n≤m∆ +\n(cid:88) L (cid:88)i,T,1\n∆max+\n(cid:88) L (cid:88)i,T,2 4c 2B 1logT\n(115)\nmax i ℓ\ni∈[m] ℓ=1 i∈[m]ℓ=Li,T,1+1\n25\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\n(cid:88) (cid:88) K∆max\n≤m∆ + 4c B logT + 4c B log( i )logT (116)\nmax 2 1 2 1 ∆min\ni∈[m] i∈[m] i\n(cid:88) (cid:18) K∆max (cid:19)\n=m∆ + 4c B 1+log( i ) logT (117)\nmax 2 1 ∆min\ni∈[m] i\n(cid:88) (cid:18) K∆max (cid:19)\n≤m∆ + 4c B 1+log( i ) logT, (118)\nmax 2 1 ∆min\ni∈[m] i\nwhere(a)followsfromEquation(109),(b)followsfromthetowerrule,(c)followsfromthatT isincreasedby1ifand\nt−1,i\nonlyifi∈τ . ■\nt\nD.Applications\nForconvenience,weshowourtableagaininTable3.\nTable3. Summaryofthecoefficients,regretboundsandimprovementsforvariousapplications.\nApplication Condition (B ,B ,λ) Regret Improvement\nv 1\nOnlineInfluenceMaximization(Wenetal.,2017) TPM (−,|V|,−)† O(d|V|(cid:112) |E|TlogT) O˜((cid:112) |E|)\n√ √\nDisjunctiveCombinatorialCascadingBandits(Lietal.,2016) TPVM (1,1,1) O(d TlogT) O˜( K/p )‡\n√ √ min\nConjunctiveCombinatorialCascadingBandits(Lietal.,2016) TPVM (1,1,1) O(d TlogT) O˜( K/r )\n√ max\nLinearCascadingBandits(Vialetal.,2022)∗ TPVM (1,1,1) O(d TlogT) O˜((cid:112) K/d)‡\nMulti-layeredNetworkExploration(Liuetal.,2021b) TPVM ((cid:112) 1.25|V|,1,2)† O(d(cid:112) |V|TlogT) O˜(√ n/p )\n√ min\nProbabilisticMaximumCoverage(Chenetal.,2013)∗∗ VM (3(cid:112) 2|V|,1,−) O(d(cid:112) |V|TlogT) O˜( k)\n†|V|,|E|,n,k,Ldenotesthenumberoftargetnodes,thenumberofedgesthatcanbetriggeredbythesetofseednodes,thenumberoflayers,thenumberofseed\nnodesandthelengthofthelongestdirectedpath,respectively; ‡Kisthelengthoftheorderedlist,rmax=α·max t∈[T],S∈Sr(S;µt);\n∗Aspecialcaseofdisjunctivecombinatorialcascadingbandits. ∗∗ThisrowisforC2MABapplicationandtherestofrowsareforC2MAB-Tapplications.\nD.1.OnlineInfluenceMaximizationBandit(Wang&Chen,2017)andItsContextualGeneralization(Wenetal.,\n2017)\nFollowingthesettingof(Wang&Chen,2017,Section2.1),weconsideraweighteddirectedgraphG(V,E,p),whereV is\nthesetofvertices,E isthesetofdirectededges,andeachedge(u,v)∈E isassociatedwithaprobabilityp(u,v)∈[0,1].\nWhentheagentselectsasetofseednodesS ⊆ V,theinfluencepropagatesasfollows: Attime0,theseednodesS are\nactivated;Attimet>1,anodeuactivatedattimet−1willhaveonechancetoactivateitsinactiveout-neighborvwith\nindependentprobabilityp(u,v). TheinfluencespreadofS isdenotedasσ(S)andisdefinedastheexpectednumberof\nactivatednodesafterthepropagationprocessends. TheproblemofInfluenceMaximizationistofindseednodesS with\n|S|≤ksothattheinfluencespreadσ(S)ismaximized.\nFortheproblemofonlineinfluencemaximization(OIM),weconsiderT roundsrepeatedinfluencemaximizationtasksand\ntheedgeprobabilitiesp(u,v)areassumedtobeunknowninitially. Foreachroundt∈[T],theagentselectskseednodesas\nS ,theinfluencepropagationofS isobservedandtherewardisthenumberofnodesactivatedinroundt. Theagent’sgoal\nt t\nistoaccumulateasmuchrewardaspossibleinT rounds. TheOIMfitsintoCMAB-Tframework: theedgesE arethesetof\nbasearms[m],the(unknown)outcomedistributionDisthejointofmindependentBernoullirandomvariablesfortheedge\nsetE,theactionSareanyseednodesetswithsizekatmostk. Forthearmtriggering,thetriggeredsetτ isthesetofedges\nt\n(u,v)whosesourcenodeuisreachablefromS . LetX betheoutcomesoftheedgesE accordingtoprobabilityp(u,v)\nt t\nandthelive-edgegraphGlive(V,Elive)beainducedgraphwithedgesthatarealive,i.e.,e∈Elive iffX =1fore∈E.\nt t,e\nThetriggeringprobabilitydistributionD (S ,X )degeneratestoadeterministictriggeredset,i.e.,τ isdeterministically\ntrig t t t\ndecidedgivenS andX . TherewardR(S ,X ,τ )equalstothenumberactivatednodesattheendoft,i.e.,thenodesthat\nt t t t t\narereachablefromS inthelive-edgegraphGlive. Theofflineoracleisa(1−1/e−ε,1/|V|)-approximationalgorithm\nt t\ngivenbythegreedyalgorithmfrom(Kempeetal.,2003).\nNowconsiderOIM’scontextualgeneralizationforlarge-scaleOIM,wefollowWenetal.(2017),whereeachedgee=(u,v)\nis associated with a known feature vector x ∈ Rd and an unknown parameter θ∗ ∈ Rd, and the edge probability is\ne\np(u,v) = ⟨x ,θ∗⟩. By Lemma 2 of (Wang & Chen, 2017), B = C˜ ≤ |V|, where C˜ is the largest number of nodes\ne 1\nany node can reach and batch size K ≤ |E|, so by Theorem 1, C2-UCB-T obtain a worst-case\nO˜(d|V|(cid:112)\n|E|T) regret\n26\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\n√\nbound. ComparedwithIMLinUCBalgorithm(Wenetal.,2017)thatachievesO˜(d(|V|−k)|E| T),ourregretachievesa\nimprovementuptoafactorofO˜((cid:112)\n|E|).\nNowfortheclaimofthetriggeringprobabilitysatisfiesB = B ,itfollowsfromtheTheorem4ofLietal.(2020)by\np 1\nidentifyingf(S,w,v)=pw,S.\ni\nD.2.ContextualCombinatorialCascadingBandits(Lietal.,2016)\nContextualCombinatorialcascadingbanditshavetwocategories: conjunctivecascadingbanditsanddisjunctivecascading\nbandits(Lietal.,2016). Wealsocomparewithaspecialcaseoflinearcascadingbanditsthatalsousesvariance-adaptive\nalgorithmsandachieveverycompetitiveresults.\nDisjunctiveform. Forthedisjunctiveform,wewanttoselectanorderedlistS ofK itemsfromtotalLitems,soasto\nmaximize the probability that at least one of the outcomes of the selected items are 1. Each item is associated with a\nBernoullirandomvariablewithmeanµ ∈[0,1]atroundt,indicatingwhethertheuserwillbesatisfiedwiththeitemif\nt,i\nhescanstheitem. Toleveragethecontextualinformation,Lietal.(2016)assumesµ =⟨x ,θ∗⟩,wherex ∈Rd is\nt,i t,i t,i\ntheknowncontextatroundtforarmi,θ ∈ Rd istheunknownparametertobelearned. Thissettingmodelsthemovie\nrecommendationsystemwheretheusersequentiallyscansalistofrecommendeditemsandthesystemisrewardedwhenthe\nuserissatisfiedwithanyrecommendeditem. AftertheuserissatisfiedwithanyitemorscansallK itemsbutisnotsatisfied\nwithanyofthem,theuserleavesthesystem. Duetothisstoppingrule,theagentcanonlyobservetheoutcomeofitems\nuntil(including)thefirstitemwhoseoutcomeis1. Iftherearenosatisfactoryitems,theoutcomesmustbeall0. Inother\nwords,thetriggeredsetistheprefixsetofitemsuntilthestoppingconditionholds.\nWithoutlossofgenerality,lettheactionbe{1,...,K},thentherewardfunctionisr(S;µ)=1−(cid:81)K\n(1−µ )andthe\nj=1 j\ntriggering probability is pµ,S = (cid:81)i−1(1−µ ). Let µ¯ = (µ¯ ,...,µ¯ ) and µ = (µ ,...,µ ), where µ¯ = µ+ζ +η\ni j=1 j 1 K 1 K\nwith µ¯,µ ∈ (0,1)K,ζ,η ∈ [−1,1]K. By Lemma 19 in Liu et al. (2021a), disjunctive CB satisfies Condition 4 with\n(B ,B ,λ)=(1,1,1). Also,wecanverifythatdisjunctiveCBalsosatisfiesB =B =1asfollows:\nv 1 p 1\n(cid:12) (cid:12)\n(cid:12)pµ¯,S −pµ,S(cid:12)\n(cid:12) i i (cid:12)\n(cid:12) (cid:12)\n(cid:12) i i (cid:12)\n(cid:12)(cid:89) (cid:89) (cid:12)\n=(cid:12) (1−µ j)− (1−µ¯ j)(cid:12) (119)\n(cid:12) (cid:12)\n(cid:12)j=1 j=1 (cid:12)\ni\n(cid:88)\n= |µ¯ −µ |(1−µ )...(1−µ )(1−µ¯ )...(1−µ¯ ) (120)\nj j 1 j−1 j+1 i\nj=1\ni\n(cid:88)\n≤ |µ¯ −µ |(1−µ )...(1−µ ) (121)\nj j 1 j−1\nj=1\ni\n(cid:88)\n= |µ¯ −µ |pµ,S. (122)\nj j j\nj=1\n√\nNowbyTheorem3,VAC2-UCBobtainsaregretboundofO(d T logT). ComparedwithCorollary4.5inLietal.(2016)\n√ √\nthatyieldsaO(d KT logT/p )regret,ourresultsimprovesbyafactorofO( K/p ).\nmin min\nConjunctiveform. Fortheconjunctiveform,thelearningagentwantstoselectK pathsfromtotalLpaths(i.e.,basearms)\nsoastomaximizetheprobabilitythattheoutcomesoftheselectedpathsareall1. EachitemisassociatedwithaBernoulli\nrandomvariablewithmeanµ atroundt,indicatingwhetherthepathwillbeliveifthepackagewilltransmitviathispath.\nt,i\nSuchasettingmodelsthenetworkroutingproblem(Kvetonetal.,2015a),wheretheitemsareroutingpathsandthepackage\nisdeliveredwhenallpathsarealive. Thelearningagentwillobservetheoutcomeofthefirstfewpathstillthefirstonethat\nisdown,sincethetransmissionwillstopifanyofthepathisdown. Inotherwords,thetriggeredsetistheprefixsetofpaths\nuntilthestoppingconditionholds.\nWithout loss of generality, let the action be {1,...,K}, then the reward function is r(S;µ) =\n1−(cid:81)K\n(µ ) and the\nj=1 j\ntriggering probability is pµ,S = (cid:81)i−1(µ ). Let µ¯ = (µ¯ ,...,µ¯ ) and µ = (µ ,...,µ ), where µ¯ = µ + ζ + η\ni j=1 j 1 K 1 K\nwith µ¯,µ ∈ (0,1)K,ζ,η ∈ [−1,1]K. By Lemma 20 in Liu et al. (2021a), conjunctive CB satisfies Condition 4 with\n27\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\n(B ,B ,λ)=(1,1,1). Also,wecanverifythatconjunctiveCBalsosatisfiesB =B =1asfollows:\nv 1 p 1\n(cid:12) (cid:12)\n(cid:12)pµ¯,S −pµ,S(cid:12)\n(cid:12) i i (cid:12)\n(cid:12) (cid:12)\n(cid:12) i i (cid:12)\n(cid:12)(cid:89) (cid:89) (cid:12)\n=(cid:12) µ j − µ¯ j(cid:12) (123)\n(cid:12) (cid:12)\n(cid:12)j=1 j=1 (cid:12)\ni\n(cid:88)\n= |µ¯ −µ |(µ )...(µ )(µ¯ )...(µ¯ ) (124)\nj j 1 j−1 j+1 i\nj=1\ni\n(cid:88)\n≤ |µ¯ −µ |(µ )...(µ ) (125)\nj j 1 j−1\nj=1\ni\n(cid:88)\n= |µ¯ −µ |pµ,S. (126)\nj j j\nj=1\n√\nNowbyTheorem3,VAC2-UCBobtainsaregretboundofO(d T logT). ComparedwithCorollary4.6inLietal.(2016)\n√ √\nthatyieldsaO(d KT logT/r )regret,ourresultsimprovesbyafactorofO( K/r ).\nmax max\nLinearCascadingBandit. Linearcascadingbandit(Vialetal.,2022)isaspecialcaseofcombinatorialcascadingbandit(Li\netal.,2016). TheformerassumesthatactionspaceS isthecollectionofallpermutationswhosesizeequalstoK (i.e.,a\nuniformmatroid). Inthiscase,theitemsinthefeasiblesolutionsareexchangeable(acriticalpropertyformatroids),i.e.,\nS−{e }+{e }∈S,foranyS ∈S,e ,e ∈[m]. Basedonthisproperty,theiranalysiscangetthecorrectresults. Forthe\n1 2 1 2\nlatter,however,S (i.e.,Θin[16])consistsofarbitraryfeasibleactions(perhapswithdifferentsizes),e.g.,S ∈S couldrefer\ntoanypaththatconnectsthesourceandthedestinationinnetworkroutingapplications.\nOtherthantheabovedifference,linearcascadingbanditsfollowthesamesettingasdisjunctivecontextualcombinatorial\nbandits. Followingthesimilarargumentofdisjunctivecontextualcombinatorialbandits,theregretboundofVAC2-UCBis\n√\nO(d T logT).\nComparedwithCascadeWOFULthatachievesO˜((cid:112)\nd(d+K)T)byTheorem4inVialetal.(2022),our\nregretimprovesafactorofO˜((cid:112)\n1+K/d). Fortheempiricalcomparison,seeSection5fordetails.\nD.3.Multi-layeredNetworkExplorationProblem(MuLaNE)(Liuetal.,2021b)\nWeconsidertheMuLaNEproblemwithrandomnodeweights.Afterweapplythebipartitecoveragegraph,thecorresponding\ngraphisatri-partitegraph(n,V,R)(i.e.,a3-layeredgraphwherethefirstlayerandthesecondlayerformsabipartitegraph,\nandthesecondandthethirdlayerformsanotherbipartitegraph),wheretheleftnodesrepresentnrandomwalkers;Middle\nnodesare|V|possibletargetsV tobeexplored;RightnodesRareV nodes,eachofwhichhasonlyoneedgeconnecting\nthemiddleedge. TheMuLaNEtaskistoallocateBbudgetsintonlayerstoexploretargetnodesV andthebasearmsare\nA={(i,u,b):i∈[n],u∈V,b∈[B]}.\nWithbudgetallocationk ,...,k ,the(effective)basearmsconsistoftwoparts:\n1 L\n(1){(i,j):i∈[n],j ∈V},eachofwhichisassociatedwithvisitingprobabilityx ∈[0,1]indicatingwhethernodej\ni,j\nwillbevisitedbyexplorerigivenk budgets. Allthesebasearmscorrespondstobudgetk ,i∈[n]aretriggered.\ni i\n(2)y ∈[0,1]forj ∈V representstherandomnodeweight. Thetriggeringprobabilitypµ,S =1−(cid:81) (1−x ).\nj j i∈[n] i,j\nForitscontextualgeneralization,weassumex =⟨ϕ (i,j),θ∗⟩,y =⟨ϕ (j),θ∗⟩,whereϕ (i,j),ϕ (j)aretheknown\ni,j x j y x y\nfeaturesforvisitingprobabilityandthenodeweightsforlarge-scaleMuLaNEapplications, respectively. Leteffective\nbasearmsµ=(x,y)∈(0,1)(n|V|+|V|),µ¯ =(x¯,y¯)∈(0,1)(n|V|+|V|),wherex¯ =ζ +η +x,y¯ =ζ +η +y,for\nx x y y\nζ,η ∈[−1,1](n|V|+|V|). Forthetargetnodej ∈V,theper-targetrewardfunctionr (S;x,y)=y (1−(cid:81) (1−x )).\nj j i∈[n] i,j\nDenotep¯µ,S =1−(cid:81) (1−x¯ ). BasedonLemma21inLiuetal.(2022),contextualMuLaNEsatisfiesCondition4\nj i∈[n] i,j\n(cid:112)\nwith(B ,B ,λ)=( 1.25|V|,1,2). TovalidatethatthisapplicationsatisfiesCondition5withB =B =1,wehave\nv 1 p 1\n(cid:12) (cid:12)\n(cid:12)pµ¯,S −pµ,S(cid:12)\n(cid:12) j j (cid:12)\n28\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n(cid:12)(cid:89) (cid:89) (cid:12)\n=(cid:12) (1−x i,j)− (1−x¯ i,j)(cid:12) (127)\n(cid:12) (cid:12)\n(cid:12)i∈[n] i∈[n] (cid:12)\n(cid:88)\n= |x¯ −x |(1−x )...(1−x )(1−x¯ )...(1−x¯ ) (128)\ni,j i,j 1,j i−1,j i+1,j i,j\ni∈[n]\n(cid:88)\n= |x¯ −x |. (129)\ni,j i,j\ni∈[n]\n(cid:112) (cid:112)\nByTheorem3,weobtainO(d |V|T logT),whichimprovestheresultO(d n|V|T logT/p )thatfollowstheresult\nmin\n(cid:112)\nofC3UCBalgorithm(Lietal.,2016)byafactorofO( n/p ).\nmin\nD.4.ProbabilisticMaximumCoverageBandit(Chenetal.,2016a;Merlis&Mannor,2019)\nInthissection,weconsidertheprobabilisticmaximumcoverage(PMC)problem. PMCismodeledbyaweightedbipartite\ngraphG=(L,V,E),whereLarethesourcenodes,V isthetargetnodesandeachedge(u,v)∈E isassociatedwitha\nprobabilityp(u,v). ThetaskofPMCistoselectasetS ⊆Lofsizeksoastomaximizetheexpectednumberofnodes\nactivatedinV,whereanodev ∈V canbeactivatedbyanodeu∈S withanindependentprobabilityp(u,v). PMCcan\nnaturallymodeltheadvertisementplacementapplication,whereLarecandidateweb-pages,V arethesetofusers,and\np(u,v)istheprobabilitythatauservwillclickonweb-pageu.\nPMCfitsintothenon-triggeringCMABframework: eachedge(u,v)∈E correspondstoabasearm,theactionisthesetof\nedgesthatareincidenttothesetS ⊆L,theunknownmeanvectorsµ∈(0,1)E withµ =p(u,v)andweassumethey\nu,v\n(cid:80) (cid:81)\nareindependentacrossallbasearms. Inthiscontext,therewardfunctionr(S;µ)= (1− (1−µ )).\nv∈V u∈S u,v\nInthispaper,weconsideracontextualgeneralizationbyassumingthatp(u,v) = ⟨ϕ(u,v),θ∗⟩,whereϕ(u,v) ∈ Rd is\ntheknowncontextandθ∗ ∈Rdistheunknownparameter. ByLemma24inLiuetal.(2022),PMCsatisfiesCondition3\n(cid:112) (cid:112)\nwith(B ,B )=(3 2|V|,1). FollowingTheorem2,VAC2-UCBobtainsO(d |V|T logT),whichimprovestheC3UCB\nv 1 √\n(cid:112)\nalgorithm’sboundO(d k|V|T logT)(Lietal.,2016)byafactorofO( k).\nE.Experiments\nSyntheticdata. Weconsiderthesamedisjunctivelinearcascadingbanditsettingasin(Vialetal.,2022),wherethegoalis\ntochooseK ∈{2i}8 outofm=100itemstomaximizethereward. Noticethatthelinearcascadingbanditproblemisa\ni=2\nsimplifiedversionofthecontextualcascadingbanditproblemwherethefeaturevectorsofbasearmsarefixedinallrounds\n(seeAppendixD.2fordetails).ForeachK,wesampletheclickprobabilityµ ofitemiuniformlyin[ 2 , 1]fori≤Kand\ni 3K K\nin[0, 1 ]fori>K. Wevaryd∈{2i}8 togeneratethesameµandcomputeunit-normvectorsθ∗andϕ(i)satisfying\n3K i=2\nµ =⟨θ∗,ϕ(i)⟩. WecompareVAC2-UCBtoC3-UCB(Lietal.,2016)andCascadeWOFUL(Vialetal.,2022): C3-UCB\ni\nisthevariance-agnosticcascadingbanditalgorithm(essentiallythesameasCascadeLinUCB(Zongetal.,2016)inthe\nlinearcascadingsettingbyusingthetunableparameterσ =1)andCascadeWOFUListhestate-of-the-artvariance-aware\ncascadingbanditalgorithm. AsshowninFigure2,theregretofourVAC2-UCBalgorithmhassuperiordependenceon\nK anddoverthatofC3-UCB.Whend = K = 10, VAC2-UCBachievessublinearregret; itincurs75%and13%less\nregretthanC3-UCBandCascadeWOFULafter100,000rounds. NoticethatCascadeWOFULisalsovariance-awarebut\nspecificallydesignedforcascadingbandits,whileouralgorithmcanbeappliedtogeneralC2MAB-T.\nRealdata. WeconductexperimentsontheMovieLens-1Mdatasetwhichcontainsuserratingsform ≈ 4000movies.\nFollowing the same experimental setup in (Vial et al., 2022), we set d = 20,K = 4, and the goal is to choose K out\nofmmoviestomaximizetherewardofthecascadingrecommendation. Weusetheirlearnedfeaturemappingϕfrom\nmovies to the probability that a uniformly random user rated the movie more than three stars. We point the reader to\nSection 6 of (Vial et al., 2022) for more details. In each round, we sample a random user J and define the potential\nt\nclickresultX =I{userJ ratedmovieimorethan3stars}. Inotherwords,weobservetheactualfeedbackofuserJ\nt,i t t\ninsteadofusingtheBernoulliclickmodel. Figure1ashowsthatVAC2-UCBoutperformsC3-UCBandCascadeWOFUL,\nincurring45%and25%lessregretafter100,000rounds. TomodelplatformslikeNetflixthatrecommendmoviesinspecific\ncategories,wealsorunexperimentswhilerestrictingthecandidateitemstomoviesofaparticulargenre. Figure1bshows\nthatVAC2-UCBissuperiorforallgenrescomparedtoC3-UCBandCascadeWOFUL.\n29\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nFigure2. Resultsforsyntheticdata\nF.ConcentrationBounds,Facts,andTechnicalLemmas\nInthissection,wefirstgivekeyconcentrationboundsandthenprovidelemmasthatareusefulfortheanalysis.\nF.1.ConcentrationBounds\nWemainlyusethefollowingconcentrationbounds,whichisessentiallyamodificationoftheFreedman’sversionofthe\nBernstein’sinequality(Bernstein,1946;Freedman,1975).\nProposition3(Theorem9,Lattimoreetal.(2015)). Letδ ∈ (0,1)andX ,...,X beasequenceofrandomvariables\n1 n\nadaptedtofiltration{F }withE[X |F ]=0. LetZ ⊆ [n]besuchthatI{t ∈ Z}isF -measurableandletR be\nt t t−1 t−1 t\nF measurablesuchthat|X | ≤ R almostsurely. LetV = (cid:80) Var[X | F ]+(cid:80) R2/2,R = max R ,\nt−1 t t t∈Z t t−1 t∈/Z t t∈Z t\n(cid:113)\nand S = (cid:80)n X . Then Pr[S ≥ f(R,V)] ≤ δ, where f(r,v) = 2(r+1)log 2 + 2(v+1)log 2 , and δ =\nt=1 t 3 δr,v δr,v r,v\nδ .\n3(r+1)2(v+1)\nF.2.Facts\nFact1. Foranypositive-definitematricesA,B >0dandanyvectorsx,y ∈Rd. Itholdsthat\n1. IfA≤B,thenA−1 ≥B−1.\n2. IfA≤B,then∥x∥ ≤∥x∥ .\nA B\n3. SupposeAhasmaximumeigenvalueλ ,then∥Ax∥ ≤λ ·∥x∥ andλ ≤trace(A).\nmax 2 max 2 max\nF.3.TechnicalLemmas\nRecallthateventF isdefinedinEquation(21),grammatrixG isdefinedinEquation(18),optimisticvarianceV¯ is\nt t t,i\ndefinedinEquation(6),R isdefinedinEquation(131).\nv\n(cid:2) √ (cid:3)\nLemma7. Pr ∥Z ∥ + γ ≥ρand¬F ≤δ/T,fort=1,...,T.\nt Gt t−1\nProofoflemma7. Letv ∈Rdanddefine\n(cid:40)\nVar[η |F ]⟨ϕ (i),v⟩2/V¯2 , ifV¯ < 1\nV = s,i s−1 s s,i s,i 4 (130)\ns,i,v ⟨ϕ (i),v⟩2/V¯ , otherwise.\ns s,i\n1\nR = max {⟨ϕ (i),v⟩/V¯ :V¯ < } (131)\nv s<t,i∈τs s s,i s,i 4\nByapplyingtheProposition3,withprobabilityatleast1−δ/T itholdsthat\n(cid:115)\n⟨Z ,v⟩=(cid:88)(cid:88) η ⟨ϕ (i),v⟩/V¯ ≤ 2(R v+1) log 1 + 2(1+(cid:88)(cid:88) V )log 1 (132)\nt s,i s s,i 3 δ s,i,v δ\nv v\ns<ti∈τs s<ti∈τs\n30\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nwhereδ = 3δ .\nv T(1+Rv)2(1+(cid:80) s<t(cid:80) i∈τsVs,i,v)2\nSincevcouldbearandomvariableinlaterproofs,weusethecoveringargumenttrick(Chap.20, Lattimore&Szepesva´ri\n(2020))tohandlev. Specifically,wedefinethecoveringsetΛ = {j ·ε : j = −C,−C +1,...,C −1,C}d,withsize\nε ε ε ε\nN =|Λ|=(2C/ε)dandparametersC,εwillbedeterminedshortlyafter. ByapplyingunionboundonEquation(132),we\nhavewithprobabilityatleast1−δthat\n(cid:115)\n⟨Z ,v⟩≤\n2(R v+1)\nlog\nN\n+\n2(1+(cid:88)(cid:88)\nV )log\nN\nforallv ∈Λ. (133)\nt 3 δ s,i,v δ\nv v\ns<ti∈τs\nNow we can set v = G−1Z , and it follows from Lemma 12 that ∥v∥ ≤ ∥Z ∥ ≤ 2dK2t2 = C. Based on our\nt t ∞ t 1\nconstructionofthecoveringsetΛ,thereexistsv′ ∈Λwithv′ ≤v,and∥v′−v∥ ≤ε,suchthat\n∞\n∥Z ∥2 =⟨Z ,v⟩≤∥Z ∥ ε+⟨Z ,v′⟩ (134)\nt G−1 t t 1 t\nt\n(cid:115)\n≤∥Z ∥ ε+\n2(R v+1)\nlog\nN\n+\n2(1+(cid:88)(cid:88)\nV )log\nN\n(135)\nt 1 3 δ s,i,v δ\nv v\ns<ti∈τs\n(cid:114)\n2(R +1) N N\n≤∥Z ∥ ε+ v log + 2(1+∥Z ∥2 )log (136)\nt 1 3 δ\nv\nt G− t1 δ\nv\nwhereEquation(135)usesthefactthatR ≤R ,V ≤V , 1 ≤ 1 foranyv′ ≤v,Equation(136)followsfrom\nv′ v s,i,v′ s,i,v δ v′ δv\nthefollowingderivation,\n(cid:88)(cid:88) V ≤(cid:88)(cid:88) ⟨ϕ (i),v⟩2/V¯ (137)\ns,i,v s s,i\ns<ti∈τs s<ti∈τs\n=(cid:88)(cid:88) (G−1Z )⊤ϕ (i)ϕ (i)⊤G−1Z /V¯ (138)\nt t s s t t s,i\ns<ti∈τs\n(cid:32) (cid:33)\n=(G−1Z )⊤ (cid:88)(cid:88) ϕ (i)ϕ (i)⊤/V¯ G−1Z (139)\nt t s s s,i t t\ns<ti∈τs\n≤(G−1Z )⊤G (G−1Z ) (140)\nt t t t t\n=∥Z ∥2 , (141)\nt G−1\nt\n(cid:13) (cid:13)\nwhereEquation(137)followsfrom¬F implies(cid:13)θ∗−θˆ (cid:13) ≤ ρfors < tbyLemma8andthusV¯ ≥ Var[η |\ns−1 (cid:13) s(cid:13) t,i s,i\nF ],Equation(138)followsfromdefinitionofv,Equation(1G 40s )followsfrom(cid:80) (cid:80) ϕ (i)ϕ (i)⊤/V¯ <G .\ns−1 s<t i∈τs s s s,i t\nNowwesetε=1/C =1/(2K2t2d),wehave\n∥Z ∥2 ≤RHSofEquation(136) (142)\nt G−1\nt\n≤Cε+ 2(2∥Z t∥ G− t1/ρ+1) log N +(cid:114) 2(1+∥Z ∥2 )log N (143)\n3 δ\nv\nt G− t1 δ\nv\n(cid:114)\nN N\n≤1+2log + 2(1+∥Z ∥2 )log (144)\nδ\nv\nt G− t1 δ\nv\nwhereEquation(143)istoboundR byLemma10,Equation(144)isbythedefinitionofρasanupperboundof∥Z ∥ .\nv t G−1\nt\nByrearrangingandsimplifyingEquation(144),wehave\n(cid:114)\n√ √ N\n∥Z ∥ + γ ≤1+ γ+4 log (145)\nt G− t1 δ\nv\n(cid:115)\n(cid:18) (cid:19)\n√ 6TN\n≤1+ γ+4 log (1+∥Z ∥2 ) , (146)\nδ t G− t1\n31\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nwhere the last inequality is because of δ ≥ 3δ from the definition of δ , Lemma 10, and Equation (141).\nFinally,wesolvetheaboveequationandsv etρ=T( 11+ +∥Z √t∥ γ2\nG +− t1\n4)\n(cid:113)\nlog(cid:0)6TN log(3TN)(cid:1)\n,v\nwhichcompletesthereductionont\n√ δ δ\ntoshowtheprobabilityPr[∥Z ∥ + γ ≥ρ]≥1−δ/T underevent¬F . ■\nt G−1 t−1\nt\nLemma8. If¬F holds,thenitholdsthat,\nt\n(cid:13) (cid:13)\n(cid:13)θ∗−θˆ (cid:13) ≤ρ. (147)\n(cid:13) t(cid:13)\nGt\nProof. Wehave\n(cid:13) (cid:13)\n(cid:13) (cid:13)θ∗−θˆ (cid:13) (cid:13) =(cid:13) (cid:13)G−1((cid:88)(cid:88) ϕ (i)X /V¯ )−G−1G θ∗(cid:13) (cid:13) (148)\n(cid:13) t(cid:13) (cid:13) t s s,i s,i t t (cid:13)\nGt (cid:13)\ns<ti∈τs\n(cid:13)\nGt\n(cid:13) (cid:13)\n=(cid:13) (cid:13)G−1Z +G−1((cid:88)(cid:88) ϕ (i)ϕ (i)⊤θ∗/V¯ )−G−1G θ∗(cid:13) (cid:13) (149)\n(cid:13) t t t s s s,i t t (cid:13)\n(cid:13) (cid:13)\ns<ti∈τs Gt\n=(cid:13) (cid:13)G−\nt\n1Z t−γG−\nt\n1θ∗(cid:13) (cid:13)\nGt\n(150)\n≤∥Z ∥ +γ∥θ∗∥ (151)\nt G−1 G−1\nt √ t\n≤∥Z ∥ + γ (152)\nt G−1\n√t √\n≤ρ− γ+ γ =ρ, (153)\nwhere Equation (148)-(150) follow from definition and math calculation, Equation (151) from G ≥ G = γI and\n√ t 0\n∥θ∥ ≤1,Equation(152)fromthatif¬F holds,then∥Z ∥ + γ ≤ρ. ■\n2 t t Gt\nLemma 9. For any s < t, ∥ϕs( V¯i s) ,∥ iG− t1 ≤ ∥ϕs( V¯i s) ,∥ iG− s1 , and if ¬F\nt−1\nholds and V¯\ns,i\n< 41, ∥ϕs( V¯i s) ,∥ iG− s1 ≤ ρ2 ≤ 1 for any\ni∈[m].\n(cid:13) (cid:13)\nProof. ThefirstinequalityisbyG ≥G andFact1. Forthesecondinequality,when¬F holds,(cid:13)θ∗−θˆ (cid:13) ≤ρas\nt s t−1 (cid:13) s(cid:13)\ninEquation(147),andsinceV¯ < 1,itfollowsfromthedefinitionofV¯ Equation(6)thatatleastoneofthefoG lls owingis\ns,i 4 s,i\ntrue:\n1\nV¯ ≥ (⟨ϕ (i),θˆ +2ρ∥ϕ (i)∥ ⟩)≥ρ∥ϕ (i)∥ /2, (154)\ns,i 2 s s s G− s1 s G− s1\n1\nV¯ ≥ (1−⟨ϕ (i),θˆ +2ρ∥ϕ (i)∥ ⟩)≥ρ∥ϕ (i)∥ /2, (155)\ns,i 2 s s s G− s1 s G− s1\nwhichconcludesthesecondinequality. ■\nLemma10. Letv =G−\nt\n1b t,if¬F t−1,thenR\nv\n≤ 2∥Zt ρ∥ G− t1 .\nProof. Foralls<tandi∈[m],wehave⟨ϕ s(i),v⟩/V¯ s,i ≤ ∥ϕ2 s⟨ (ϕ is )∥(i G), − tv 1⟩ ·ρ = 2⟨ ∥ϕ ϕs s( (i i) ), ∥G G− t − t1 1Z ·ρt⟩ ≤ 2∥ϕs(i ∥)∥ ϕG s(− t i1 )∥·∥ GG − t1− t ·1 ρZt∥ Gt =\n2∥Zt∥ G− t1\n,wherethefirstinequalityfollowsfromLemma9,thelastinequalityfollowsfromtheCauchy-Schwarzinequality.\nρ\n■\nLemma11. If¬F ,then∥ϕ (i)∥2/V¯ ≤4dKt.\nt t 2 t,i\nProof. If V¯ = 1, the inequality trivially holds since ∥ϕ (i)∥ ≤ 1. Consider V¯ < 1, and λ be the maximum\nt,i 4 t t,i 4 max\n(cid:13) (cid:13)\neigenvalueofG t. Then,itholdsthat∥ϕ t(i)∥2 2/V¯ t,i ≤ ρ∥∥ ϕϕ t(t i( )i ∥)∥ G2 2\n− t1\n≤ ∥ϕ∥ tϕ (t i( )i ∥) G∥\n−\nt2\n1\n= (cid:13) (cid:13)G t1/ ∥2 ϕG t(t− i)1 ∥/ G2ϕ\n−\ntt 1(i)(cid:13) (cid:13) 2 ≤√ λ max,where\nthefirstinequalityfollowsfromLemma9,thesecondinequalityisbyρ≥1,∥ϕ (i)∥≤1,andthelastisbyFact1.3.\nt\n32\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nNow Assume ∥ϕ (i)∥2/V¯ ≤ 4s for s < t, which always holds for t = 1. By reduction, we consider round t, it\ns 2 s,i\n√ (cid:113) (cid:113)\nholdsthat∥ϕ (i)∥2/V¯ ≤ λ ≤ (cid:112) trace(G ) = γd+(cid:80)t−1(cid:80) ∥ϕ (i)∥2/V¯ ≤ Kd+(cid:80)t−14dK2s ≤\nt 2 t,i max t s=1 i∈τs s 2 s,i s=1\n(cid:112)\nd(K+2K2t(t−1)) ≤ 4dKt, where the first inequality follows from the analysis in the last paragraph, the third\ninequalityfollowsfromreductionovers<t,andthelastinequalityisbymathcalculation. ■\nLemma12. If¬F ,then∥ϕ (i)∥ /V¯ ≤4dKt.\nt t 1 t,i\n√ √\nP (cid:13)roof. Similar (cid:13)to the proof of Lemma 11, ∥ϕ t(i)∥ 1/V¯ t,i ≤ d∥ϕ t(i)∥ 2/V¯ t,i ≤ ρ∥ϕd∥ t(ϕ it )∥(i G)∥\n−\nt2\n1\n≤ ∥ϕ∥ tϕ (t i( )i ∥) G∥\n−\nt2\n1\n=\n(cid:13) (cid:13)G1 t/ ∥ √2 ϕG t(− t i)1 ∥/ G2ϕ − tt 1(i)(cid:13) (cid:13) 2 ≤ √ λ max ≤ 4dKt, where the first inequality uses Cauchy-Schwarz, the second inequality uses\nρ≥ d,andtherestfollowsfromtheproofofLemma11. ■\nLemma13. If¬F ,then∥Z ∥ ≤2dK2t2.\nt−1 t 1\nProof. ∥Z t∥\n1\n= (cid:13) (cid:13)(cid:80) s<t(cid:80) i∈τsη s,iϕ s(i)/V¯ s,i(cid:13) (cid:13)\n1\n≤ (cid:80) s<t(cid:80) i∈τs(cid:13) (cid:13)ϕ s(i)/V¯ s,i(cid:13) (cid:13)\n1\n≤ (cid:80) s<t(cid:80) i∈τs4dKt ≤ 2dK2t2,\nwherethefirstinequalityfollowsfromη ∈[−1,1],thesecondinequalityfollowsfromLemma12. ■\ns,i\nLemma14(LemmaA.3,(Lietal.,2016)). Letx ∈Rd,1≤i≤n. Thenwehave\ni\n(cid:32) n (cid:33) n\ndet I+(cid:88) x x⊤ ≥1+(cid:88) ∥x∥2.\ni i 2\ni=1 i=1\nLemma 15 (Lemma 11, (Abbasi-Yadkori et al., 2011)). Let x ∈ Rd with ∥x ∥ ≤ L, 1 ≤ i ≤ n and let G =\ni i 2 t\nγI+(cid:80)t−1x x⊤,then\ni=1 i i\ndet(G )≤(γ+tL2/d)d.\nt+1\nLemma16. Equation(82)holds.\nProof. WhenT t−1,i >L i,T,2 = 8c2 1 (B ∆˜v2 mK inl )o 2gT,\ni\nwehave(82,i)≤ T8c t−2 1B 1,v2 i,l ·o ∆˜g ST\nt\n− ∆˜ KSt < (∆ K˜m i ∆˜i Sn t)2 − ∆˜ KSt ≤0=κ i,T(T t−1,i).\nWhenL <T ≤L ,\ni,T,1 t−1,i i,T,2\nWehave(82,i)≤ T8c t−2 1B 1,v2 i,l ·o ∆˜g ST\nt\n− ∆˜ KSt < T8c t−2 1B 1,v2 i,l ·o ∆˜g ST\nt\n≤ T8 tc −2 1B 1,v i2 ·l ∆˜og\ni\nmT\nin\n=κ i,T(T\nt−1,i,j\niSt).\nWhenT ≤L ,\nt−1,i i,T,1\nWefurtherconsidertwodifferentcasesT t−1,i ≤ 4c2 1 (∆B ˜v S2 tlo )2gT or 4c2 1 (∆B ˜v S2 tlo )2gT <T t−1,i ≤L i,T,1 = 4c (2 1 ∆˜B m iv2 il no )g 2T.\nF (cid:113)ortheformercase,ifthereexistsi∈τ tsothatT t−1,i ≤ 4c2 1 (∆B ˜v S2 tlo )2gT,thenweknow(cid:80) q∈S˜ tκ q,T(T t−1,q)≥κ i,T(T t−1,i)=\n2 4c2 1 TB t−v2 1lo ,igT ≥2∆˜ St >∆ St,whichmakeseq.(82)holdsnomatterwhat. Thismeanswedonotneedtoconsiderthis\ncaseforgood.\nF (cid:114)or the later cas (cid:113)e, when 4c2 1 (∆B\n˜\n(cid:113)v S2 tlo )2gT < T t−1,i, we know that (82,i) ≤ 8c2 1B ∆˜v2 Sl togT Tt−1\n1,i\n=\n2 4c2 1 (∆B ˜v S2 tlo )2gT Tt−1\n1,i\n4c2 1 TB t−v2 1lo ,igT ≤2 4c2 1 TB t−v2 1lo ,igT =κ i,T(T t−1,i).\nWhenℓ=0,\nWehave(82,i)≤ 8 ∆c ˜2 1 SB tv2 · 21\n8\n− ∆˜ KSt ≤ c ∆˜2 1B Stv2 ≤ ∆c ˜2 1\nm\niB iv n2 =κ i,T(T t−1,i).\nCombiningallabovecases,wehave∆ ≤E[(cid:80) κ (T )]. ■\nSt i∈τt i,T t−1,i\n33\nContextualCombinatorialBanditswithProbabilisticallyTriggeredArms\nLemma17. Equation(98)holds.\nProof. WhenT t−1,i >L i,T,2 = 8c ∆˜2 1 mB iv2 nK ·∆˜l mog inT,\ni i,λ\nwehave(98,i)≤ T8 tc −2 1 1B ,iv ,2 ·∆l ˜og StT\n,λ\n− ∆˜ KSt < ∆˜ Km ii ∆˜n· S∆˜ t,m i λ,λin − ∆˜ KSt ≤0=κ i,T(T t−1,i).\nWhenL <T ≤L ,\ni,T,1 t−1,i i,T,2\nWehave(98,i)≤ T8 tc −2 1 1B ,iv2 ·∆˜lo Sg tT\n,λ\n− ∆˜ KSt < T8 tc −2 1 1B ,iv ,2 ·∆l ˜og StT\n,λ\n≤ T8 tc −2 1B 1,v i2 ·l ∆˜og\ni\nm,λT\nin\n=κ i,T(T t−1,i).\nWhenT ≤L ,\nt−1,i i,T,1\nWefurtherconsidertwodifferentcasesT t−1,i ≤ 4 ∆˜c2 1 SB t,v λ2 ·l ∆o ˜g ST\nt\nor 4 ∆˜c2 1 SB t,v λ2 ·l ∆o ˜g ST\nt\n<T t−1,i ≤L i,T,1 = 4 ∆˜c m i2 1 ,B λinv2 ·∆˜lo m ig iT n.\nF (cid:113)ortheformercase, (cid:113)ifthereexistsi∈τ tsothatT t−1,i ≤ 4 ∆˜c2 1 SB t,v λ2 ·l ∆o ˜g ST\nt\n,thenweknow(cid:80) q∈S˜ tκ q,T(T t−1,q)≥κ i,T(T t−1,i)=\n2 4c2 1 TB t−v2 1lo ,igT ≥ 2 ∆˜ St,λ·∆˜ St ≥ ∆ St, which makes eq. (98) holds no matter what. This means we do not need to\nconsiderthiscaseforgood.\n2F (cid:114)or\n4c\n(t\n2 1\n∆˜h\nB\nSe\nv2 t,l λo\n)l ga 2Tte Tr\nt−1\n1c ,a is (cid:113)e,\n4c2 1\nTw\nB\nt−v2h 1e\nlo\n,n\nigT\n4 ∆ ≤˜c2 1 SB 2t, (cid:114)v λ2 ·l ∆o ˜ ∆g ˜S\n∆˜\nST t\nS tt\n,λ(cid:113)<\n4c2 1 TB\nt−v2T 1lt\no\n,− ig1 T,i, ≤2w (cid:113)e 4ck\n2 1\nTBn t−o v2w\n1lo\n,igTth =at\nκ\ni( ,T98 (T,i t) −1,i)≤\n.\n8c2 1 ∆˜B Sv2 tl ,o λgT Tt−1 1,i =\nWhenℓ=0,\nWehave(98,i)≤ 8 ∆˜c S2 1 tB ,λv2 · 21\n8\n− ∆˜ KSt ≤ ∆˜c2 1 SB t,v2\nλ\n≤ ∆c ˜2 1\nm\niB ,λiv n2 =κ i,T(T t−1,i).\nCombiningallabovecases,wehave∆ ≤E[(cid:80) κ (T )]. ■\nSt i∈τt i,T t−1,i\nLemma18. Equation(109)holds.\nProof. WhenT >L = 4c2B1KlogT,\nt−1,i i,T,2 ∆min\ni\nwehave(109,i)≤4c 2B 1Tlo t−g 1T\n,i\n− ∆ KSt < ∆ Km iin − ∆ KSt ≤0=κ i,T(T t−1,i).\nWhenT ≤L ,\nt−1,i i,T,2\nWehave(109,i)≤4c 2B 1Tlo t−g 1T\n,i\n− ∆ KSt < 4c2 TB t−1 1lo ,igT =κ\ni,j\niSt,T(N\nt−1,i,j\niSt).\nWhenT ≤L ,\nt−1,i i,T,1\nIfthereexistsi ∈ S˜ sothatT ≤ L ,thenweknow(cid:80) κ (T ) ≥ κ (T ) = ∆max ≥ ∆ ,which\nt t−1,i i,T,1 q∈S˜\nt\ni,T t−1,q i,T t−1,i i St\nmakeseq.(109)holdsnomatterwhat. Thismeanswedonotneedtoconsiderthiscaseforgood.\nCombiningallabovecases,wehave∆ ≤E [(cid:80) κ (T )]. ■\nSt t i∈τt i,T t−1,i\n34",
    "pdf_filename": "Contextual_Combinatorial_Bandits_with_Probabilistically_Triggered_Arms.pdf"
}